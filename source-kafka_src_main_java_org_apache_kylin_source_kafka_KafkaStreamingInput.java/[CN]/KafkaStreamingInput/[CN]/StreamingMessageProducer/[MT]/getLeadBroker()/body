{
  final PartitionMetadata partitionMetadata=KafkaRequester.getPartitionMetadata(kafkaClusterConfig.getTopic(),partitionId,replicaBrokers,kafkaClusterConfig);
  if (partitionMetadata != null) {
    if (partitionMetadata.errorCode() != 0) {
      logger.warn("PartitionMetadata errorCode: " + partitionMetadata.errorCode());
    }
    replicaBrokers=Lists.transform(partitionMetadata.replicas(),new Function<BrokerEndPoint,Broker>(){
      @Nullable @Override public Broker apply(      @Nullable BrokerEndPoint brokerEndPoint){
        return new Broker(brokerEndPoint,SecurityProtocol.PLAINTEXT);
      }
    }
);
    BrokerEndPoint leaderEndpoint=partitionMetadata.leader();
    return new Broker(leaderEndpoint,SecurityProtocol.PLAINTEXT);
  }
 else {
    return null;
  }
}
