{
  if (StringUtils.isEmpty(partitionDateColumn))   return;
  partitionDateColumn=partitionDateColumn.toUpperCase();
  String[] columns=StringSplitter.split(partitionDateColumn,".");
  if (null != columns && columns.length == 3) {
    String tableName=columns[0].toUpperCase() + "." + columns[1].toUpperCase();
    TableDesc table=tables.get(tableName);
    ColumnDesc col=table.findColumnByName(columns[2]);
    if (col != null) {
      partitionDateColumnRef=new TblColRef(col);
    }
 else {
      throw new IllegalStateException("The column '" + partitionDateColumn + "' provided in 'partition_date_column' doesn't exist.");
    }
  }
 else {
    throw new IllegalStateException("The 'partition_date_column' format is invalid: " + partitionDateColumn + ", it should be {db}.{table}.{column}.");
  }
  partitionConditionBuilder=(IPartitionConditionBuilder)ClassUtil.newInstance(partitionConditionBuilderClz);
}
