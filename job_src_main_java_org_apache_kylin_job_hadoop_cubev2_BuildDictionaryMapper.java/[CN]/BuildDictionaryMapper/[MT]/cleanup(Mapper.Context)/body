{
  Map<Integer,DictionaryInfo> dictionaries=buildDictionary();
  DictionaryInfoSerializer dictionaryInfoSerializer=new DictionaryInfoSerializer();
  Cuboid baseCuboid=Cuboid.findById(cubeDesc,this.baseCuboidId);
  byte[] keyBuf;
  for (  Integer rowKeyIndex : dictionaries.keySet()) {
    keyBuf=Bytes.toBytes(rowKeyIndex);
    outputKey.set(keyBuf);
    ByteArrayOutputStream buf=new ByteArrayOutputStream();
    DataOutputStream dout=new DataOutputStream(buf);
    dictionaryInfoSerializer.serialize(dictionaries.get(rowKeyIndex),dout);
    dout.close();
    buf.close();
    byte[] dictionaryBytes=buf.toByteArray();
    outputValue.set(dictionaryBytes);
    context.write(outputKey,outputValue);
  }
  keyBuf=Bytes.toBytes(-1);
  outputKey.set(keyBuf);
  ByteBuffer hllBuf=ByteBuffer.allocate(1024 * 1024);
  hll.writeRegisters(hllBuf);
  outputValue.set(hllBuf.array());
  outputKey.set(keyBuf,0,keyBuf.length);
  context.write(outputKey,outputValue);
}
