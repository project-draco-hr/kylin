{
  Scan s=new Scan();
  s.addColumn(Bytes.toBytes(USER_AUTHORITY_FAMILY),Bytes.toBytes(USER_AUTHORITY_COLUMN));
  List<String> authorities=new ArrayList<String>();
  HTableInterface htable=null;
  ResultScanner scanner=null;
  try {
    htable=HBaseConnection.get(hbaseUrl).getTable(userTableName);
    scanner=htable.getScanner(s);
    for (Result result=scanner.next(); result != null; result=scanner.next()) {
      Collection<? extends GrantedAuthority> authCollection=deserialize(result.getValue(Bytes.toBytes(USER_AUTHORITY_FAMILY),Bytes.toBytes(USER_AUTHORITY_COLUMN)));
      for (      GrantedAuthority auth : authCollection) {
        if (!authorities.contains(auth.getAuthority())) {
          authorities.add(auth.getAuthority());
        }
      }
    }
  }
 catch (  IOException e) {
    logger.error(e.getLocalizedMessage(),e);
  }
 finally {
    IOUtils.closeQuietly(scanner);
    IOUtils.closeQuietly(htable);
  }
  return authorities;
}
