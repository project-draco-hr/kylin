{
  int m=(int)Math.pow(2,p);
  double alpha=1 / (2 * Math.log(2) * (1 + (3 * Math.log(2) - 1) / m));
  double alphaMM=alpha * m * m;
  double estimate=alphaMM / registerSum;
  if (zeroBuckets >= m * 0.07) {
    estimate=m * Math.log(m * 1.0 / zeroBuckets);
  }
 else   if (HyperLogLogPlusTable.isBiasCorrection(m,estimate)) {
    estimate=HyperLogLogPlusTable.biasCorrection(p,estimate);
  }
  return Math.round(estimate);
}
