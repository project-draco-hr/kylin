{
  if (collectStatistics) {
    for (    Long cuboidId : cuboidHLLMap.keySet()) {
      HyperLogLogPlusCounter hll=cuboidHLLMap.get(cuboidId);
      totalHll.merge(hll);
      outputKey.set(0 - cuboidId);
      ByteBuffer hllBuf=ByteBuffer.allocate(64 * 1024);
      hll.writeRegisters(hllBuf);
      outputValue.set(hllBuf.array());
      context.write(outputKey,outputValue);
    }
    outputKey.set(0 - baseCuboidId - 1);
    ByteBuffer hllBuf=ByteBuffer.allocate(64 * 1024);
    totalHll.writeRegisters(hllBuf);
    outputValue.set(hllBuf.array());
    context.write(outputKey,outputValue);
  }
}
