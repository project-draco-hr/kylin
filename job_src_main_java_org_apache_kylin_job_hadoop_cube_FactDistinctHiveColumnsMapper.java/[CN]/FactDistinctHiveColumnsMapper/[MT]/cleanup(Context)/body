{
  if (collectStatistics) {
    ByteBuffer hllBuf=ByteBuffer.allocate(RowConstants.ROWVALUE_BUFFER_SIZE);
    HyperLogLogPlusCounter hll;
    for (int i=0; i < cuboidIds.length; i++) {
      hll=allCuboidsHLL[i];
      outputKey.set(0 - cuboidIds[i]);
      hllBuf.clear();
      hll.writeRegisters(hllBuf);
      outputValue.set(hllBuf.array(),0,hllBuf.position());
      context.write(outputKey,outputValue);
    }
    double samplingRatio=rowCount < MAX_SAMPING_COUNT ? 1.0 : ((double)MAX_SAMPING_COUNT) / rowCount;
    outputKey.set(0 - baseCuboidId - 1);
    outputValue.set(Bytes.toBytes(samplingRatio));
    context.write(outputKey,outputValue);
  }
}
