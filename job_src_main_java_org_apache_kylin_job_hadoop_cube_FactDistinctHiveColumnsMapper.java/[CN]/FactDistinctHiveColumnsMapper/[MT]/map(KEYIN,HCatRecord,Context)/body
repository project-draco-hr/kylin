{
  try {
    int[] flatTableIndexes=intermediateTableDesc.getRowKeyColumnIndexes();
    HCatFieldSchema fieldSchema;
    for (    int i : factDictCols) {
      outputKey.set((short)i);
      fieldSchema=schema.get(flatTableIndexes[i]);
      Object fieldValue=record.get(fieldSchema.getName(),schema);
      if (fieldValue == null)       continue;
      byte[] bytes=Bytes.toBytes(fieldValue.toString());
      outputValue.set(bytes,0,bytes.length);
      context.write(outputKey,outputValue);
    }
  }
 catch (  Exception ex) {
    handleErrorRecord(record,ex);
  }
  if (collectStatistics) {
    String[] row=HiveTableReader.getRowAsStringArray(record);
    putRowKeyToHLL(row,baseCuboidId);
  }
}
