{
  super.setup(context);
  schema=HCatInputFormat.getTableSchema(context.getConfiguration());
  intermediateTableDesc=new CubeJoinedFlatTableDesc(cubeDesc,null);
  collectStatistics=Boolean.parseBoolean(context.getConfiguration().get(BatchConstants.CFG_STATISTICS_ENABLED));
  if (collectStatistics) {
    cuboidScheduler=new CuboidScheduler(cubeDesc);
    cuboidHLLMap=Maps.newHashMap();
    nRowKey=cubeDesc.getRowkey().getRowKeyColumns().length;
    byteBuffer=ByteBuffer.allocate(1024 * 1024);
  }
}
