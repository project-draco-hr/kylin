{
  CubeManager cubeMgr=CubeManager.getInstance(config);
  for (  DimensionDesc dim : cubeSeg.getCubeDesc().getDimensions()) {
    for (    TblColRef col : dim.getColumnRefs()) {
      if (cubeSeg.getCubeDesc().getRowkey().isUseDictionary(col)) {
        logger.info("Building dictionary for " + col);
        cubeMgr.buildDictionary(cubeSeg,col,factColumnsPath);
      }
    }
    if (dim.getTable() != null && !dim.getTable().equalsIgnoreCase(cubeSeg.getCubeDesc().getFactTable())) {
      logger.info("Building snapshot of " + dim.getTable());
      cubeMgr.buildSnapshotTable(cubeSeg,dim.getTable());
      logger.info("Checking snapshot of " + dim.getTable());
      cubeMgr.getLookupTable(cubeSeg,dim);
    }
  }
}
