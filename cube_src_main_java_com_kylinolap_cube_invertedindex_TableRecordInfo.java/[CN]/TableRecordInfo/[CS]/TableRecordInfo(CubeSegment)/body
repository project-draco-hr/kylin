{
  seg=cubeSeg;
  desc=seg.getCubeInstance().getInvertedIndexDesc();
  tableDesc=desc.getFactTableDesc();
  nColumns=tableDesc.getColumnCount();
  colNames=new String[nColumns];
  dictionaries=new Dictionary<?>[nColumns];
  DictionaryManager dictMgr=DictionaryManager.getInstance(desc.getConfig());
  for (  ColumnDesc col : tableDesc.getColumns()) {
    int i=col.getZeroBasedIndex();
    colNames[i]=col.getName();
    String dictPath=seg.getDictResPath(new TblColRef(col));
    dictionaries[i]=dictMgr.getDictionary(dictPath);
  }
  int pos=0;
  offsets=new int[nColumns];
  for (int i=0; i < nColumns; i++) {
    int size=dictionaries[i].getSizeOfId();
    offsets[i]=pos;
    pos+=size;
  }
  byteFormLen=pos;
}
