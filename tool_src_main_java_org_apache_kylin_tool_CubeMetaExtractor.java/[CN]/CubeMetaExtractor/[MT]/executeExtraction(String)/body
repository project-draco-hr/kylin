{
  logger.info("The resource paths going to be extracted:");
  for (  String s : requiredResources) {
    logger.info(s + "(required)");
  }
  for (  String s : optionalResources) {
    logger.info(s + "(optional)");
  }
  for (  CubeInstance cube : cubesToTrimAndSave) {
    logger.info("Cube {} will be trimmed and extracted",cube);
  }
  try {
    KylinConfig srcConfig=KylinConfig.getInstanceFromEnv();
    KylinConfig dstConfig=KylinConfig.createInstanceFromUri(dest);
    ResourceStoreUtil.copy(srcConfig,dstConfig,requiredResources);
    try {
      ResourceStoreUtil.copy(srcConfig,dstConfig,optionalResources);
    }
 catch (    Exception e) {
      logger.warn("Exception when copying optional resource {}. May be caused by resource missing. Ignore it.");
    }
    ResourceStore dstStore=ResourceStore.getStore(dstConfig);
    for (    CubeInstance cube : cubesToTrimAndSave) {
      CubeInstance trimmedCube=copyCubeInstance(cube);
      trimmedCube.getSegments().clear();
      trimmedCube.setUuid(cube.getUuid());
      dstStore.putResource(trimmedCube.getResourcePath(),trimmedCube,CubeManager.CUBE_SERIALIZER);
    }
  }
 catch (  Exception e) {
    throw new RuntimeException("Exception",e);
  }
}
