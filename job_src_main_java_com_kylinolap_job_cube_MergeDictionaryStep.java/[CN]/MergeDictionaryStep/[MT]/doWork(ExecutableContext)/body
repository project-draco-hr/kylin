{
  KylinConfig conf=context.getConfig();
  final CubeManager mgr=CubeManager.getInstance(conf);
  final CubeInstance cube=mgr.getCube(getCubeName());
  final CubeSegment newSegment=cube.getSegmentById(getSegmentId());
  try {
    List<CubeSegment> mergingSegments=cube.getMergingSegments(newSegment);
    makeDictForNewSegment(conf,cube,newSegment,mergingSegments);
    makeSnapshotForNewSegment(cube,newSegment,mergingSegments);
    cube.getSegments().add(newSegment);
    Collections.sort(cube.getSegments());
    mgr.updateCube(cube);
    return new ExecuteResult(ExecuteResult.State.SUCCEED,"succeed");
  }
 catch (  IOException e) {
    logger.error("fail to merge dictionary or lookup snapshots",e);
    return new ExecuteResult(ExecuteResult.State.ERROR,e.getLocalizedMessage());
  }
}
