{
  byte[] bytes=new byte[payload.limit()];
  payload.get(bytes);
  StreamMessage newStreamMessage=new StreamMessage(offset,bytes);
  while (true) {
    try {
      if (getStreamQueue(hash(offset)).offer(newStreamMessage,60,TimeUnit.SECONDS)) {
        break;
      }
 else {
        logger.info("the queue is full, wait for builder to catch up");
      }
    }
 catch (    InterruptedException e) {
      logger.info("InterruptedException",e);
      continue;
    }
  }
}
