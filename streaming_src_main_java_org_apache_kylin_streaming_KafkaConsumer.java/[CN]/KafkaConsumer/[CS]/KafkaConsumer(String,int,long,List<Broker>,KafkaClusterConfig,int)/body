{
  Preconditions.checkArgument(parallelism > 0);
  this.topic=topic;
  this.partitionId=partitionId;
  this.streamingConfig=kafkaClusterConfig;
  this.offset=startOffset;
  this.replicaBrokers=initialBrokers;
  this.logger=LoggerFactory.getLogger("KafkaConsumer_" + topic + "_"+ partitionId);
  this.parallelism=parallelism;
  this.streamQueue=new LinkedBlockingQueue[parallelism];
  for (int i=0; i < parallelism; ++i) {
    streamQueue[i]=new LinkedBlockingQueue<StreamMessage>(kafkaClusterConfig.getMaxReadCount());
  }
}
