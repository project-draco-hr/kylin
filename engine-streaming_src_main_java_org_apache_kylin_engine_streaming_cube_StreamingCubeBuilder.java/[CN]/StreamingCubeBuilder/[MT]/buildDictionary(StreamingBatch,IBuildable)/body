{
  final CubeManager cubeManager=CubeManager.getInstance(KylinConfig.getInstanceFromEnv());
  final CubeInstance cubeInstance=cubeManager.reloadCubeLocal(cubeName);
  final Map<TblColRef,Dictionary<?>> dictionaryMap;
  try {
    dictionaryMap=CubingUtils.buildDictionary(cubeInstance,Lists.transform(streamingBatch.getMessages(),new Function<StreamingMessage,List<String>>(){
      @Nullable @Override public List<String> apply(      @Nullable StreamingMessage input){
        return input.getData();
      }
    }
));
    Map<TblColRef,Dictionary<?>> realDictMap=writeDictionary((CubeSegment)buildable,dictionaryMap,streamingBatch.getTimeRange().getFirst(),streamingBatch.getTimeRange().getSecond());
    return realDictMap;
  }
 catch (  IOException e) {
    throw new RuntimeException("failed to build dictionary",e);
  }
}
