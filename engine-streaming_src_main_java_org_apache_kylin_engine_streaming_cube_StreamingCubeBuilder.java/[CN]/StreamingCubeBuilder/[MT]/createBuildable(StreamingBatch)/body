{
  CubeManager cubeManager=CubeManager.getInstance(KylinConfig.getInstanceFromEnv());
  final CubeInstance cubeInstance=cubeManager.reloadCubeLocal(cubeName);
  try {
    CubeSegment segment=cubeManager.appendSegment(cubeInstance,streamingBatch.getTimeRange().getFirst(),streamingBatch.getTimeRange().getSecond(),0,0,false);
    segment.setLastBuildJobID(segment.getUuid());
    segment.setInputRecords(streamingBatch.getMessages().size());
    segment.setLastBuildTime(System.currentTimeMillis());
    return segment;
  }
 catch (  IOException e) {
    throw new RuntimeException("failed to create IBuildable",e);
  }
}
