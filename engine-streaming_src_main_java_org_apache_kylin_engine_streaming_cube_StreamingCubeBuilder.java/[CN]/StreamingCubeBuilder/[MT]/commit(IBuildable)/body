{
  CubeSegment cubeSegment=(CubeSegment)buildable;
  cubeSegment.setStatus(SegmentStatusEnum.READY);
  cubeSegment.setInputRecords(processedRowCount);
  CubeUpdate cubeBuilder=new CubeUpdate(cubeSegment.getCubeInstance());
  cubeBuilder.setToAddSegs(cubeSegment);
  try {
    CubeManager.getInstance(KylinConfig.getInstanceFromEnv()).updateCube(cubeBuilder);
  }
 catch (  IOException e) {
    throw new RuntimeException("failed to update CubeSegment",e);
  }
}
