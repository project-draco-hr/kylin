{
  final String yarnStatusCheckUrl=config.getYarnStatusCheckUrl();
  if (yarnStatusCheckUrl != null) {
    return yarnStatusCheckUrl;
  }
 else {
    logger.info(KylinConfig.KYLIN_JOB_YARN_APP_REST_CHECK_URL + " is not set, read from job configuration");
  }
  String rmWebHost=HAUtil.getConfValueForRMInstance(YarnConfiguration.RM_WEBAPP_ADDRESS,YarnConfiguration.DEFAULT_RM_WEBAPP_ADDRESS,job.getConfiguration());
  if (HAUtil.isHAEnabled(job.getConfiguration())) {
    YarnConfiguration conf=new YarnConfiguration(job.getConfiguration());
    String active=RMHAUtils.findActiveRMHAId(conf);
    rmWebHost=HAUtil.getConfValueForRMInstance(HAUtil.addSuffix(YarnConfiguration.RM_WEBAPP_ADDRESS,active),YarnConfiguration.DEFAULT_RM_WEBAPP_ADDRESS,conf);
  }
  if (StringUtils.isEmpty(rmWebHost)) {
    return null;
  }
  if (rmWebHost.startsWith("http://") || rmWebHost.startsWith("https://")) {
  }
 else {
    rmWebHost="http://" + rmWebHost;
  }
  logger.info("yarn.resourcemanager.webapp.address:" + rmWebHost);
  return rmWebHost + "/ws/v1/cluster/apps/${job_id}?anonymous=true";
}
