{
  MetadataManager metaMgr=MetadataManager.getInstance(config);
  TableDesc tableDesc=metaMgr.getTableDesc(tableName.toUpperCase());
  File tempFile=null;
  String fileNameSuffix=joinType.equalsIgnoreCase("default") ? "" : "." + joinType;
  try {
    tempFile=File.createTempFile("tmp_h2",".csv");
    FileOutputStream tempFileStream=new FileOutputStream(tempFile);
    String normalPath="/data/" + tableDesc.getName() + ".csv";
    InputStream csvStream=metaMgr.getStore().getResource(normalPath + fileNameSuffix);
    if (csvStream == null) {
      csvStream=metaMgr.getStore().getResource(normalPath);
    }
 else {
      logger.info("H2 decides to load " + (normalPath + fileNameSuffix) + " for table "+ tableDesc.getName());
    }
    org.apache.commons.io.IOUtils.copy(csvStream,tempFileStream);
    csvStream.close();
    tempFileStream.close();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  String cvsFilePath=tempFile.getPath();
  Statement stmt=h2Connection.createStatement();
  String sql=generateCreateH2TableSql(tableDesc,cvsFilePath);
  stmt.executeUpdate(sql);
  if (tempFile != null)   tempFile.delete();
}
