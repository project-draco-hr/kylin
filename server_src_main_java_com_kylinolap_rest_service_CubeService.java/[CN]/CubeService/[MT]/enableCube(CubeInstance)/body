{
  String cubeName=cube.getName();
  CubeStatusEnum ostatus=cube.getStatus();
  if (!cube.getStatus().equals(CubeStatusEnum.DISABLED)) {
    throw new InternalErrorException("Only disabled cube can be enabled, status of " + cubeName + " is "+ ostatus);
  }
  if (cube.getSegments(CubeSegmentStatusEnum.READY).size() == 0) {
    throw new InternalErrorException("Cube " + cubeName + " dosen't contain any READY segment");
  }
  List<JobInstance> jobInstances=this.getJobManager().listJobs(cube.getName(),null);
  for (  JobInstance jobInstance : jobInstances) {
    if (jobInstance.getStatus() == JobStatusEnum.PENDING || jobInstance.getStatus() == JobStatusEnum.RUNNING) {
      throw new JobException("Enable is not allowed with a running job.");
    }
  }
  if (!cube.getDescriptor().calculateSignature().equals(cube.getDescriptor().getSignature())) {
    this.releaseAllSegments(cube);
  }
  cube.setStatus(CubeStatusEnum.READY);
  try {
    return getCubeManager().updateCube(cube);
  }
 catch (  IOException e) {
    cube.setStatus(ostatus);
    throw e;
  }
}
