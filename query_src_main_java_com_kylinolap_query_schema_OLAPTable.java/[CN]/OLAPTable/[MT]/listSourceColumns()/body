{
  CubeRealizationManager projectMgr=CubeRealizationManager.getInstance(olapSchema.getConfig());
  List<ColumnDesc> exposedColumns=projectMgr.listExposedColumns(olapSchema.getProjectName(),sourceTable.getIdentity());
  List<MeasureDesc> countMeasures=projectMgr.listEffectiveRewriteMeasures(olapSchema.getProjectName(),sourceTable.getIdentity());
  HashSet<String> metFields=new HashSet<String>();
  for (  MeasureDesc m : countMeasures) {
    FunctionDesc func=m.getFunction();
    String fieldName=func.getRewriteFieldName();
    if (metFields.contains(fieldName) == false) {
      metFields.add(fieldName);
      ColumnDesc fakeCountCol=new ColumnDesc();
      fakeCountCol.setName(fieldName);
      fakeCountCol.setDatatype(func.getSQLType());
      fakeCountCol.setNullable(false);
      fakeCountCol.init(sourceTable);
      exposedColumns.add(fakeCountCol);
    }
  }
  return exposedColumns;
}
