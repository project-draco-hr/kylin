{
  seg=iiSegment;
  desc=seg.getIIInstance().getDescriptor();
  allColumns=desc.listAllColumns();
  nColumns=allColumns.size();
  dictionaries=new Dictionary<?>[nColumns];
  measureSerializers=new FixedLenMeasureCodec<?>[nColumns];
  DictionaryManager dictMgr=DictionaryManager.getInstance(desc.getConfig());
  for (  TblColRef tblColRef : desc.listAllColumns()) {
    ColumnDesc col=tblColRef.getColumn();
    int i=col.getZeroBasedIndex();
    if (desc.isMetricsCol(i)) {
      measureSerializers[i]=FixedLenMeasureCodec.get(col.getType());
    }
 else {
      String dictPath=seg.getDictResPath(tblColRef);
      try {
        dictionaries[i]=dictMgr.getDictionary(dictPath);
      }
 catch (      IOException e) {
        throw new RuntimeException("dictionary " + dictPath + " does not exist ",e);
      }
    }
  }
  digest=createDigest();
}
