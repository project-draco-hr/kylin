{
  final String resPath=formatStreamingOutputPath(streaming,shard);
  InputStream inputStream=null;
  try {
    final RawResource res=getStore().getResource(resPath);
    if (res == null) {
      return 0;
    }
 else {
      inputStream=res.inputStream;
      final BufferedReader br=new BufferedReader(new InputStreamReader(inputStream));
      return Long.parseLong(br.readLine());
    }
  }
 catch (  Exception e) {
    logger.error("error get offset, path:" + resPath,e);
    throw new RuntimeException("error get offset, path:" + resPath,e);
  }
 finally {
    IOUtils.closeQuietly(inputStream);
  }
}
