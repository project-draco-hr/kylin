{
  Collections.sort(partitions);
  final String resPath=formatStreamingOutputPath(streaming,partitions);
  InputStream inputStream=null;
  try {
    RawResource res=getStore().getResource(resPath);
    if (res == null)     return Collections.emptyMap();
    inputStream=res.inputStream;
    final HashMap<Integer,Long> result=mapper.readValue(inputStream,mapType);
    return result;
  }
 catch (  IOException e) {
    logger.error("error get offset, path:" + resPath,e);
    throw new RuntimeException("error get offset, path:" + resPath,e);
  }
 finally {
    IOUtils.closeQuietly(inputStream);
  }
}
