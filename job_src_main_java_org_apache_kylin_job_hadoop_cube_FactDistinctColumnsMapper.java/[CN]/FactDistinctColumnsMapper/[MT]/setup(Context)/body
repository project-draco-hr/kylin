{
  super.publishConfiguration(context.getConfiguration());
  Configuration conf=context.getConfiguration();
  KylinConfig config=AbstractHadoopJob.loadKylinPropsAndMetadata(conf);
  String cubeName=conf.get(BatchConstants.CFG_CUBE_NAME);
  CubeInstance cube=CubeManager.getInstance(config).getCube(cubeName);
  CubeDesc cubeDesc=cube.getDescriptor();
  intermediateTableDesc=new CubeJoinedFlatTableDesc(cubeDesc,null);
  String[] rowKeyIndexes=conf.get(BatchConstants.CFG_FACT_DICT_COLUMN_ROWKEY_INDEXES).split(",");
  factDictColRowKeyIndexes=new int[rowKeyIndexes.length];
  for (int i=0; i < rowKeyIndexes.length; i++) {
    factDictColRowKeyIndexes[i]=Integer.parseInt(rowKeyIndexes[i]);
  }
  schema=HCatInputFormat.getTableSchema(context.getConfiguration());
}
