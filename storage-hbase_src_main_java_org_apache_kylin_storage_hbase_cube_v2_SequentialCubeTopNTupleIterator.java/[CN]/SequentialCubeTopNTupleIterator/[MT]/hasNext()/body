{
  if (next != null)   return true;
  if (innerResultIterator == null) {
    if (curScanner == null) {
      if (scannerIterator.hasNext()) {
        curScanner=scannerIterator.next();
        curRecordIterator=curScanner.iterator();
        curTupleConverter=new CubeTupleConverter(curScanner.cubeSeg,cuboid,selectedDimensions,selectedMetrics,tupleInfo,topNCol);
      }
 else {
        return false;
      }
    }
    if (curRecordIterator.hasNext()) {
      innerResultIterator=curTupleConverter.translateTopNResult(curRecordIterator.next(),tuple);
      return hasNext();
    }
 else {
      close(curScanner);
      curScanner=null;
      curRecordIterator=null;
      curTupleConverter=null;
      innerResultIterator=null;
      return hasNext();
    }
  }
  if (innerResultIterator.hasNext()) {
    next=innerResultIterator.next();
    return true;
  }
 else {
    innerResultIterator=null;
    return hasNext();
  }
}
