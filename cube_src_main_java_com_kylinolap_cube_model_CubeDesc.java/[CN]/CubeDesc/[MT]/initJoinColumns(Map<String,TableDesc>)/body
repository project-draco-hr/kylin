{
  for (  DimensionDesc dim : dimensions) {
    TableDesc dimTable=tables.get(dim.getTable());
    JoinDesc join=dim.getJoin();
    if (join == null)     continue;
    String[] pks=join.getPrimaryKey();
    TblColRef[] pkCols=new TblColRef[pks.length];
    for (int i=0; i < pks.length; i++) {
      ColumnDesc col=dimTable.findColumnByName(pks[i]);
      if (col == null) {
        addError("Can't find column " + pks[i] + " in table "+ dimTable.getName());
      }
      TblColRef colRef=new TblColRef(col);
      pks[i]=colRef.getName();
      pkCols[i]=colRef;
    }
    join.setPrimaryKeyColumns(pkCols);
    TableDesc factTable=tables.get(this.getFactTable());
    if (factTable == null) {
      addError("Fact table does not exist:" + this.getFactTable());
    }
    String[] fks=join.getForeignKey();
    TblColRef[] fkCols=new TblColRef[fks.length];
    for (int i=0; i < fks.length; i++) {
      ColumnDesc col=factTable.findColumnByName(fks[i]);
      if (col == null) {
        addError("Can't find column " + fks[i] + " in table "+ this.getFactTable());
      }
      TblColRef colRef=new TblColRef(col);
      fks[i]=colRef.getName();
      fkCols[i]=colRef;
    }
    join.setForeignKeyColumns(fkCols);
    if (pkCols.length != fkCols.length) {
      addError("Primary keys(" + dim.getTable() + ")"+ Arrays.toString(pks)+ " are not consistent with Foreign keys("+ this.getFactTable()+ ") "+ Arrays.toString(fks));
    }
    for (int i=0; i < fkCols.length; i++) {
      if (!fkCols[i].getDatatype().equals(pkCols[i].getDatatype())) {
        addError("Primary key " + dim.getTable() + "."+ pkCols[i].getName()+ "."+ pkCols[i].getDatatype()+ " are not consistent with Foreign key "+ this.getFactTable()+ "."+ fkCols[i].getName()+ "."+ fkCols[i].getDatatype());
      }
    }
  }
}
