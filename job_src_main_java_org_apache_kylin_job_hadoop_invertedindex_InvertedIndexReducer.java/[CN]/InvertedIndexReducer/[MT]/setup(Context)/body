{
  super.publishConfiguration(context.getConfiguration());
  Configuration conf=context.getConfiguration();
  KylinConfig config=AbstractHadoopJob.loadKylinPropsAndMetadata();
  IIManager mgr=IIManager.getInstance(config);
  IIInstance ii=mgr.getII(conf.get(BatchConstants.CFG_II_NAME));
  IISegment seg=ii.getSegment(conf.get(BatchConstants.CFG_II_SEGMENT_NAME),SegmentStatusEnum.NEW);
  info=new TableRecordInfo(seg);
  rec=info.createTableRecord();
  builder=null;
  kv=new IIKeyValueCodec(info.getDigest());
}
