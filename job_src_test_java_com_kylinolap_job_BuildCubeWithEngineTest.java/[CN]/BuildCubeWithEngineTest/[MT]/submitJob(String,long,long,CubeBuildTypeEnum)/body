{
  CubeManager cubeMgr=CubeManager.getInstance(KylinConfig.getInstanceFromEnv());
  CubeInstance cube=cubeMgr.getCube(cubename);
  CubeManager.getInstance(this.getTestConfig()).loadCubeCache(cube);
  System.out.println(JsonUtil.writeValueAsIndentString(cube));
  List<CubeSegment> newSegments=cubeMgr.allocateSegments(cube,jobType,startDate,endDate);
  System.out.println(JsonUtil.writeValueAsIndentString(cube));
  List<String> jobUuids=Lists.newArrayList();
  List<JobInstance> jobs=Lists.newArrayList();
  for (  CubeSegment seg : newSegments) {
    String uuid=seg.getUuid();
    jobUuids.add(uuid);
    jobs.add(jobManager.createJob(cubename,seg.getName(),uuid,jobType));
    seg.setLastBuildJobID(uuid);
  }
  cubeMgr.updateCube(cube);
  for (  JobInstance job : jobs) {
    jobManager.submitJob(job);
  }
  return jobUuids;
}
