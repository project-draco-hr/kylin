{
  CubeSegment segment=cubeManager.appendSegments(cubeManager.getCube(cubeName),startDate,endDate);
  CubingJobBuilder cubingJobBuilder=(CubingJobBuilder)CubingJobBuilder.newBuilder().setJobEnginConfig(jobEngineConfig).setSegment(segment);
  CubingJob job=cubingJobBuilder.buildJob();
  jobService.addJob(job);
  waitForJob(job.getId());
  return job.getId();
}
