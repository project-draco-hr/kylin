{
  final Reader reader=new Reader(hconf,SequenceFile.Reader.file(new Path(path)));
  return new Iterable<Pair<ImmutableBytesWritable,ImmutableBytesWritable>>(){
    @Override public Iterator<Pair<ImmutableBytesWritable,ImmutableBytesWritable>> iterator(){
      return new Iterator<Pair<ImmutableBytesWritable,ImmutableBytesWritable>>(){
        ImmutableBytesWritable k=new ImmutableBytesWritable();
        ImmutableBytesWritable v=new ImmutableBytesWritable();
        Pair<ImmutableBytesWritable,ImmutableBytesWritable> pair=new Pair<ImmutableBytesWritable,ImmutableBytesWritable>(k,v);
        @Override public boolean hasNext(){
          boolean hasNext=false;
          try {
            hasNext=reader.next(k,v);
          }
 catch (          IOException e) {
            throw new RuntimeException(e);
          }
 finally {
            if (hasNext == false) {
              IOUtils.closeQuietly(reader);
            }
          }
          return hasNext;
        }
        @Override public Pair<ImmutableBytesWritable,ImmutableBytesWritable> next(){
          return pair;
        }
        @Override public void remove(){
          throw new UnsupportedOperationException();
        }
      }
;
    }
  }
;
}
