{
  double step=(double)(end - start) / (count - 1);
  long ts=start;
  int offset=0;
  ArrayList<StreamMessage> result=Lists.newArrayList();
  for (int i=0; i < count - 1; ++i) {
    result.add(new StreamMessage(offset++,String.valueOf(ts).getBytes()));
    ts+=step;
  }
  result.add(new StreamMessage(offset++,String.valueOf(end).getBytes()));
  assertEquals(count,result.size());
  assertEquals(start + "",new String(result.get(0).getRawData()));
  assertEquals(end + "",new String(result.get(count - 1).getRawData()));
  return result;
}
