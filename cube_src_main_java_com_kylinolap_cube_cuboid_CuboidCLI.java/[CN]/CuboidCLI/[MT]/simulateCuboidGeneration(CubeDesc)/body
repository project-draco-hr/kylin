{
  CuboidScheduler scheduler=new CuboidScheduler(cube);
  long baseCuboid=Cuboid.getBaseCuboidId(cube);
  Collection<Long> cuboidSet=new TreeSet<Long>();
  cuboidSet.add(baseCuboid);
  LinkedList<Long> cuboidQueue=new LinkedList<Long>();
  cuboidQueue.push(baseCuboid);
  while (!cuboidQueue.isEmpty()) {
    long cuboid=cuboidQueue.pop();
    Collection<Long> spnanningCuboids=scheduler.getSpanningCuboid(cuboid);
    for (    Long sc : spnanningCuboids) {
      boolean notfound=cuboidSet.add(sc);
      if (!notfound) {
        throw new IllegalStateException("Find duplicate spanning cuboid " + sc + " from cuboid "+ cuboid);
      }
      cuboidQueue.push(sc);
    }
  }
  TreeSet<Long> enumCuboids=enumCalcCuboidCount(cube);
  if (enumCuboids.equals(cuboidSet) == false) {
    throw new IllegalStateException("Expected cuboid set " + enumCuboids + "; but actual cuboid set "+ cuboidSet);
  }
  int mathCount=mathCalcCuboidCount(cube);
  if (mathCount != enumCuboids.size()) {
    throw new IllegalStateException("Math cuboid count " + mathCount + ", but actual cuboid count "+ enumCuboids.size());
  }
  return mathCount;
}
