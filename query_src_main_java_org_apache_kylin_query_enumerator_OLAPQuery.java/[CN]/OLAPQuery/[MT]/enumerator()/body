{
  OLAPContext olapContext=OLAPContext.getThreadLocalContextById(contextId);
switch (type) {
case INDEX:
    return new CubeEnumerator(olapContext,optiqContext);
case LOOKUP_TABLE:
  return new LookupTableEnumerator(olapContext);
case HIVE:
return new HiveEnumerator(olapContext);
default :
throw new IllegalArgumentException("Wrong type " + type + "!");
}
}
