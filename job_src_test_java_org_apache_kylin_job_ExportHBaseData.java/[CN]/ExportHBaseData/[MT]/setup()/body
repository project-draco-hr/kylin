{
  KylinConfig.destoryInstance();
  System.setProperty(KylinConfig.KYLIN_CONF,AbstractKylinTestCase.SANDBOX_TEST_DATA);
  kylinConfig=KylinConfig.getInstanceFromEnv();
  cli=kylinConfig.getCliCommandExecutor();
  long currentTIME=System.currentTimeMillis();
  exportHdfsFolder=kylinConfig.getHdfsWorkingDirectory() + "hbase-export/" + currentTIME+ "/";
  exportLocalFolderParent=BatchConstants.CFG_KYLIN_LOCAL_TEMP_DIR + "hbase-export/";
  exportLocalFolder=exportLocalFolderParent + currentTIME + "/";
  backupArchive=exportLocalFolderParent + "hbase-export-at-" + currentTIME+ ".tar.gz";
  String metadataUrl=kylinConfig.getMetadataUrl();
  int cut=metadataUrl.indexOf('@');
  tableNameBase=metadataUrl.substring(0,cut);
  String hbaseUrl=cut < 0 ? metadataUrl : metadataUrl.substring(cut + 1);
  HConnection conn=HBaseConnection.get(hbaseUrl);
  try {
    hbase=new HBaseAdmin(conn);
    config=hbase.getConfiguration();
    allTables=hbase.listTables();
  }
 catch (  IOException e) {
    e.printStackTrace();
    throw e;
  }
}
