{
  String lookupTableName=olapContext.firstTableScan.getCubeTable();
  DimensionDesc dim=olapContext.cubeDesc.findDimensionByTable(lookupTableName);
  if (dim == null)   throw new IllegalStateException("No dimension with derived columns found for lookup table " + lookupTableName + ", cube desc "+ olapContext.cubeDesc);
  CubeInstance cube=olapContext.cubeInstance;
  CubeManager cubeMgr=CubeManager.getInstance(cube.getConfig());
  LookupStringTable table=cubeMgr.getLookupTable(cube.getLatestReadySegment(),dim);
  this.allRows=table.getAllRows();
  OLAPTable olapTable=(OLAPTable)olapContext.firstTableScan.getOlapTable();
  this.colDescs=olapTable.getExposedColumns();
  this.current=new Object[colDescs.size()];
  reset();
}
