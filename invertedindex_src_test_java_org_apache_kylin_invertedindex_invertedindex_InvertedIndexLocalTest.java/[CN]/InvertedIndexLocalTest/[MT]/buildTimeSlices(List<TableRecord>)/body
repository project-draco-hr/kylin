{
  ShardingSliceBuilder builder=new ShardingSliceBuilder(info);
  List<Slice> slices=Lists.newArrayList();
  for (  TableRecord rec : records) {
    Slice slice=builder.append(rec);
    if (slice != null) {
      slice.setLocalDictionaries(dictionaryMap);
      slices.add(slice);
    }
  }
  List<Slice> finals=builder.close();
  for (  Slice slice : finals) {
    slice.setLocalDictionaries(dictionaryMap);
  }
  slices.addAll(finals);
  Collections.sort(slices);
  return slices;
}
