{
  this.signature=table.getSignature();
  this.columnDelimeter=table.getColumnDelimeter();
  int maxIndex=tableDesc.getMaxColumnIndex();
  TableReader reader=table.getReader();
  ArrayList<String[]> allRows=new ArrayList<String[]>();
  while (reader.next()) {
    String[] row=reader.getRow();
    if (row.length <= maxIndex) {
      throw new IllegalStateException("Bad hive table row, " + tableDesc + " expect "+ (maxIndex + 1)+ " columns, but got "+ Arrays.toString(row));
    }
    allRows.add(row);
  }
  this.rows=allRows;
}
