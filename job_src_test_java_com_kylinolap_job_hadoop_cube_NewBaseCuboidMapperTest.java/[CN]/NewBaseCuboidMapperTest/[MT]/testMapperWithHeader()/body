{
  String cubeName="test_kylin_cube_with_slr_ready";
  mapDriver.getConfiguration().set(BatchConstants.CFG_CUBE_NAME,cubeName);
  mapDriver.withInput(new Text("key"),new Text("0,2013-05-05,Auction,80053,0,5,41.204172263562,0,10000638"));
  List<Pair<Text,Text>> result=mapDriver.run();
  CubeManager cubeMgr=CubeManager.getInstance(this.getTestConfig());
  CubeInstance cube=cubeMgr.getCube(cubeName);
  assertEquals(1,result.size());
  Text rowkey=result.get(0).getFirst();
  byte[] key=rowkey.getBytes();
  byte[] header=Bytes.head(key,26);
  byte[] sellerId=Bytes.tail(header,18);
  byte[] cuboidId=Bytes.head(header,8);
  byte[] restKey=Bytes.tail(key,rowkey.getLength() - 26);
  RowKeyDecoder decoder=new RowKeyDecoder(cube.getFirstSegment());
  decoder.decode(key);
  assertEquals("[10000638, 2013-05-05, Computers/Tablets & Networking, MonitorProjectors & Accs, Monitors, Auction, 0, 5]",decoder.getValues().toString());
  assertTrue(Bytes.toString(sellerId).startsWith("10000638"));
  assertEquals(255,Bytes.toLong(cuboidId));
  assertEquals(21,restKey.length);
  verifyMeasures(cube.getDescriptor().getMeasures(),result.get(0).getSecond(),"41.204172263562","41.204172263562","41.204172263562",1);
}
