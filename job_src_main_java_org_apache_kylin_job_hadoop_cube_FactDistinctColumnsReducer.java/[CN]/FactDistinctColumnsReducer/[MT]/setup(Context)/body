{
  super.publishConfiguration(context.getConfiguration());
  Configuration conf=context.getConfiguration();
  KylinConfig config=AbstractHadoopJob.loadKylinPropsAndMetadata();
  String cubeName=conf.get(BatchConstants.CFG_CUBE_NAME);
  CubeInstance cube=CubeManager.getInstance(config).getCube(cubeName);
  CubeDesc cubeDesc=cube.getDescriptor();
  baseCuboidId=Cuboid.getBaseCuboidId(cubeDesc);
  Cuboid baseCuboid=Cuboid.findById(cubeDesc,baseCuboidId);
  columnList=baseCuboid.getColumns();
  collectStatistics=Boolean.parseBoolean(conf.get(BatchConstants.CFG_STATISTICS_ENABLED));
  statisticsOutput=conf.get(BatchConstants.CFG_STATISTICS_OUTPUT);
  if (collectStatistics) {
    rowKeyCountInMappers=Lists.newArrayList();
    rowKeyCountInCuboids=Maps.newHashMap();
    cuboidHLLMap=Maps.newHashMap();
  }
}
