{
  Path seqFilePath=new Path(outputPath,BatchConstants.CFG_STATISTICS_CUBOID_ESTIMATION);
  SequenceFile.Writer writer=SequenceFile.createWriter(conf,SequenceFile.Writer.file(seqFilePath),SequenceFile.Writer.keyClass(LongWritable.class),SequenceFile.Writer.valueClass(BytesWritable.class));
  List<Long> allCuboids=new ArrayList<Long>();
  allCuboids.addAll(cuboidHLLMap.keySet());
  Collections.sort(allCuboids);
  writer.append(new LongWritable(0l),new BytesWritable(Bytes.toBytes(samplingPercentage)));
  ByteBuffer valueBuf=ByteBuffer.allocate(RowConstants.ROWVALUE_BUFFER_SIZE);
  try {
    for (    long i : allCuboids) {
      valueBuf.clear();
      cuboidHLLMap.get(i).writeRegisters(valueBuf);
      valueBuf.flip();
      writer.append(new LongWritable(i),new BytesWritable(valueBuf.array(),valueBuf.limit()));
    }
  }
  finally {
    writer.close();
  }
}
