{
  if (key.get() >= 0) {
    TblColRef col=columnList.get((int)key.get());
    HashSet<ByteArray> set=new HashSet<ByteArray>();
    for (    Text textValue : values) {
      ByteArray value=new ByteArray(Bytes.copy(textValue.getBytes(),0,textValue.getLength()));
      set.add(value);
    }
    Configuration conf=context.getConfiguration();
    FileSystem fs=FileSystem.get(conf);
    String outputPath=conf.get(BatchConstants.OUTPUT_PATH);
    FSDataOutputStream out=fs.create(new Path(outputPath,col.getName()));
    try {
      for (      ByteArray value : set) {
        out.write(value.array(),value.offset(),value.length());
        out.write('\n');
      }
    }
  finally {
      out.close();
    }
  }
 else {
    long cuboidId=0 - key.get();
    for (    Text value : values) {
      HyperLogLogPlusCounter hll=new HyperLogLogPlusCounter(16);
      ByteArray byteArray=new ByteArray(value.getBytes());
      hll.readRegisters(byteArray.asBuffer());
      if (cuboidId > baseCuboidId) {
        rowKeyCountInMappers.add(hll.getCountEstimate());
      }
      if (cuboidHLLMap.get(cuboidId) != null) {
        hll.merge(cuboidHLLMap.get(cuboidId));
      }
      cuboidHLLMap.put(cuboidId,hll);
    }
  }
}
