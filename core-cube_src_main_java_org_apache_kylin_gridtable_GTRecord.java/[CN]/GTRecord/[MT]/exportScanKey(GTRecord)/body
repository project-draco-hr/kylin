{
  if (rec == null)   return null;
  GTInfo info=rec.getInfo();
  BitSet selectedColumns=new BitSet();
  int len=0;
  for (int i=0; i < info.primaryKey.trueBitCount(); i++) {
    int c=info.primaryKey.trueBitAt(i);
    if (rec.cols[c].array() == null) {
      break;
    }
    selectedColumns.set(c);
    len+=rec.cols[c].length();
  }
  if (selectedColumns.cardinality() == 0)   return null;
  ByteArray buf=ByteArray.allocate(len);
  rec.exportColumns(new ImmutableBitSet(selectedColumns),buf);
  return buf;
}
