{
  counter++;
  if (counter % BatchConstants.COUNTER_MAX == 0) {
    logger.info("Handled " + counter + " records!");
  }
  try {
    bytesSplitter.split(value.getBytes(),value.getLength(),byteRowDelimiter);
    intermediateTableDesc.sanityCheck(bytesSplitter);
    byte[] rowKey=buildKey(bytesSplitter.getSplitBuffers());
    outputKey.set(rowKey,0,rowKey.length);
    buildValue(bytesSplitter.getSplitBuffers());
    outputValue.set(valueBuf.array(),0,valueBuf.position());
    context.write(outputKey,outputValue);
  }
 catch (  Exception ex) {
    handleErrorRecord(bytesSplitter,ex);
  }
}
