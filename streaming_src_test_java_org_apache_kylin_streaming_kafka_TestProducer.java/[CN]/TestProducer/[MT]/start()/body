{
  Properties props=new Properties();
  props.put("metadata.broker.list",TestConstants.BROKER.getConnectionString());
  props.put("serializer.class","kafka.serializer.StringEncoder");
  props.put("request.required.acks","1");
  ProducerConfig config=new ProducerConfig(props);
  final Producer<String,String> producer=new Producer<String,String>(config);
  final Thread thread=new Thread(new Runnable(){
    @Override public void run(){
      int count=0;
      while (!stopped && count < sendCount) {
        final KeyedMessage<String,String> message=new KeyedMessage<>(TestConstants.TOPIC,"current time is:" + System.currentTimeMillis());
        producer.send(message);
        count++;
        try {
          Thread.sleep(100);
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
      logger.debug("totally " + count + " messages have been sent");
      stopped=true;
    }
  }
);
  thread.setDaemon(false);
  thread.start();
}
