{
  aggs.reset();
  for (  Text value : values) {
    codec.decode(value,input);
    aggs.aggregate(input);
  }
  aggs.collectStates(result);
  KeyValue outputValue;
  for (int i=0; i < nColumns; i++) {
    outputValue=keyValueCreators.get(i).create(key.get(),0,key.getLength(),result);
    context.write(key,outputValue);
  }
  counter++;
  if (counter % BatchConstants.COUNTER_MAX == 0) {
    logger.info("Handled " + counter + " records!");
  }
}
