{
  super.bindCurrentConfiguration(context.getConfiguration());
  String cubeName=context.getConfiguration().get(BatchConstants.CFG_CUBE_NAME).toUpperCase();
  KylinConfig config=AbstractHadoopJob.loadKylinPropsAndMetadata();
  CubeDesc cubeDesc=CubeManager.getInstance(config).getCube(cubeName).getDescriptor();
  List<MeasureDesc> measuresDescs=cubeDesc.getMeasures();
  codec=new MeasureCodec(measuresDescs);
  aggs=new MeasureAggregators(measuresDescs);
  input=new Object[measuresDescs.size()];
  result=new Object[measuresDescs.size()];
  keyValueCreators=Lists.newArrayList();
  for (  HBaseColumnFamilyDesc cfDesc : cubeDesc.getHBaseMapping().getColumnFamily()) {
    for (    HBaseColumnDesc colDesc : cfDesc.getColumns()) {
      keyValueCreators.add(new KeyValueCreator(cubeDesc,colDesc));
    }
  }
  simpleFullCopy=(keyValueCreators.size() == 1 && keyValueCreators.get(0).isFullCopy);
  nColumns=keyValueCreators.size();
}
