{
  int totalCount=10000;
  int counter=0;
  Iterator<String> iterator=StreamingDataGenerator.generate(DateFormat.stringToMillis("2015-01-03"),DateFormat.stringToMillis("2015-02-05"),totalCount);
  iterator=SortUtil.extractAndSort(iterator,new Function<String,Comparable>(){
    public Comparable apply(    String input){
      return getTsStr(input);
    }
  }
);
  long lastTs=0;
  while (iterator.hasNext()) {
    counter++;
    String row=iterator.next();
    System.out.println(row);
    long ts=Long.parseLong(getTsStr(row));
    Assert.assertTrue(ts >= lastTs);
    lastTs=ts;
  }
  Assert.assertEquals(totalCount,counter);
}
