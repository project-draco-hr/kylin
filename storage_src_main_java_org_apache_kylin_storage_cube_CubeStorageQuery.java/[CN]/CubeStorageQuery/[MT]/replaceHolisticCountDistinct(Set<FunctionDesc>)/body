{
  Set<FunctionDesc> result=new LinkedHashSet<FunctionDesc>();
  for (  FunctionDesc metric : metrics) {
    if (metric.isCountDistinct() == false) {
      result.add(metric);
      continue;
    }
    FunctionDesc holisticVersion=null;
    for (    MeasureDesc measure : cubeDesc.getMeasures()) {
      FunctionDesc measureFunc=measure.getFunction();
      if (measureFunc.equals(metric) && measureFunc.isHolisticCountDistinct()) {
        holisticVersion=measureFunc;
      }
    }
    result.add(holisticVersion == null ? metric : holisticVersion);
  }
  return result;
}
