{
  if (cubeInstance.getSegments().size() < 2) {
    throw new CubeIntegrityException("No segments to merge.");
  }
  if (newSegments.size() != 1) {
    throw new CubeIntegrityException("Invalid date range.");
  }
  CubeSegment newSegment=newSegments.get(0);
  CubeSegment startSeg=null;
  CubeSegment endSeg=null;
  for (  CubeSegment segment : cubeInstance.getSegments()) {
    if (segment.getDateRangeStart() == newSegment.getDateRangeStart()) {
      startSeg=segment;
    }
    if (segment.getDateRangeEnd() == newSegment.getDateRangeEnd()) {
      endSeg=segment;
    }
  }
  if (null == startSeg || null == endSeg || startSeg.getDateRangeStart() >= endSeg.getDateRangeStart()) {
    throw new CubeIntegrityException("Invalid date range.");
  }
}
