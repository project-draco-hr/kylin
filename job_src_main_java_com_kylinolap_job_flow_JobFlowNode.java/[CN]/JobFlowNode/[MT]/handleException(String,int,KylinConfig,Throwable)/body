{
  log.error(t.getLocalizedMessage(),t);
  String exceptionMsg="Failed with Exception:" + ExceptionUtils.getFullStackTrace(t);
  try {
    JobDAO dao=JobDAO.getInstance(config);
    JobInstance jobInstance=dao.getJob(jobInstanceUuid);
    JobStep jobStep=jobInstance.getSteps().get(jobInstanceStepSeqId);
    jobStep.setStatus(JobStepStatusEnum.ERROR);
    jobStep.setExecEndTime(System.currentTimeMillis());
    dao.updateJobInstance(jobInstance);
    String output=dao.getJobOutput(jobInstanceUuid,jobInstanceStepSeqId).getOutput();
    output=output + "\n" + exceptionMsg;
    dao.saveJobOutput(jobInstanceUuid,jobInstanceStepSeqId,output);
  }
 catch (  IOException e1) {
    log.error(e1.getLocalizedMessage(),e1);
  }
}
