{
  final IIInstance ii=IIManager.getInstance(getTestConfig()).getII("test_kylin_ii_left_join");
  final TableRecordInfo tableRecordInfo=new TableRecordInfo(ii.getFirstSegment());
  final EndpointAggregators endpointAggregators=EndpointAggregators.fromFunctions(tableRecordInfo,buildAggregations());
  byte[] x=EndpointAggregators.serialize(endpointAggregators);
  final EndpointAggregators result=EndpointAggregators.deserialize(x);
  assertArrayEquals(endpointAggregators.dataTypes,result.dataTypes);
  assertArrayEquals(endpointAggregators.funcNames,result.funcNames);
  assertArrayEquals(endpointAggregators.metricValues,result.metricValues);
  assertEquals(endpointAggregators.rawTableRecord.getBytes().length,result.rawTableRecord.getBytes().length);
}
