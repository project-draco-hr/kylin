{
  for (int i=0; i < tableData.size(); ++i) {
    byte[] data=tableData.get(i).getBytes();
    AggrKey aggKey=projector.getAggrKey(data);
    MeasureAggregator[] bufs=aggCache.getBuffer(aggKey);
    aggregators.aggregate(bufs,data);
    aggCache.checkMemoryUsage();
  }
  assertEquals(aggCache.getAllEntries().size(),2);
  long sumTotal=0;
  long minTotal=0;
  for (  Map.Entry<AggrKey,MeasureAggregator[]> entry : aggCache.getAllEntries()) {
    sumTotal+=((LongWritable)entry.getValue()[0].getState()).get();
    minTotal+=((LongWritable)entry.getValue()[1].getState()).get();
  }
  assertEquals(3020800,sumTotal);
  assertEquals(1020900,minTotal);
}
