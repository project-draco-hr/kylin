{
  final Slice slice=sliceBuilder.buildSlice(streamingBatch);
  ImmutableBytesWritable value, dictionary;
  for (  IIRow pair : kv.encodeKeyValue(slice)) {
    value=pair.getValue();
    dictionary=pair.getDictionary();
    int newLength=4 + value.getLength() + dictionary.getLength();
    if (newLength > valueBuf.limit()) {
      valueBuf=ByteBuffer.allocate(newLength);
    }
    valueBuf.clear();
    valueBuf.putInt(value.getLength());
    valueBuf.put(value.get(),value.getOffset(),value.getLength());
    valueBuf.put(dictionary.get(),dictionary.getOffset(),dictionary.getLength());
    immutableBytesWritable.set(valueBuf.array(),0,newLength);
    context.write(pair.getKey(),immutableBytesWritable);
  }
}
