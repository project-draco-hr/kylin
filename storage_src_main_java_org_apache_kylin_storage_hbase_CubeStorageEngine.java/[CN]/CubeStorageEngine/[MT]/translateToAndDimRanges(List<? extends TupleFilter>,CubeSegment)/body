{
  Map<TblColRef,ColumnValueRange> rangeMap=new HashMap<TblColRef,ColumnValueRange>();
  boolean isEmptyAnd=false;
  for (  TupleFilter filter : andFilters) {
    if ((filter instanceof CompareTupleFilter) == false) {
      continue;
    }
    CompareTupleFilter comp=(CompareTupleFilter)filter;
    if (comp.getColumn() == null) {
      continue;
    }
    Collection<String> newValues=TupleFilterValueOptimizer.doOptimization(cubeSegment,comp.getColumn(),comp);
    if (TupleFilterValueOptimizer.isEmptyAnd(comp,newValues)) {
      isEmptyAnd=true;
      break;
    }
    ColumnValueRange range=new ColumnValueRange(comp.getColumn(),newValues,comp.getOperator());
    andMerge(range,rangeMap);
  }
  return isEmptyAnd ? Collections.<ColumnValueRange>emptyList() : rangeMap.values();
}
