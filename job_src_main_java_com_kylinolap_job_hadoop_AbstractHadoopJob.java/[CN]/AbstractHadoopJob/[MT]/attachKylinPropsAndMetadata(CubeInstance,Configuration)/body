{
  File tmp=File.createTempFile("kylin_job_meta","");
  tmp.delete();
  File metaDir=new File(tmp,"meta");
  metaDir.mkdirs();
  metaDir.getParentFile().deleteOnExit();
  KylinConfig kylinConfig=KylinConfig.getInstanceFromEnv();
  File kylinPropsFile=new File(metaDir,"kylin.properties");
  kylinConfig.writeProperties(kylinPropsFile);
  ArrayList<String> dumpList=new ArrayList<String>();
  dumpList.add(cube.getResourcePath());
  dumpList.add(cube.getDescriptor().getResourcePath());
  if (cube.isInvertedIndex()) {
    dumpList.add(cube.getInvertedIndexDesc().getResourcePath());
  }
  for (  TableDesc table : cube.getDescriptor().listTables()) {
    dumpList.add(table.getResourcePath());
  }
  for (  CubeSegment segment : cube.getSegments()) {
    dumpList.addAll(segment.getDictionaryPaths());
  }
  dumpResources(kylinConfig,metaDir,dumpList);
  conf.set("tmpfiles","file:///" + OptionsHelper.convertToFileURL(metaDir.getAbsolutePath()));
}
