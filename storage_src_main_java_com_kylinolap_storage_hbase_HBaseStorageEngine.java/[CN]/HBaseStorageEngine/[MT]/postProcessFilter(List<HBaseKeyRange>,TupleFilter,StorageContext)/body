{
  if (cubeDesc.getCubePartitionDesc().getPartitionDateColumn() != null) {
    Iterator<HBaseKeyRange> iterator=scans.iterator();
    while (iterator.hasNext()) {
      HBaseKeyRange scan=iterator.next();
      if (scan.hitSegment() == false) {
        iterator.remove();
      }
    }
  }
  if (!scans.isEmpty()) {
    Cuboid cuboid=scans.get(0).getCuboid();
    context.addCuboid(cuboid);
    if (!cuboid.requirePostAggregation() && context.isExactAggregation() && flatFilter == null && !context.hasSort()) {
      logger.info("Enable limit " + context.getLimit());
      context.enableLimit();
    }
  }
}
