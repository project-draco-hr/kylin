{
  Map<TblColRef,ColumnValueRange> rangeMap=new HashMap<TblColRef,ColumnValueRange>();
  for (  TupleFilter filter : andFilters) {
    if (filter instanceof ExtractTupleFilter) {
      continue;
    }
    CompareTupleFilter comp=(CompareTupleFilter)filter;
    if (comp.getColumn() == null) {
      continue;
    }
    ColumnValueRange range=new ColumnValueRange(comp.getColumn(),comp.getValues(),comp.getOperator());
    TblColRef column=comp.getColumn();
    if (cubeDesc.isDerived(column)) {
      DeriveInfo hostInfo=cubeDesc.getHostInfo(column);
      ColumnValueRange[] hostRanges=mapDerivedToHostRanges(cubeSegment,range,hostInfo);
      for (      ColumnValueRange hostRange : hostRanges) {
        andMerge(hostRange,rangeMap);
      }
    }
 else {
      andMerge(range,rangeMap);
    }
  }
  return rangeMap.values();
}
