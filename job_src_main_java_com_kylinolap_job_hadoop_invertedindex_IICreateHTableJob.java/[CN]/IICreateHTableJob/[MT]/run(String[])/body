{
  Options options=new Options();
  try {
    options.addOption(OPTION_CUBE_NAME);
    options.addOption(OPTION_HTABLE_NAME);
    parseOptions(options,args);
    String tableName=getOptionValue(OPTION_HTABLE_NAME);
    String cubeName=getOptionValue(OPTION_CUBE_NAME);
    CubeInstance cubeInstance=CubeManager.getInstance(KylinConfig.getInstanceFromEnv()).getCube(cubeName);
    int sharding=cubeInstance.getInvertedIndexDesc().getSharding();
    HTableDescriptor tableDesc=new HTableDescriptor(TableName.valueOf(tableName));
    HColumnDescriptor cf=new HColumnDescriptor(InvertedIndexDesc.HBASE_FAMILY);
    cf.setMaxVersions(1);
    cf.setCompressionType(Algorithm.LZO);
    cf.setDataBlockEncoding(DataBlockEncoding.FAST_DIFF);
    tableDesc.addFamily(cf);
    Configuration conf=HBaseConfiguration.create(getConf());
    if (User.isHBaseSecurityEnabled(conf)) {
      tableDesc.addCoprocessor("org.apache.hadoop.hbase.security.access.SecureBulkLoadEndpoint");
    }
    HBaseAdmin admin=new HBaseAdmin(conf);
    if (admin.tableExists(tableName)) {
      admin.disableTable(tableName);
      admin.deleteTable(tableName);
    }
    byte[][] splitKeys=getSplits(sharding);
    if (splitKeys.length == 0)     splitKeys=null;
    admin.createTable(tableDesc,splitKeys);
    if (splitKeys != null) {
      for (int i=0; i < splitKeys.length; i++) {
        System.out.println("split key " + i + ": "+ BytesUtil.toHex(splitKeys[i]));
      }
    }
    System.out.println("create hbase table " + tableName + " done.");
    admin.close();
    return 0;
  }
 catch (  Exception e) {
    printUsage(options);
    e.printStackTrace(System.err);
    log.error(e.getLocalizedMessage(),e);
    return 2;
  }
}
