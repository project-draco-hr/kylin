{
  byte[] startRow=Bytes.toBytes(rangeStart);
  byte[] endRow=plusZero(Bytes.toBytes(rangeEnd));
  Scan scan=new Scan(startRow,endRow);
  scan.addColumn(B_FAMILY,B_COLUMN_TS);
  scan.addColumn(B_FAMILY,B_COLUMN);
  scan.setFilter(generateTimeFilterList(timeStartInMillis,timeEndInMillis));
  tuneScanParameters(scan);
  HTableInterface table=getConnection().getTable(getAllInOneTableName());
  List<RawResource> result=Lists.newArrayList();
  try {
    ResultScanner scanner=table.getScanner(scan);
    for (    Result r : scanner) {
      result.add(new RawResource(getInputStream(Bytes.toString(r.getRow()),r),getTimestamp(r)));
    }
  }
 catch (  IOException e) {
    for (    RawResource rawResource : result) {
      IOUtils.closeQuietly(rawResource.inputStream);
    }
    throw e;
  }
 finally {
    IOUtils.closeQuietly(table);
  }
  return result;
}
