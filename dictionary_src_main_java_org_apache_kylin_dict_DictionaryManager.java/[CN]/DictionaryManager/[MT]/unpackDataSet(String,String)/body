{
  InputStream in=this.getClass().getResourceAsStream("/org/apache/kylin/dict/" + dataSetName + ".txt");
  if (in == null)   return null;
  ByteArrayOutputStream buf=new ByteArrayOutputStream();
  IOUtils.copy(in,buf);
  in.close();
  byte[] bytes=buf.toByteArray();
  Path tmpDataSetPath=new Path(tempHDFSDir + "/dict/temp_dataset/" + dataSetName+ "_"+ bytes.length+ ".txt");
  FileSystem fs=HadoopUtil.getFileSystem(tempHDFSDir);
  boolean writtenNewFile=false;
  if (fs.exists(tmpDataSetPath) == false || fs.getFileStatus(tmpDataSetPath).getLen() != bytes.length) {
    fs.mkdirs(tmpDataSetPath.getParent());
    FSDataOutputStream out=fs.create(tmpDataSetPath);
    IOUtils.copy(new ByteArrayInputStream(bytes),out);
    out.close();
    writtenNewFile=true;
  }
  String qualifiedPath=tmpDataSetPath.makeQualified(fs.getUri(),new Path("/")).toString();
  if (writtenNewFile)   logger.info("Dictionary temp data set file written to " + qualifiedPath);
  return qualifiedPath;
}
