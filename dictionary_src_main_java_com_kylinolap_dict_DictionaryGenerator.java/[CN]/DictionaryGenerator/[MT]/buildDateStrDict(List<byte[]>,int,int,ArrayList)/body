{
  final int BAD_THRESHOLD=2;
  String matchPattern=null;
  for (  String ptn : DATE_PATTERNS) {
    matchPattern=ptn;
    int badCount=0;
    SimpleDateFormat sdf=new SimpleDateFormat(ptn);
    for (    byte[] value : values) {
      if (value.length == 0)       continue;
      String str=Bytes.toString(value);
      try {
        sdf.parse(str);
        if (samples.size() < nSamples && samples.contains(str) == false)         samples.add(str);
      }
 catch (      ParseException e) {
        logger.info("Unrecognized datetime value: " + str);
        badCount++;
        if (badCount > BAD_THRESHOLD) {
          matchPattern=null;
          break;
        }
      }
    }
    if (matchPattern != null)     return new DateStrDictionary(matchPattern,baseId);
  }
  throw new IllegalStateException("Unrecognized datetime value");
}
