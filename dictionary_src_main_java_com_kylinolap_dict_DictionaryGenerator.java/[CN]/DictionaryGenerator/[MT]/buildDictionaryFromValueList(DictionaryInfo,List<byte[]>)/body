{
  info.setCardinality(values.size());
  Dictionary dict=null;
  int baseId=0;
  int nSamples=5;
  ArrayList samples=new ArrayList();
  DataType dataType=DataType.getInstance(info.getDataType());
  if (dataType.isDateTimeFamily())   dict=buildDateStrDict(values,baseId,nSamples,samples);
 else   if (dataType.isNumberFamily())   dict=buildNumberDict(values,baseId,nSamples,samples);
 else   dict=buildStringDict(values,baseId,nSamples,samples);
  StringBuilder buf=new StringBuilder();
  for (  Object s : samples) {
    if (buf.length() > 0)     buf.append(", ");
    buf.append(s.toString()).append("=>").append(dict.getIdFromValue(s));
  }
  logger.info("Dictionary value samples: " + buf.toString());
  logger.info("Dictionary cardinality " + info.getCardinality());
  if (values.size() > 1000000)   throw new IllegalArgumentException("Too high cardinality is not suitable for dictionary! Are the values stable enough for incremental load??");
  return dict;
}
