{
  ColumnDesc columnDesc=tableDesc.findColumnByName("LSTG_FORMAT_NAME");
  TblColRef lfn=new TblColRef(columnDesc);
  Collection<TblColRef> groupby=ImmutableSet.of(lfn);
  ColumnDesc priceColumn=tableDesc.findColumnByName("PRICE");
  List<FunctionDesc> measures=buildAggregations(priceColumn);
  EndpointTupleIterator iterator=new EndpointTupleIterator(seg,tupleFilter,groupby,measures,context,hconn);
  int count=0;
  while (iterator.hasNext()) {
    ITuple tuple=iterator.next();
    count+=(Long)tuple.getValue("COUNT__");
  }
  iterator.close();
  return count;
}
