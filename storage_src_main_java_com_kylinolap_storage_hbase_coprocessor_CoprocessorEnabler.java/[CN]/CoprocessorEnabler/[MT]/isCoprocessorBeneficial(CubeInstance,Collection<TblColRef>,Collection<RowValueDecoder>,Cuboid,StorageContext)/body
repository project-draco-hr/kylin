{
  if (context.isAvoidAggregation()) {
    logger.info("Coprocessor is disabled because context tells to avoid aggregation");
    return false;
  }
  String forceFlag=System.getProperty(FORCE_COPROCESSOR);
  if (forceFlag != null) {
    return Boolean.parseBoolean(forceFlag);
  }
  Boolean cubeOverride=CUBE_OVERRIDES.get(cube.getName());
  if (cubeOverride != null) {
    return cubeOverride.booleanValue();
  }
  if (RowValueDecoder.hasMemHungryCountDistinct(rowValueDecoders)) {
    logger.info("Coprocessor is disabled because there is memory hungry count distinct");
    return false;
  }
  HashSet<TblColRef> aggrCols=new HashSet<TblColRef>(cuboid.getColumns());
  aggrCols.removeAll(groupBy);
  if (aggrCols.isEmpty()) {
    logger.info("Coprocessor is disabled because cuboid is exactly the scan group by");
    return false;
  }
  logger.info("Coprocessor is enabled to aggregate " + aggrCols);
  return true;
}
