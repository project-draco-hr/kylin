{
  if (context.isAvoidAggregation()) {
    logger.info("Coprocessor is disabled because context tells to avoid aggregation");
    return false;
  }
  String forceFlag=System.getProperty(FORCE_COPROCESSOR);
  if (forceFlag != null) {
    return Boolean.parseBoolean(forceFlag);
  }
  Boolean cubeOverride=CUBE_OVERRIDES.get(keyRange.getCubeSegment().getCubeInstance().getName());
  if (cubeOverride != null) {
    return cubeOverride.booleanValue();
  }
  if (!cuboid.requirePostAggregation()) {
    logger.info("Coprocessor is disabled because cuboid is directly hit");
    return false;
  }
  if (RowValueDecoder.hasMemHungryCountDistinct(rowValueDecoders)) {
    logger.info("Coprocessor is disabled because there is memory hungry count distinct");
    return false;
  }
  logger.info("Coprocessor is enabled");
  return true;
}
