{
  if (context.isAvoidAggregation()) {
    logger.info("Coprocessor is disabled because context tells to avoid aggregation");
    return false;
  }
  String forceFlag=System.getProperty(FORCE_COPROCESSOR);
  if (forceFlag != null) {
    return Boolean.parseBoolean(forceFlag);
  }
  Boolean cubeOverride=CUBE_OVERRIDES.get(cube.getName());
  if (cubeOverride != null) {
    return cubeOverride.booleanValue();
  }
  if (RowValueDecoder.hasMemHungryCountDistinct(rowValueDecoders)) {
    logger.info("Coprocessor is disabled because there is memory hungry count distinct");
    return false;
  }
  if (context.isExactAggregation()) {
    logger.info("Coprocessor is disabled because exactAggregation is true");
    return false;
  }
  logger.info("Coprocessor is enabled, group by " + groupBy);
  return true;
}
