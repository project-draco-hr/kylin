{
  ResourceStore store=getStore();
  CubeDesc ndesc=null;
  try {
    ndesc=store.getResource(path,CubeDesc.class,CUBE_DESC_SERIALIZER);
  }
 catch (  IOException e) {
    logger.debug("Get exception when load CubeDesc on " + path + ", going to do CubeDesc upgrade...");
    CubeDescUpgrader upgrade=new CubeDescUpgrader(path);
    ndesc=upgrade.upgrade();
    ndesc.setUpgraded(true);
    logger.debug("CubeDesc upgrade successful for " + path);
  }
  if (StringUtils.isBlank(ndesc.getName())) {
    throw new IllegalStateException("CubeDesc name must not be blank");
  }
  ndesc.init(config,getMetadataManager().getAllTablesMap());
  if (ndesc.getError().isEmpty() == false) {
    throw new IllegalStateException("Cube desc at " + path + " has issues: "+ ndesc.getError());
  }
  return ndesc;
}
