{
  SetMultimap<TblColRef,String> valueMap=HashMultimap.create();
  List<TblColRef> dimColumns=desc.listDimensionColumnsExcludingDerived();
  for (  List<String> row : table) {
    for (int i=0; i < dimColumns.size(); i++) {
      String cell=row.get(i);
      valueMap.put(dimColumns.get(i),cell);
    }
  }
  for (  DimensionDesc dim : desc.getDimensions()) {
    for (    TblColRef col : dim.getColumnRefs()) {
      if (desc.getRowkey().isUseDictionary(col)) {
        Dictionary dict=DictionaryGenerator.buildDictionaryFromValueList(col.getType(),Collections2.transform(valueMap.get(col),new Function<String,byte[]>(){
          @Nullable @Override public byte[] apply(          String input){
            return input.getBytes();
          }
        }
));
        logger.info("Building dictionary for " + col);
        DictionaryInfo dictInfo=new DictionaryInfo(col.getTable(),col.getName(),0,col.getDatatype(),null,"");
        dictInfo.setDictionaryObject(dict);
        dictInfo.setDictionaryClass(dict.getClass().getName());
        dictionaryMap.put(col,dictInfo);
      }
    }
  }
}
