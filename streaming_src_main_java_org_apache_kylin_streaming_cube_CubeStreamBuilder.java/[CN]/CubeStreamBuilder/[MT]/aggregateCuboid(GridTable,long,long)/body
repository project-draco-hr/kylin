{
  Pair<BitSet,BitSet> columnBitSets=getDimensionAndMetricColumBitSet(parentCuboidId);
  BitSet dimensionBitSet=columnBitSets.getFirst();
  long mask=Long.highestOneBit(parentCuboidId);
  long childCuboidId=cuboidId;
  long parentCuboidIdActualLength=Long.SIZE - Long.numberOfLeadingZeros(parentCuboidId);
  int index=0;
  for (int i=0; i < parentCuboidIdActualLength; i++) {
    if ((mask & parentCuboidId) > 0) {
      if ((mask & childCuboidId) == 0) {
        dimensionBitSet.set(index,false);
      }
      index++;
    }
    mask=mask >> 1;
  }
  IGTScanner scanner=parentCuboid.scanAndAggregate(null,null,dimensionBitSet,columnBitSets.getSecond(),metricsAggrFuncs,null);
  GridTable cuboidGridTable=newGridTableByCuboidID(cuboidId);
  GTBuilder builder=cuboidGridTable.rebuild();
  for (  GTRecord record : scanner) {
    builder.write(record);
  }
  builder.close();
  return cuboidGridTable;
}
