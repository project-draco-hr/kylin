{
  super(queue,10000);
  this.desc=desc;
  this.partitionId=partitionId;
  this.cuboidScheduler=new CuboidScheduler(desc);
  CubeManager cubeManager=CubeManager.getInstance(KylinConfig.getInstanceFromEnv());
  List<CubeInstance> cubes=cubeManager.getCubesByDesc(this.desc.getName());
  cube=cubes.get(0);
  measureCodec=new MeasureCodec(desc.getMeasures());
  aggs=new MeasureAggregators(desc.getMeasures());
  measureNumber=desc.getMeasures().size();
  List<String> metricsAggrFuncsList=Lists.newArrayList();
  for (int i=0, n=desc.getMeasures().size(); i < n; i++) {
    MeasureDesc measureDesc=desc.getMeasures().get(i);
    metricsAggrFuncsList.add(measureDesc.getFunction().getExpression());
  }
  metricsAggrFuncs=metricsAggrFuncsList.toArray(new String[metricsAggrFuncsList.size()]);
}
