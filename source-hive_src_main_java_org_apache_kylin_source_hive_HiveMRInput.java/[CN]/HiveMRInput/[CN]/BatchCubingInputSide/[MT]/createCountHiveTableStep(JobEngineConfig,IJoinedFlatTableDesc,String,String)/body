{
  final ShellExecutable step=new ShellExecutable();
  final HiveCmdBuilder hiveCmdBuilder=new HiveCmdBuilder();
  final KylinConfig kylinConfig=((CubeSegment)flatTableDesc.getSegment()).getConfig();
  if (kylinConfig.getMRConfigOverride().get(MR_OVERRIDE_JOB_QUEUENAME) != null) {
    hiveCmdBuilder.addStatement("SET mapreduce.job.queuename =" + kylinConfig.getMRConfigOverride().get(MR_OVERRIDE_JOB_QUEUENAME) + ";\n");
  }
  hiveCmdBuilder.addStatement(JoinedFlatTable.generateHiveSetStatements(conf));
  hiveCmdBuilder.addStatement("set hive.exec.compress.output=false;\n");
  hiveCmdBuilder.addStatement(JoinedFlatTable.generateCountDataStatement(flatTableDesc,rowCountOutputDir));
  step.setCmd(hiveCmdBuilder.build());
  step.setName(ExecutableConstants.STEP_NAME_COUNT_HIVE_TABLE);
  return step;
}
