{
  final ShellExecutable step=new ShellExecutable();
  final HiveCmdBuilder hiveCmdBuilder=new HiveCmdBuilder();
  try {
    hiveCmdBuilder.addStatement(JoinedFlatTable.generateHiveSetStatements(conf));
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to generate hive set statements for createCountHiveTableStep",e);
  }
  hiveCmdBuilder.addStatement("set hive.exec.compress.output=false;\n");
  hiveCmdBuilder.addStatement(JoinedFlatTable.generateCountDataStatement(flatTableDesc,rowCountOutputDir));
  step.setCmd(hiveCmdBuilder.build());
  step.setName(ExecutableConstants.STEP_NAME_COUNT_HIVE_TABLE);
  return step;
}
