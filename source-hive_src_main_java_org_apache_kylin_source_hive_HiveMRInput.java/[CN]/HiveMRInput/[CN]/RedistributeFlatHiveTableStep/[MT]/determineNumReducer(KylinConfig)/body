{
  computeRowCount(config.getCliCommandExecutor());
  Path rowCountFile=new Path(getRowCountOutputDir(),"000000_0");
  long rowCount=readRowCountFromFile(rowCountFile);
  int mapperInputRows=config.getHadoopJobMapperInputRows();
  int numReducers=Math.round(rowCount / ((float)mapperInputRows));
  numReducers=Math.max(1,numReducers);
  stepLogger.log("total input rows = " + rowCount);
  stepLogger.log("expected input rows per mapper = " + mapperInputRows);
  stepLogger.log("num reducers for RedistributeFlatHiveTableStep = " + numReducers);
  return numReducers;
}
