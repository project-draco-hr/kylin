{
  String sql=null;
  try {
    sql=cubeService.getJobManager().previewFlatHiveQL(cubeName,segmentName);
  }
 catch (  JobException e) {
    logger.error(e.getLocalizedMessage(),e);
    throw new InternalErrorException(e.getLocalizedMessage());
  }
catch (  UnknownHostException e) {
    logger.error(e.getLocalizedMessage(),e);
    throw new InternalErrorException(e.getLocalizedMessage());
  }
  GeneralResponse repsonse=new GeneralResponse();
  repsonse.setProperty("sql",sql);
  return repsonse;
}
