{
  GetMethod get=new GetMethod(conn.getMetaProjectUrl(project));
  HttpClient httpClient=new HttpClient();
  if (conn.getConnectUrl().toLowerCase().startsWith("https://")) {
    registerSsl();
  }
  addPostHeaders(get);
  List<TableMetaStub> tableMetaStubs=null;
  try {
    httpClient.executeMethod(get);
    if (get.getStatusCode() != 200 && get.getStatusCode() != 201) {
      logger.error("Connect failed with error code " + get.getStatusCode() + " and message:\n"+ get.getResponseBodyAsString());
      throw new ConnectionException("Connect failed, error code " + get.getStatusCode() + " and message: "+ get.getResponseBodyAsString());
    }
    tableMetaStubs=new ObjectMapper().readValue(get.getResponseBodyAsString(),new TypeReference<List<TableMetaStub>>(){
    }
);
    List<KylinMetaImpl.MetaTable> tables=new ArrayList<KylinMetaImpl.MetaTable>();
    HashMultimap<String,KylinMetaImpl.MetaTable> schemasMap=HashMultimap.create();
    for (    TableMetaStub tableMetaStub : tableMetaStubs) {
      List<KylinMetaImpl.MetaColumn> columns=new ArrayList<KylinMetaImpl.MetaColumn>();
      for (      ColumnMetaStub columnMetaStub : tableMetaStub.getColumns()) {
        KylinMetaImpl.MetaColumn column=createNewColumn(columnMetaStub);
        columns.add(column);
      }
      KylinMetaImpl.MetaTable table=createNewTable(tableMetaStub,columns);
      tables.add(table);
      schemasMap.put(tableMetaStub.getTABLE_CAT() + "#" + tableMetaStub.getTABLE_SCHEM(),table);
    }
    HashMultimap<String,KylinMetaImpl.MetaSchema> catalogMap=HashMultimap.create();
    List<KylinMetaImpl.MetaSchema> schemas=new ArrayList<KylinMetaImpl.MetaSchema>();
    for (    String key : schemasMap.keySet()) {
      String cat=key.split("#")[0];
      String schema=key.split("#")[1];
      KylinMetaImpl.MetaSchema metaSchema=new KylinMetaImpl.MetaSchema(cat,schema,new ArrayList<KylinMetaImpl.MetaTable>(schemasMap.get(key)));
      schemas.add(metaSchema);
      catalogMap.put(cat,metaSchema);
    }
    List<KylinMetaImpl.MetaCatalog> catalogs=new ArrayList<KylinMetaImpl.MetaCatalog>();
    for (    String key : catalogMap.keySet()) {
      KylinMetaImpl.MetaCatalog metaCatalog=new KylinMetaImpl.MetaCatalog(key,new ArrayList<KylinMetaImpl.MetaSchema>(catalogMap.get(key)));
      catalogs.add(metaCatalog);
    }
    return new KylinMetaImpl.MetaProject(project,catalogs);
  }
 catch (  HttpException e) {
    logger.error(e.getLocalizedMessage(),e);
    throw new ConnectionException(e.getLocalizedMessage());
  }
catch (  IOException e) {
    logger.error(e.getLocalizedMessage(),e);
    throw new ConnectionException(e.getLocalizedMessage());
  }
}
