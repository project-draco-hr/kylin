{
  if (context.isLimitEnabled() && scanCount >= context.getLimit() + context.getOffset()) {
    return false;
  }
  if (context.isAcceptPartialResult() && scanCount > partialResultLimit) {
    context.setPartialResultReturned(true);
    return false;
  }
  if (scanCount >= context.getThreshold()) {
    throw new ScanOutOfLimitException("Scan row count exceeded threshold: " + context.getThreshold() + ", please add filter condition to narrow down backend scan range, like where clause.");
  }
  return segmentIteratorIterator.hasNext() || segmentIterator.hasNext();
}
