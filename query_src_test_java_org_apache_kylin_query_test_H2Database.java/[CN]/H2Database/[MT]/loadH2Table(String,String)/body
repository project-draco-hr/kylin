{
  MetadataManager metaMgr=MetadataManager.getInstance(config);
  TableDesc tableDesc=metaMgr.getTableDesc(tableName.toUpperCase());
  File tempFile=null;
  String fileNameSuffix=joinType.equalsIgnoreCase("default") ? "" : "." + joinType;
  try {
    tempFile=File.createTempFile("tmp_h2",".csv");
    FileOutputStream tempFileStream=new FileOutputStream(tempFile);
    String normalPath="/data/" + tableDesc.getIdentity() + ".csv";
    RawResource res=metaMgr.getStore().getResource(normalPath + fileNameSuffix);
    if (res == null) {
      res=metaMgr.getStore().getResource(normalPath);
    }
 else {
      logger.info("H2 decides to load " + (normalPath + fileNameSuffix) + " for table "+ tableDesc.getIdentity());
    }
    org.apache.commons.io.IOUtils.copy(res.inputStream,tempFileStream);
    res.inputStream.close();
    tempFileStream.close();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  String cvsFilePath=tempFile.getPath();
  Statement stmt=h2Connection.createStatement();
  String createDBSql="CREATE SCHEMA IF NOT EXISTS DEFAULT;\nCREATE SCHEMA IF NOT EXISTS EDW;\nSET SCHEMA DEFAULT;\n";
  stmt.executeUpdate(createDBSql);
  String sql=generateCreateH2TableSql(tableDesc,cvsFilePath);
  stmt.executeUpdate(sql);
  if (tempFile != null)   tempFile.delete();
}
