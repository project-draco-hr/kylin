{
  Cuboid cuboid=Cuboid.findById(cubeDesc,cuboidId);
  List<TblColRef> dimCols=cuboid.getColumns();
  int nColumns=dimCols.size() + cubeDesc.getMeasures().size();
  ArrayList<BitSet> colBlocks=new ArrayList<BitSet>();
  BitSet dimensions=new BitSet();
  dimensions.set(0,dimCols.size());
  colBlocks.add(dimensions);
  DataType[] dataTypes=new DataType[nColumns];
  Map<Integer,Dictionary> dictionaryByColIdx=Maps.newHashMap();
  Map<Integer,Integer> fixLenByColIdx=Maps.newHashMap();
  int colIndex=0;
  for (  TblColRef col : dimCols) {
    dataTypes[colIndex]=col.getType();
    if (cubeDesc.getRowkey().isUseDictionary(col)) {
      Dictionary dict=dictionaryMap.get(col);
      if (dict == null)       throw new IllegalStateException();
      dictionaryByColIdx.put(colIndex,dict);
    }
 else {
      int len=cubeDesc.getRowkey().getColumnLength(col);
      if (len == 0)       throw new IllegalStateException();
      fixLenByColIdx.put(colIndex,len);
    }
    colIndex++;
  }
  for (  HBaseColumnFamilyDesc familyDesc : cubeDesc.getHbaseMapping().getColumnFamily()) {
    for (    HBaseColumnDesc hbaseColDesc : familyDesc.getColumns()) {
      BitSet colBlock=new BitSet();
      for (      MeasureDesc measure : hbaseColDesc.getMeasures()) {
        dataTypes[colIndex]=measure.getFunction().getReturnDataType();
        colBlock.set(colIndex);
        colIndex++;
      }
      colBlocks.add(colBlock);
    }
  }
  GTInfo.Builder builder=GTInfo.builder();
  builder.setCodeSystem(new CubeCodeSystem(dictionaryByColIdx,fixLenByColIdx));
  builder.setColumns(dataTypes);
  builder.setPrimaryKey(dimensions);
  builder.enableColumnBlock((BitSet[])colBlocks.toArray(new BitSet[colBlocks.size()]));
  return builder.build();
}
