{
  seg=iiSegment;
  desc=seg.getIIInstance().getDescriptor();
  tableDesc=desc.getFactTableDesc();
  nColumns=tableDesc.getColumnCount();
  colNames=new String[nColumns];
  dictionaries=new Dictionary<?>[nColumns];
  measureSerializers=new FixedLenMeasureCodec<?>[nColumns];
  DictionaryManager dictMgr=DictionaryManager.getInstance(desc.getConfig());
  for (  ColumnDesc col : tableDesc.getColumns()) {
    int i=col.getZeroBasedIndex();
    colNames[i]=col.getName();
    if (desc.isMetricsCol(i)) {
      measureSerializers[i]=FixedLenMeasureCodec.get(col.getType());
    }
 else {
      String dictPath=seg.getDictResPath(new TblColRef(col));
      try {
        dictionaries[i]=dictMgr.getDictionary(dictPath);
      }
 catch (      IOException e) {
        throw new RuntimeException("dictionary " + dictPath + " does not exist ",e);
      }
    }
  }
  digest=createDigest();
}
