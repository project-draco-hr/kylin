{
  Broadcaster.TYPE wipeType=Broadcaster.TYPE.getType(type);
  EVENT wipeEvent=Broadcaster.EVENT.getEvent(event);
  final String log="wipe cache type: " + wipeType + " event:"+ wipeEvent+ " name:"+ name;
  logger.debug(log);
switch (wipeType) {
case TABLE:
switch (wipeEvent) {
case CREATE:
case UPDATE:
      cubeMgmtService.getMetadataManager().reloadTableCache(name);
    break;
case DROP:
  throw new UnsupportedOperationException(log);
}
break;
case DATA_MODEL:
switch (wipeEvent) {
case CREATE:
case UPDATE:
cubeMgmtService.getMetadataManager().reloadDataModelDesc(name);
break;
case DROP:
throw new UnsupportedOperationException(log);
}
break;
case CUBE:
if ("ALL".equalsIgnoreCase(name.toUpperCase())) {
cubeMgmtService.cleanDataCache();
break;
}
switch (wipeEvent) {
case CREATE:
case UPDATE:
cubeMgmtService.reloadCubeCache(name);
break;
case DROP:
cubeMgmtService.removeCubeCache(name);
break;
}
break;
case PROJECT:
if ("ALL".equalsIgnoreCase(name.toUpperCase())) {
projectService.cleanDataCache();
break;
}
switch (wipeEvent) {
case CREATE:
case UPDATE:
projectService.reloadProjectCache(name);
break;
case DROP:
projectService.removeProjectCache(name);
break;
}
break;
default :
throw new UnsupportedOperationException(log);
}
}
