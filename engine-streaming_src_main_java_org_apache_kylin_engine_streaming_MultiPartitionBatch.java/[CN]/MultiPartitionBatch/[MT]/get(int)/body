{
  Preconditions.checkElementIndex(index,size);
  for (int i=0; i < partitionBatchList.size(); ++i) {
    final SinglePartitionBatch batch=partitionBatchList.get(i);
    if (index < batch.size()) {
      return batch.get(index);
    }
 else {
      index=index - batch.size();
    }
  }
  throw new IllegalStateException("index = " + index);
}
