{
  KylinConfig config=KylinConfig.getInstanceFromEnv();
  CubeManager cubeManager=CubeManager.getInstance(config);
  CubeInstance cubeInstance=cubeManager.getCube(cubeName);
  CubeDesc cubeDesc=cubeInstance.getDescriptor();
  CuboidScheduler scheduler=new CuboidScheduler(cubeDesc);
  long baseCuboid=Cuboid.getBaseCuboidId(cubeDesc);
  LinkedList<Long> cuboidQueue=new LinkedList<Long>();
  cuboidQueue.push(baseCuboid);
  long totalSpace=0;
  while (!cuboidQueue.isEmpty()) {
    long cuboidID=cuboidQueue.pop();
    Collection<Long> spanningCuboid=scheduler.getSpanningCuboid(cuboidID);
    for (    Long sc : spanningCuboid) {
      cuboidQueue.push(sc);
    }
    totalSpace+=estimateCuboidSpace(cuboidID,cardinality,cubeDesc);
  }
  return totalSpace;
}
