{
  Pair<Long,Long> firstAndLast=getFirstAndLastOffset(kafkaClusterConfig,partitionId);
  final String topic=kafkaClusterConfig.getTopic();
  logger.info(String.format("topic: %s, partitionId: %d, try to find closest offset with timestamp: %d between offset {%d, %d}",topic,partitionId,timestamp,firstAndLast.getFirst(),firstAndLast.getSecond()));
  final long result=binarySearch(kafkaClusterConfig,partitionId,firstAndLast.getFirst(),firstAndLast.getSecond(),timestamp,streamParser);
  logger.info(String.format("topic: %s, partitionId: %d, found offset: %d",topic,partitionId,result));
  return result;
}
