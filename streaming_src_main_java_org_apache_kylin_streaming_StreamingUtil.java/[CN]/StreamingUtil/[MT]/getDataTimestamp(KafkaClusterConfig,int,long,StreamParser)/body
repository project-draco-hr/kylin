{
  final String topic=kafkaClusterConfig.getTopic();
  final Broker leadBroker=Preconditions.checkNotNull(getLeadBroker(kafkaClusterConfig,partitionId),"unable to find leadBroker with config:" + kafkaClusterConfig + " partitionId:"+ partitionId);
  final FetchResponse response=KafkaRequester.fetchResponse(topic,partitionId,offset,leadBroker,kafkaClusterConfig);
  Preconditions.checkArgument(response.errorCode(topic,partitionId) == 0,"errorCode of FetchResponse is:" + response.errorCode(topic,partitionId));
  final MessageAndOffset messageAndOffset=response.messageSet(topic,partitionId).iterator().next();
  final ByteBuffer payload=messageAndOffset.message().payload();
  byte[] bytes=new byte[payload.limit()];
  payload.get(bytes);
  final ParsedStreamMessage parsedStreamMessage=streamParser.parse(new StreamMessage(messageAndOffset.offset(),bytes));
  return parsedStreamMessage.getTimestamp();
}
