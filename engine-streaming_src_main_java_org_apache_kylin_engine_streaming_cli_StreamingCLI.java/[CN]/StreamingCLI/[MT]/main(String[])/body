{
  try {
    Preconditions.checkArgument(args[0].equals("cube"));
    Preconditions.checkArgument(args[1].equals("start"));
    int i=2;
    BootstrapConfig bootstrapConfig=new BootstrapConfig();
    while (i < args.length) {
      String argName=args[i];
switch (argName) {
case "-start":
        bootstrapConfig.setStart(Long.parseLong(args[++i]));
      break;
case "-end":
    bootstrapConfig.setEnd(Long.parseLong(args[++i]));
  break;
case "-cube":
bootstrapConfig.setCubeName(args[++i]);
break;
case "-fillGap":
bootstrapConfig.setFillGap(Boolean.parseBoolean(args[++i]));
break;
default :
logger.warn("ignore this arg:" + argName);
}
i++;
}
if (bootstrapConfig.isFillGap()) {
final List<Pair<Long,Long>> gaps=StreamingMonitor.findGaps(bootstrapConfig.getCubeName());
logger.info("all gaps:" + StringUtils.join(gaps,","));
for (Pair<Long,Long> gap : gaps) {
startOneOffCubeStreaming(bootstrapConfig.getCubeName(),gap.getFirst(),gap.getSecond());
}
}
 else {
startOneOffCubeStreaming(bootstrapConfig.getCubeName(),bootstrapConfig.getStart(),bootstrapConfig.getEnd());
logger.info("streaming process finished, exit with 0");
System.exit(0);
}
}
 catch (Exception e) {
printArgsError(args);
logger.error("error start streaming",e);
System.exit(-1);
}
}
