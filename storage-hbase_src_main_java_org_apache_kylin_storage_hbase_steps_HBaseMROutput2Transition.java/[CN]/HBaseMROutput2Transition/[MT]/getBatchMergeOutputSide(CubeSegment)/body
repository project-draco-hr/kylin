{
  return new IMRBatchMergeOutputSide2(){
    HBaseMRSteps steps=new HBaseMRSteps(seg);
    @Override public void addStepPhase1_MergeDictionary(    DefaultChainedExecutable jobFlow){
      jobFlow.addTask(steps.createCreateHTableStepWithStats(jobFlow.getId()));
    }
    @Override public void addStepPhase2_BuildCube(    DefaultChainedExecutable jobFlow,    String cuboidRootPath){
      jobFlow.addTask(steps.createConvertCuboidToHfileStep(cuboidRootPath,jobFlow.getId()));
      jobFlow.addTask(steps.createBulkLoadStep(jobFlow.getId()));
    }
    @Override public void addStepPhase3_Cleanup(    DefaultChainedExecutable jobFlow){
      steps.addMergingGarbageCollectionSteps(jobFlow);
    }
  }
;
}
