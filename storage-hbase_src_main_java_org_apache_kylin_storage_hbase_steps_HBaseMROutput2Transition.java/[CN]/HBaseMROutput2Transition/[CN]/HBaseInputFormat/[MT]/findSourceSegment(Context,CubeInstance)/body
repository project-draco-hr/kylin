{
  TableSplit currentSplit=(TableSplit)context.getInputSplit();
  byte[] tableName=currentSplit.getTableName();
  String htableName=Bytes.toString(tableName);
  for (  CubeSegment segment : cubeInstance.getSegments()) {
    String segmentHtable=segment.getStorageLocationIdentifier();
    if (segmentHtable != null && segmentHtable.equalsIgnoreCase(htableName)) {
      return segment;
    }
  }
  throw new IllegalStateException("No merging segment's storage location identifier equals " + htableName);
}
