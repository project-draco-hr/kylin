{
  CubeDesc cubeDesc=cube.getDescriptor();
  Collection<FunctionDesc> functions=digest.aggregations;
  FunctionDesc onlyFunction=functions.iterator().next();
  if (onlyFunction.isSum() == false) {
    return false;
  }
  Collection<TblColRef> dimensionColumnsCopy=new ArrayList<TblColRef>(dimensionColumns);
  for (  MeasureDesc measure : cubeDesc.getMeasures()) {
    if (measure.getFunction().isTopN()) {
      List<TblColRef> cols=measure.getFunction().getParameter().getColRefs();
      TblColRef literalCol=cols.get(cols.size() - 1);
      if (digest.groupbyColumns.contains(literalCol)) {
        dimensionColumnsCopy.remove(literalCol);
        if (isMatchedWithDimensions(dimensionColumnsCopy,cube)) {
          if (measure.getFunction().isTopNCompatibleSum(onlyFunction)) {
            return true;
          }
        }
        dimensionColumnsCopy.add(literalCol);
      }
    }
  }
  return false;
}
