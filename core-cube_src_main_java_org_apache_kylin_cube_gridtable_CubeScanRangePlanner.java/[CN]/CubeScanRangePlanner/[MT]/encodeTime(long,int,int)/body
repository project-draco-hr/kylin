{
  String value;
  DataType partitionColType=gtInfo.getColumnType(index);
  if (partitionColType.isDate()) {
    value=DateFormat.formatToDateStr(ts);
  }
 else   if (partitionColType.isDatetime() || partitionColType.isTimestamp()) {
    value=DateFormat.formatToTimeWithoutMilliStr(ts);
  }
 else   if (partitionColType.isStringFamily()) {
    String partitionDateFormat=cubeSegment.getCubeDesc().getModel().getPartitionDesc().getPartitionDateFormat();
    if (StringUtils.isEmpty(partitionDateFormat))     partitionDateFormat=DateFormat.DEFAULT_DATE_PATTERN;
    value=DateFormat.formatToDateStr(ts,partitionDateFormat);
  }
 else {
    throw new RuntimeException("Type " + partitionColType + " is not valid partition column type");
  }
  ByteBuffer buffer=ByteBuffer.allocate(gtInfo.getMaxColumnLength());
  gtInfo.getCodeSystem().encodeColumnValue(index,value,roundingFlag,buffer);
  return ByteArray.copyOf(buffer.array(),0,buffer.position());
}
