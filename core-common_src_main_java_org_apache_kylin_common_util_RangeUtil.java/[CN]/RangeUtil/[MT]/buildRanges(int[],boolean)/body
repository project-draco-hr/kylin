{
  ArrayList ranges=Lists.newArrayList();
  if (values == null || values.length == 0)   return ranges;
  if (needSort) {
    Arrays.sort(values);
  }
  int lastBegin=values[0];
  int lastEnd=lastBegin;
  for (int index=1; index < values.length; index++) {
    if (values[index] - lastEnd != 1) {
      ranges.add(Ranges.closed(lastBegin,lastEnd));
      lastBegin=values[index];
    }
    lastEnd=values[index];
  }
  ranges.add(Ranges.closed(lastBegin,lastEnd));
  return ranges;
}
