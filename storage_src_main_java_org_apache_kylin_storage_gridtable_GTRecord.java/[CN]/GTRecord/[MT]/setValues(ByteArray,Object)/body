{
  ByteBuffer buf=space.asBuffer();
  int pos=buf.position();
  for (int i=0; i < info.nColumns; i++) {
    if (values[i] == null) {
      cols[i].set(null,0,0);
      continue;
    }
    info.codeSystem.encodeColumnValue(i,values[i],buf);
    int newPos=buf.position();
    cols[i].set(buf.array(),buf.arrayOffset() + pos,newPos - pos);
    pos=newPos;
  }
  return this;
}
