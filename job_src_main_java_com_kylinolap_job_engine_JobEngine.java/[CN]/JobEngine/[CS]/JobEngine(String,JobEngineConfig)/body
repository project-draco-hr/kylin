{
  log.info("Using metadata url: " + context.getConfig());
  String ZKConnectString=getZKConnectString(context);
  if (StringUtils.isEmpty(ZKConnectString)) {
    throw new IllegalArgumentException("ZOOKEEPER_QUORUM is empty!");
  }
  this.engineID=engineID;
  this.engineConfig=context;
  this.scheduler=new QuatzScheduler();
  RetryPolicy retryPolicy=new ExponentialBackoffRetry(1000,3);
  this.zkClient=CuratorFrameworkFactory.newClient(ZKConnectString,retryPolicy);
  this.zkClient.start();
  Runtime.getRuntime().addShutdownHook(new Thread(){
    public void run(){
      log.debug("Closing HBASE connection");
      releaseLock();
    }
  }
);
}
