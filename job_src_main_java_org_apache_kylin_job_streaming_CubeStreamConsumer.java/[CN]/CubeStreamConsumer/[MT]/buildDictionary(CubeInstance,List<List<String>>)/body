{
  final List<TblColRef> columnsNeedToBuildDictionary=cubeInstance.getDescriptor().listDimensionColumnsExcludingDerived();
  final List<TblColRef> allDimensions=cubeInstance.getAllDimensions();
  final HashMap<Integer,TblColRef> tblColRefMap=Maps.newHashMap();
  for (  TblColRef column : columnsNeedToBuildDictionary) {
    final int index=allDimensions.indexOf(column);
    Preconditions.checkArgument(index >= 0);
    tblColRefMap.put(index,column);
  }
  HashMap<TblColRef,Dictionary<?>> result=Maps.newHashMap();
  HashMultimap<TblColRef,String> valueMap=HashMultimap.create();
  for (  List<String> row : recordList) {
    for (int i=0; i < row.size(); i++) {
      String cell=row.get(i);
      if (tblColRefMap.containsKey(i)) {
        valueMap.put(tblColRefMap.get(i),cell);
      }
    }
  }
  for (  TblColRef tblColRef : valueMap.keySet()) {
    final Collection<byte[]> bytes=Collections2.transform(valueMap.get(tblColRef),new Function<String,byte[]>(){
      @Nullable @Override public byte[] apply(      String input){
        return input == null ? null : input.getBytes();
      }
    }
);
    final Dictionary<?> dict=DictionaryGenerator.buildDictionaryFromValueList(tblColRef.getType(),bytes);
    result.put(tblColRef,dict);
  }
  return result;
}
