{
  Slice r=null;
  if (nRecords > 0) {
    for (int i=0; i < nColumns; i++) {
      containers[i].closeForChange();
    }
    r=new Slice(info.getDigest(),shard,sliceTimestamp,containers);
  }
  nRecords=0;
  containers=new ColumnValueContainer[nColumns];
  for (  int i : info.getDescriptor().getBitmapColumns()) {
    containers[i]=new CompressedValueContainer(info.getDigest(),i,nRecordsCap);
  }
  for (  int i : info.getDescriptor().getValueColumns()) {
    containers[i]=new CompressedValueContainer(info.getDigest(),i,nRecordsCap);
  }
  for (  int i : info.getDescriptor().getMetricsColumns()) {
    containers[i]=new CompressedValueContainer(info.getDigest(),i,nRecordsCap);
  }
  return r;
}
