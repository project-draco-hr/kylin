{
  Options options=new Options();
  try {
    options.addOption(OPTION_INPUT_PATH);
    options.addOption(OPTION_HTABLE_NAME);
    options.addOption(OPTION_CUBE_NAME);
    parseOptions(options,args);
    String tableName=getOptionValue(OPTION_HTABLE_NAME);
    String input=getOptionValue(OPTION_INPUT_PATH);
    String cubeName=getOptionValue(OPTION_CUBE_NAME);
    FileSystem fs=FileSystem.get(getConf());
    FsPermission permission=new FsPermission((short)0777);
    fs.setPermission(new Path(input,IIDesc.HBASE_FAMILY),permission);
    int hbaseExitCode=ToolRunner.run(new LoadIncrementalHFiles(getConf()),new String[]{input,tableName});
    CubeManager mgr=CubeManager.getInstance(KylinConfig.getInstanceFromEnv());
    CubeInstance cube=mgr.getCube(cubeName);
    CubeSegment seg=cube.getFirstSegment();
    seg.setStorageLocationIdentifier(tableName);
    seg.setStatus(SegmentStatusEnum.READY);
    mgr.updateCube(cube);
    return hbaseExitCode;
  }
 catch (  Exception e) {
    printUsage(options);
    e.printStackTrace(System.err);
    return 2;
  }
}
