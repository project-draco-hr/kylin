{
  Options options=new Options();
  try {
    options.addOption(OPTION_INPUT_PATH);
    options.addOption(OPTION_HTABLE_NAME);
    options.addOption(OPTION_II_NAME);
    parseOptions(options,args);
    String tableName=getOptionValue(OPTION_HTABLE_NAME);
    String input=getOptionValue(OPTION_INPUT_PATH);
    String iiname=getOptionValue(OPTION_II_NAME);
    FileSystem fs=FileSystem.get(getConf());
    FsPermission permission=new FsPermission((short)0777);
    fs.setPermission(new Path(input,IIDesc.HBASE_FAMILY),permission);
    int hbaseExitCode=ToolRunner.run(new LoadIncrementalHFiles(getConf()),new String[]{input,tableName});
    IIManager mgr=IIManager.getInstance(KylinConfig.getInstanceFromEnv());
    IIInstance ii=mgr.getII(iiname);
    IISegment seg=ii.getFirstSegment();
    seg.setStorageLocationIdentifier(tableName);
    seg.setStatus(SegmentStatusEnum.READY);
    mgr.updateII(ii);
    return hbaseExitCode;
  }
 catch (  Exception e) {
    printUsage(options);
    e.printStackTrace(System.err);
    return 2;
  }
}
