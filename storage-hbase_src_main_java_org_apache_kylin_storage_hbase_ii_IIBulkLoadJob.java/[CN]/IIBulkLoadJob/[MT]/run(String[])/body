{
  Options options=new Options();
  try {
    options.addOption(OPTION_INPUT_PATH);
    options.addOption(OPTION_HTABLE_NAME);
    options.addOption(OPTION_II_NAME);
    parseOptions(options,args);
    String tableName=getOptionValue(OPTION_HTABLE_NAME).toUpperCase();
    String input=getOptionValue(OPTION_INPUT_PATH);
    Configuration conf=HBaseConnection.getCurrentHBaseConfiguration();
    FsShell shell=new FsShell(conf);
    try {
      shell.run(new String[]{"-chmod","-R","777",input});
    }
 catch (    Exception e) {
      logger.error("Couldn't change the file permissions ",e);
      throw new IOException(e);
    }
    return ToolRunner.run(new LoadIncrementalHFiles(conf),new String[]{input,tableName});
  }
 catch (  Exception e) {
    printUsage(options);
    throw e;
  }
}
