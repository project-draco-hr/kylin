{
  Options options=new Options();
  try {
    options.addOption(OPTION_INPUT_PATH);
    options.addOption(OPTION_HTABLE_NAME);
    options.addOption(OPTION_II_NAME);
    parseOptions(options,args);
    String tableName=getOptionValue(OPTION_HTABLE_NAME).toUpperCase();
    String input=getOptionValue(OPTION_INPUT_PATH);
    Configuration conf=HBaseConnection.getCurrentHBaseConfiguration();
    FileSystem fs=FileSystem.get(conf);
    Path columnFamilyPath=new Path(input,IIDesc.HBASE_FAMILY);
    if (fs.exists(columnFamilyPath)) {
      FsPermission permission=new FsPermission((short)0777);
      fs.setPermission(columnFamilyPath,permission);
    }
    return ToolRunner.run(new LoadIncrementalHFiles(conf),new String[]{input,tableName});
  }
 catch (  Exception e) {
    printUsage(options);
    throw e;
  }
}
