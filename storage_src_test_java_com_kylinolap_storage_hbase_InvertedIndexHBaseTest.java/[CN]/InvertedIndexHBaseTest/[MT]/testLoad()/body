{
  String tableName=seg.getStorageLocationIdentifier();
  IIKeyValueCodec codec=new IIKeyValueCodec(new TableRecordInfo(seg));
  List<TimeSlice> slices=Lists.newArrayList();
  HBaseKeyValueIterator kvIterator=new HBaseKeyValueIterator(hconn,tableName,InvertedIndexDesc.HBASE_FAMILY_BYTES,InvertedIndexDesc.HBASE_QUALIFIER_BYTES);
  try {
    for (    TimeSlice slice : codec.decodeKeyValue(kvIterator)) {
      slices.add(slice);
    }
  }
  finally {
    kvIterator.close();
  }
  List<TableRecord> records=iterateRecords(slices);
  dump(records);
  System.out.println(records.size() + " records");
}
