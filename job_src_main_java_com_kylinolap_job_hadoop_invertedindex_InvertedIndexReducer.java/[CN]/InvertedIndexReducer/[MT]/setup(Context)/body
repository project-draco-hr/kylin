{
  Configuration conf=context.getConfiguration();
  KylinConfig config=AbstractHadoopJob.loadKylinPropsAndMetadata(conf);
  CubeManager mgr=CubeManager.getInstance(config);
  CubeInstance cube=mgr.getCube(conf.get(BatchConstants.CFG_CUBE_NAME));
  CubeSegment seg=cube.getSegment(conf.get(BatchConstants.CFG_CUBE_SEGMENT_NAME),CubeSegmentStatusEnum.NEW);
  info=new TableRecordInfo(seg);
  rec=new TableRecord(info);
  builder=null;
  kv=new IIKeyValueCodec(info);
}
