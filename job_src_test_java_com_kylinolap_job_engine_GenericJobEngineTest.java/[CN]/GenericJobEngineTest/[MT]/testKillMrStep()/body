{
  String uuid="a_long_running_good_job_uuid_2";
  JobInstance job=createAGoodJobInstance(uuid,1);
  jobManager.submitJob(job);
  try {
    System.out.println("wait for Running state");
    waitUntilMrStepIsRunning(uuid);
    System.out.println("Running state is reached");
    jobManager.discardJob(uuid);
  }
 catch (  RuntimeException e) {
    throw e;
  }
  System.out.println("wait for complete state");
  waitUntilJobComplete(uuid);
  System.out.println("Complete state is reached");
  JobInstance killedJob=jobManager.getJob(uuid);
  assertEquals(JobStepStatusEnum.DISCARDED,killedJob.getSteps().get(1).getStatus());
  assertEquals(JobStatusEnum.DISCARDED,killedJob.getStatus());
  CubeInstance cube=CubeManager.getInstance(KylinConfig.getInstanceFromEnv()).getCube(cubeName);
  String cubeString=JsonUtil.writeValueAsIndentString(cube);
  System.out.println(cubeString);
  assertEquals(0,cube.getSegments().size());
}
