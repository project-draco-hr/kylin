{
  SetMultimap<TblColRef,String> valueMap=HashMultimap.create();
  Set<TblColRef> dimensionColumns=Sets.newHashSet();
  for (int i=0; i < desc.listAllColumns().size(); i++) {
    if (!desc.isMetricsCol(i)) {
      dimensionColumns.add(desc.listAllColumns().get(i));
    }
  }
  for (  List<String> row : table) {
    for (int i=0; i < row.size(); i++) {
      String cell=row.get(i);
      valueMap.put(desc.listAllColumns().get(i),cell);
    }
  }
  Dictionary<?>[] result=new Dictionary<?>[desc.listAllColumns().size()];
  for (  TblColRef tblColRef : valueMap.keys()) {
    result[desc.findColumn(tblColRef)]=DictionaryGenerator.buildDictionary(tblColRef.getType(),new IterableDictionaryValueEnumerator(Collections2.transform(valueMap.get(tblColRef),new Function<String,byte[]>(){
      @Nullable @Override public byte[] apply(      String input){
        try {
          return input.getBytes("UTF-8");
        }
 catch (        UnsupportedEncodingException e) {
          throw new RuntimeException(e);
        }
      }
    }
)));
  }
  return result;
}
