{
  logger.info("Totally handled " + counter + " records!");
  queue.put(new ArrayList<String>(0));
  try {
    future.get();
  }
 catch (  Exception e) {
    logger.error("stream build failed",e);
    throw new IOException("Failed to build cube in mapper " + context.getTaskAttemptID().getTaskID().getId(),e);
  }
  queue.clear();
}
