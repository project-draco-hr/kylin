{
  Options options=new Options();
  options.addOption(OPTION_CUBE_NAME);
  options.addOption(OPTION_SEGMENT_NAME);
  options.addOption(OPTION_PARTITION_FILE_PATH);
  options.addOption(OPTION_HTABLE_NAME);
  options.addOption(OPTION_STATISTICS_ENABLED);
  parseOptions(options,args);
  Path partitionFilePath=new Path(getOptionValue(OPTION_PARTITION_FILE_PATH));
  boolean statistics_enabled=Boolean.parseBoolean(getOptionValue(OPTION_STATISTICS_ENABLED));
  String cubeName=getOptionValue(OPTION_CUBE_NAME).toUpperCase();
  kylinConfig=KylinConfig.getInstanceFromEnv();
  CubeManager cubeMgr=CubeManager.getInstance(kylinConfig);
  cube=cubeMgr.getCube(cubeName);
  cubeDesc=cube.getDescriptor();
  segmentName=getOptionValue(OPTION_SEGMENT_NAME);
  CubeSegment cubeSegment=cube.getSegment(segmentName,SegmentStatusEnum.NEW);
  String tableName=getOptionValue(OPTION_HTABLE_NAME).toUpperCase();
  Configuration conf=HBaseConnection.getCurrentHBaseConfiguration();
  try {
    byte[][] splitKeys;
    if (statistics_enabled) {
      final Map<Long,Long> cuboidSizeMap=getCubeRowCountMapFromCuboidStatistics(cubeSegment,kylinConfig,conf);
      splitKeys=getSplitsFromCuboidStatistics(cuboidSizeMap,kylinConfig,cubeSegment);
    }
 else {
      splitKeys=getSplits(conf,partitionFilePath);
    }
    CubeHTableUtil.createHTable(cubeDesc,tableName,splitKeys);
    return 0;
  }
 catch (  Exception e) {
    printUsage(options);
    e.printStackTrace(System.err);
    logger.error(e.getLocalizedMessage(),e);
    return 2;
  }
}
