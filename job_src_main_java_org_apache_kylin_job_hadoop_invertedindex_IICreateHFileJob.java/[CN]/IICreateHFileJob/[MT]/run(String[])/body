{
  Options options=new Options();
  try {
    options.addOption(OPTION_JOB_NAME);
    options.addOption(OPTION_II_NAME);
    options.addOption(OPTION_INPUT_PATH);
    options.addOption(OPTION_OUTPUT_PATH);
    options.addOption(OPTION_HTABLE_NAME);
    parseOptions(options,args);
    Path output=new Path(getOptionValue(OPTION_OUTPUT_PATH));
    job=Job.getInstance(getConf(),getOptionValue(OPTION_JOB_NAME));
    File JarFile=new File(KylinConfig.getInstanceFromEnv().getKylinJobJarPath());
    if (JarFile.exists()) {
      job.setJar(KylinConfig.getInstanceFromEnv().getKylinJobJarPath());
    }
 else {
      job.setJarByClass(this.getClass());
    }
    addInputDirs(getOptionValue(OPTION_INPUT_PATH),job);
    FileOutputFormat.setOutputPath(job,output);
    job.setInputFormatClass(SequenceFileInputFormat.class);
    job.setMapperClass(IICreateHFileMapper.class);
    job.setMapOutputKeyClass(ImmutableBytesWritable.class);
    job.setMapOutputValueClass(KeyValue.class);
    String tableName=getOptionValue(OPTION_HTABLE_NAME);
    HTable htable=new HTable(HBaseConfiguration.create(getConf()),tableName);
    HFileOutputFormat.configureIncrementalLoad(job,htable);
    this.deletePath(job.getConfiguration(),output);
    return waitForCompletion(job);
  }
 catch (  Exception e) {
    printUsage(options);
    throw e;
  }
}
