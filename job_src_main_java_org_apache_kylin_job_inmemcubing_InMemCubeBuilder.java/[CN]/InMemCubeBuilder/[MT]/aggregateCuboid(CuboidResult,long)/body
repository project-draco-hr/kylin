{
  Pair<BitSet,BitSet> columnBitSets=getDimensionAndMetricColumnBitSet(parent.cuboidId);
  BitSet parentDimensions=columnBitSets.getFirst();
  BitSet measureColumns=columnBitSets.getSecond();
  BitSet childDimensions=(BitSet)parentDimensions.clone();
  long mask=Long.highestOneBit(parent.cuboidId);
  long childCuboidId=cuboidId;
  long parentCuboidIdActualLength=Long.SIZE - Long.numberOfLeadingZeros(parent.cuboidId);
  int index=0;
  for (int i=0; i < parentCuboidIdActualLength; i++) {
    if ((mask & parent.cuboidId) > 0) {
      if ((mask & childCuboidId) == 0) {
        childDimensions.set(index,false);
      }
      index++;
    }
    mask=mask >> 1;
  }
  return scanAndAggregateGridTable(parent.table,cuboidId,childDimensions,measureColumns);
}
