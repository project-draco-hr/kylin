{
  for (int i=0; i < totalSum.length; i++) {
    if (totalSum[i] instanceof DoubleMutable) {
      totalSum[i]=Math.round(((DoubleMutable)totalSum[i]).get());
    }
  }
  if (totalSumForSanityCheck == null) {
    totalSumForSanityCheck=totalSum;
    return;
  }
  if (Arrays.equals(totalSumForSanityCheck,totalSum) == false) {
    throw new IllegalStateException();
  }
}
