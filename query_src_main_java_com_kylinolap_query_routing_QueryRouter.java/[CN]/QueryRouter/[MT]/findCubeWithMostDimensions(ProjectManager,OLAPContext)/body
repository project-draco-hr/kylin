{
  List<CubeInstance> candidates=filterCubes(projectManager.getOnlineRealizationByFactTable(olapContext.olapSchema.getProjectName(),olapContext.firstTableScan.getCubeTable()));
  if (candidates.isEmpty()) {
    return null;
  }
  CubeInstance cubeWithMostColumns=candidates.get(0);
  for (  CubeInstance instance : candidates) {
    int currentDimCount=instance.getDescriptor().listDimensionColumnsIncludingDerived().size();
    int maxDimCount=cubeWithMostColumns.getDescriptor().listDimensionColumnsIncludingDerived().size();
    if ((currentDimCount > maxDimCount) || ((currentDimCount == maxDimCount) && (instance.getCost() < cubeWithMostColumns.getCost())))     cubeWithMostColumns=instance;
  }
  return cubeWithMostColumns;
}
