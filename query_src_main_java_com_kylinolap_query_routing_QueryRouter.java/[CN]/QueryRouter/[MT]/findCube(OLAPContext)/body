{
  CubeInstance bestCube=null;
  CubeRealizationManager cubeRealizationManager=CubeRealizationManager.getInstance(olapContext.olapSchema.getConfig());
  if (olapContext.isSimpleQuery()) {
    bestCube=findCubeWithMostDimensions(cubeRealizationManager,olapContext);
  }
  if (bestCube == null) {
    bestCube=findBestMatchCube(cubeRealizationManager,olapContext);
  }
  if (bestCube == null) {
    throw new CubeNotFoundException("Can't find cube for fact table " + olapContext.firstTableScan.getCubeTable() + " in project "+ olapContext.olapSchema.getProjectName()+ " with dimensions "+ getDimensionColumns(olapContext)+ " and measures "+ olapContext.aggregations+ ". Also please check whether join types match what defined in Cube.");
  }
  return bestCube;
}
