{
  CubeInstance bestCube=null;
  ProjectManager projectManager=ProjectManager.getInstance(olapContext.olapSchema.getConfig());
  if (olapContext.isSimpleQuery()) {
    bestCube=findCubeWithMostDimensions(projectManager,olapContext);
  }
  if (bestCube == null) {
    bestCube=findBestMatchCube(projectManager,olapContext);
  }
  if (bestCube == null) {
    throw new NoRealizationFoundException("Can't find any realization for fact table " + olapContext.firstTableScan.getCubeTable() + " in project "+ olapContext.olapSchema.getProjectName()+ " with dimensions "+ getDimensionColumns(olapContext)+ " and measures "+ olapContext.aggregations+ ". Also please check whether join types match what defined in realization.");
  }
  return bestCube;
}
