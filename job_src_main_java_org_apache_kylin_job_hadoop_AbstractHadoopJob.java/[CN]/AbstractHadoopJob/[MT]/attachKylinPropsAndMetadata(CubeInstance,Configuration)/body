{
  File tmp=File.createTempFile("kylin_job_meta","");
  FileUtils.forceDelete(tmp);
  File metaDir=new File(tmp,"meta");
  metaDir.mkdirs();
  KylinConfig kylinConfig=KylinConfig.getInstanceFromEnv();
  File kylinPropsFile=new File(metaDir,"kylin.properties");
  kylinConfig.writeProperties(kylinPropsFile);
  ArrayList<String> dumpList=new ArrayList<String>();
  dumpList.add(cube.getResourcePath());
  dumpList.add(cube.getDescriptor().getModel().getResourcePath());
  dumpList.add(cube.getDescriptor().getResourcePath());
  for (  String tableName : cube.getDescriptor().getModel().getAllTables()) {
    TableDesc table=MetadataManager.getInstance(kylinConfig).getTableDesc(tableName);
    dumpList.add(table.getResourcePath());
  }
  for (  CubeSegment segment : cube.getSegments()) {
    dumpList.addAll(segment.getDictionaryPaths());
  }
  dumpResources(kylinConfig,metaDir,dumpList);
  String hdfsMetaDir="file://" + OptionsHelper.convertToFileURL(metaDir.getAbsolutePath());
  logger.info("HDFS meta dir is: " + hdfsMetaDir);
  conf.set("tmpfiles",hdfsMetaDir);
}
