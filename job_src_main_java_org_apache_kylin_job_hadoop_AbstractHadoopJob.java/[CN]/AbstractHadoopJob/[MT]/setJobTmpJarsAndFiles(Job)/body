{
  String mrLibDir=KylinConfig.getInstanceFromEnv().getKylinJobMRLibDir();
  if (StringUtils.isBlank(mrLibDir))   return;
  try {
    Configuration jobConf=job.getConfiguration();
    FileSystem fs=FileSystem.get(new Configuration(jobConf));
    FileStatus[] fList=fs.listStatus(new Path(mrLibDir));
    StringBuilder jarList=new StringBuilder();
    StringBuilder fileList=new StringBuilder();
    for (    FileStatus file : fList) {
      Path p=file.getPath();
      StringBuilder list=(p.getName().endsWith(".jar")) ? jarList : fileList;
      if (list.length() > 0)       list.append(",");
      list.append(mrLibDir + "/" + file.getPath().getName());
    }
    appendTmpFiles(fileList.toString(),jobConf);
    appendTmpJars(jarList.toString(),jobConf);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
