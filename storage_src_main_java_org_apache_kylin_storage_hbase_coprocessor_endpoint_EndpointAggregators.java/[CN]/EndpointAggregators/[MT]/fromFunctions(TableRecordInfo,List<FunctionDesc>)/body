{
  final int metricSize=metrics.size();
  String[] funcNames=new String[metricSize];
  String[] dataTypes=new String[metricSize];
  MetricInfo[] metricInfos=new MetricInfo[metricSize];
  for (int i=0; i < metricSize; i++) {
    FunctionDesc functionDesc=metrics.get(i);
    funcNames[i]=functionDesc.getExpression();
    dataTypes[i]=functionDesc.getReturnType();
    int index=tableInfo.findFactTableColumn(functionDesc.getParameter().getValue());
    metricInfos[i]=generateMetricInfo(index,functionDesc);
  }
  return new EndpointAggregators(funcNames,dataTypes,metricInfos,tableInfo.getDigest());
}
