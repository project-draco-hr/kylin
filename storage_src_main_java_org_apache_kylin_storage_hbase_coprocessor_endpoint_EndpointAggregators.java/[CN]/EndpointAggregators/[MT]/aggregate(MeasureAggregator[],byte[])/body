{
  rawTableRecord.setBytes(row,0,row.length);
  for (int metricIndex=0; metricIndex < metricInfos.length; ++metricIndex) {
    final MetricInfo metricInfo=metricInfos[metricIndex];
    if (metricInfo.type == MetricType.Count) {
      measureAggrs[metricIndex].aggregate(ONE);
      continue;
    }
    if (metricInfo.type == MetricType.DimensionAsMetric) {
      continue;
    }
    MeasureAggregator aggregator=measureAggrs[metricIndex];
    FixedLenMeasureCodec measureSerializer=measureSerializers[metricIndex];
    rawTableRecord.getValueBytes(metricInfo.refIndex,byteBuffer);
    if (metricInfo.type == MetricType.Normal) {
      aggregator.aggregate(measureSerializer.read(byteBuffer.get(),byteBuffer.getOffset()));
    }
 else     if (metricInfo.type == MetricType.DistinctCount) {
      HyperLogLogPlusCounter hllc=hllcs[metricIndex];
      if (hllc == null) {
        int precision=metricInfo.precision;
        hllc=new HyperLogLogPlusCounter(precision);
      }
      hllc.clear();
      hllc.add(byteBuffer.get(),byteBuffer.getOffset(),byteBuffer.getLength());
      aggregator.aggregate(hllc);
    }
  }
}
