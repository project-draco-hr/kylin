{
  CubeSegment segment=cubeManager.appendSegment(cubeManager.getCube(cubeName),0,endDate,0,0);
  DefaultChainedExecutable job=EngineFactory.createBatchCubingJob(segment,"TEST");
  jobService.addJob(job);
  waitForJob(job.getId());
  if (segment.getCubeDesc().getEngineType() == IEngineAware.ID_MR_V1 || segment.getCubeDesc().getStorageType() == IStorageAware.ID_SHARDED_HBASE) {
    checkHFilesInHBase(segment);
  }
  return job.getId();
}
