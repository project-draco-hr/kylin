{
  final TblColRef[] columns=coprocessorRowType.columns;
  final int columnSize=columns.length;
  final boolean[] isMetric=digest.isMetrics();
  final boolean emptyDictionary=Array.isEmpty(localDictionaries);
  for (int i=0; i < columnSize; i++) {
    final TblColRef column=columns[i];
    if (isMetric[i]) {
      rowKeyColumnIO.writeColumnWith(encodedRecord.getBytes(),encodedRecord.offset(i),encodedRecord.length(i),recordBuffer,digest.offset(i),rowKeyColumnIO.getColumnLength(column));
    }
 else {
      if (emptyDictionary) {
        rowKeyColumnIO.writeColumnWith(encodedRecord.getBytes(),encodedRecord.offset(i),encodedRecord.length(i),recordBuffer,digest.offset(i),rowKeyColumnIO.getColumnLength(column));
      }
 else {
        final int length=localDictionaries[i].getValueBytesFromId(encodedRecord.getValueID(i),buffer,0);
        rowKeyColumnIO.writeColumnWith(buffer,0,length,recordBuffer,digest.offset(i),rowKeyColumnIO.getColumnLength(column));
      }
    }
  }
}
