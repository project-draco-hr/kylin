{
  super(kylinConfig);
  String metadataUrl=kylinConfig.getMetadataUrl();
  int cut=metadataUrl.indexOf('@');
  tableNameBase=cut < 0 ? DEFAULT_TABLE_NAME : metadataUrl.substring(0,cut);
  hbaseUrl=cut < 0 ? metadataUrl : metadataUrl.substring(cut + 1);
  if (!(StringUtils.isEmpty(hbaseUrl) || "hbase".equals(hbaseUrl)))   throw new IllegalArgumentException("to use hbase storage, pls set 'kylin.metadata.url=kylin_metadata@hbase' in kylin.properties");
  createHTableIfNeeded(getAllInOneTableName());
}
