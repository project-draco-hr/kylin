{
  SplitThread last=null;
  boolean eof=false;
  while (!eof) {
    if (last != null && shouldCutSplit()) {
      cutSplit(last);
      last=null;
    }
    checkException(splits);
    if (last == null) {
      last=new SplitThread(merger);
      splits.add(last);
      last.start();
    }
    eof=feedSomeInput(input,last,unitRows);
  }
  merger.mergeAndOutput(splits,output);
  checkException(splits);
}
