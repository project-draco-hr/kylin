{
  try {
    CubeSegment cubeSegment=(CubeSegment)buildable;
    KylinConfig kylinConfig=KylinConfig.getInstanceFromEnv();
    final Configuration conf=HadoopUtil.getCurrentConfiguration();
    final Path outputPath=new Path("file:///tmp/cuboidstatistics/" + UUID.randomUUID().toString());
    FileSystem.getLocal(conf).deleteOnExit(outputPath);
    FactDistinctColumnsReducer.writeCuboidStatistics(conf,outputPath,samplingResult,100);
    FSDataInputStream inputStream=null;
    try {
      inputStream=FileSystem.getLocal(conf).open(new Path(outputPath,BatchConstants.CFG_STATISTICS_CUBOID_ESTIMATION));
      ResourceStore.getStore(kylinConfig).putResource(cubeSegment.getStatisticsResourcePath(),inputStream,0);
    }
  finally {
      IOUtils.closeQuietly(inputStream);
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("failed to write sampling result",e);
  }
}
