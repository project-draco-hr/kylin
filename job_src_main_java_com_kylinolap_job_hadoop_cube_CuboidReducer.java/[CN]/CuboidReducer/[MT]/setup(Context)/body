{
  cubeName=context.getConfiguration().get(BatchConstants.CFG_CUBE_NAME).toUpperCase();
  KylinConfig config=AbstractHadoopJob.loadKylinPropsAndMetadata(context.getConfiguration());
  cubeDesc=CubeManager.getInstance(config).getCube(cubeName).getDescriptor();
  measuresDescs=cubeDesc.getMeasures();
  codec=new MeasureCodec(measuresDescs);
  aggs=new MeasureAggregators(measuresDescs);
  input=new Object[measuresDescs.size()];
  result=new Object[measuresDescs.size()];
}
