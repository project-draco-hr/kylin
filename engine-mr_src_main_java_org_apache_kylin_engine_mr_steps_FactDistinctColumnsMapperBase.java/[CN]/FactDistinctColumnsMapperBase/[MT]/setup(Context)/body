{
  Configuration conf=context.getConfiguration();
  bindCurrentConfiguration(conf);
  KylinConfig config=AbstractHadoopJob.loadKylinPropsAndMetadata();
  cubeName=conf.get(BatchConstants.CFG_CUBE_NAME);
  cube=CubeManager.getInstance(config).getCube(cubeName);
  cubeSeg=cube.getSegment(conf.get(BatchConstants.CFG_CUBE_SEGMENT_NAME),SegmentStatusEnum.NEW);
  cubeDesc=cube.getDescriptor();
  baseCuboidId=Cuboid.getBaseCuboidId(cubeDesc);
  factDictCols=CubeManager.getInstance(config).getAllDictColumnsOnFact(cubeDesc);
  flatTableInputFormat=MRUtil.getBatchCubingInputSide(cubeSeg).getFlatTableInputFormat();
  intermediateTableDesc=new CubeJoinedFlatTableDesc(cubeDesc,null);
  dictionaryColumnIndex=new int[factDictCols.size()];
  for (int i=0; i < factDictCols.size(); i++) {
    TblColRef colRef=factDictCols.get(i);
    int columnIndexOnFlatTbl=intermediateTableDesc.getColumnIndex(colRef);
    dictionaryColumnIndex[i]=columnIndexOnFlatTbl;
  }
}
