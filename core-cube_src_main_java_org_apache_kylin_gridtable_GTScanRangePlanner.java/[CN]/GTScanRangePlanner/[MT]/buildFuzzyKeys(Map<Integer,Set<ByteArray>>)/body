{
  ArrayList<FuzzyKeyGTRecord> result=Lists.newArrayList();
  if (fuzzyValueSet.isEmpty())   return result;
  if (BackdoorToggles.getDisableFuzzyKey()) {
    logger.info("The execution of this query will not use fuzzy key");
    return result;
  }
  List<Map<Integer,ByteArray>> fuzzyValueCombinations=FuzzyValueCombination.calculate(fuzzyValueSet,maxFuzzyKeys);
  for (  Map<Integer,ByteArray> fuzzyValue : fuzzyValueCombinations) {
    BitSet bitSet=new BitSet(gtInfo.getColumnCount());
    for (    Map.Entry<Integer,ByteArray> entry : fuzzyValue.entrySet()) {
      bitSet.set(entry.getKey());
    }
    FuzzyKeyGTRecord fuzzy=new FuzzyKeyGTRecord(gtInfo,new ImmutableBitSet(bitSet));
    for (    Map.Entry<Integer,ByteArray> entry : fuzzyValue.entrySet()) {
      fuzzy.set(entry.getKey(),entry.getValue());
    }
    result.add(fuzzy);
  }
  return result;
}
