{
  GTRecord pkStart=new GTRecord(info);
  GTRecord pkEnd=new GTRecord(info);
  Map<Integer,Set<ByteArray>> fuzzyValues=Maps.newHashMap();
  List<GTRecord> fuzzyKeys;
  for (  ColumnRange range : andDimRanges) {
    if (partitionColRef != null && range.column.equals(partitionColRef)) {
      if (rangeStartEndComparator.comparator.compare(segmentStartAndEnd.getFirst(),range.end) <= 0 && rangeStartEndComparator.comparator.compare(range.begin,segmentStartAndEnd.getSecond()) <= 0) {
      }
 else {
        logger.debug("Pre-check partition col filter failed, partitionColRef {}, segment start {}, segment end {}, range begin {}, range end {}",new Object[]{partitionColRef,makeReadable(segmentStartAndEnd.getFirst()),makeReadable(segmentStartAndEnd.getSecond()),makeReadable(range.begin),makeReadable(range.end)});
        return null;
      }
    }
    int col=range.column.getColumnDesc().getZeroBasedIndex();
    if (!info.primaryKey.get(col))     continue;
    pkStart.set(col,range.begin);
    pkEnd.set(col,range.end);
    if (range.valueSet != null && !range.valueSet.isEmpty()) {
      fuzzyValues.put(col,range.valueSet);
    }
  }
  fuzzyKeys=buildFuzzyKeys(fuzzyValues);
  return new GTScanRange(pkStart,pkEnd,fuzzyKeys);
}
