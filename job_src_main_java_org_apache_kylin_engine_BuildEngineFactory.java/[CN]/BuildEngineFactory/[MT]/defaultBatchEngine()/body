{
  if (defaultBatchEngine == null) {
    KylinConfig conf=KylinConfig.getInstanceFromEnv();
    if (conf.isCubingInMem()) {
      defaultBatchEngine=new MRBatchCubingEngine2();
    }
 else {
      defaultBatchEngine=new MRBatchCubingEngine();
    }
  }
  return defaultBatchEngine;
}
