{
  this.createTestMetadata();
  this.ii=IIManager.getInstance(getTestConfig()).getII(iiName);
  this.iiDesc=ii.getDescriptor();
  List<StreamMessage> streamMessages=Lists.transform(Arrays.asList(inputData),new Function<String,StreamMessage>(){
    @Nullable @Override public StreamMessage apply(    String input){
      return new StreamMessage(System.currentTimeMillis(),input.getBytes());
    }
  }
);
  List<List<String>> parsedStreamMessages=Lists.newArrayList();
  StreamParser parser=StringStreamParser.instance;
  MicroStreamBatch batch=new MicroStreamBatch();
  for (  StreamMessage message : streamMessages) {
    ParsedStreamMessage parsedStreamMessage=parser.parse(message);
    if ((parsedStreamMessage.isAccepted())) {
      batch.add(parsedStreamMessage);
    }
  }
  iiRows=Lists.newArrayList();
  final Slice slice=new SliceBuilder(iiDesc,(short)0,true).buildSlice((batch));
  IIKeyValueCodec codec=new IIKeyValueCodec(slice.getInfo());
  for (  IIRow iiRow : codec.encodeKeyValue(slice)) {
    iiRows.add(iiRow);
  }
}
