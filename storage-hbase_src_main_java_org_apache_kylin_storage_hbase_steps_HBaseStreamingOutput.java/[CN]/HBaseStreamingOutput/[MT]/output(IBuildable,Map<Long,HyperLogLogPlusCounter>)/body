{
  try {
    CubeSegment cubeSegment=(CubeSegment)buildable;
    KylinConfig kylinConfig=KylinConfig.getInstanceFromEnv();
    final Configuration conf=HadoopUtil.getCurrentConfiguration();
    final Path outputPath=new Path("file://" + BatchConstants.CFG_STATISTICS_LOCAL_DIR + UUID.randomUUID().toString());
    CuboidStatsUtil.writeCuboidStatistics(conf,outputPath,samplingResult,100);
    FSDataInputStream inputStream=null;
    try {
      inputStream=FileSystem.getLocal(conf).open(new Path(outputPath,BatchConstants.CFG_STATISTICS_CUBOID_ESTIMATION));
      ResourceStore.getStore(kylinConfig).putResource(cubeSegment.getStatisticsResourcePath(),inputStream,System.currentTimeMillis());
    }
  finally {
      IOUtils.closeQuietly(inputStream);
      FileSystem.getLocal(conf).delete(outputPath,true);
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("failed to write sampling result",e);
  }
}
