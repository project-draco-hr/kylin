{
  Configuration conf=ConfigCache.get(url);
  if (conf == null) {
    conf=HadoopUtil.newHBaseConfiguration(url);
    ConfigCache.put(url,conf);
  }
  HConnection connection=ConnPool.get(url);
  try {
    if (connection == null) {
      connection=HConnectionManager.createConnection(conf);
      ConnPool.put(url,connection);
    }
  }
 catch (  Throwable t) {
    throw new StorageException("Error when open connection " + url,t);
  }
  return connection;
}
