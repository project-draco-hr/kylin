{
  HBaseAdmin hbase=new HBaseAdmin(conn);
  try {
    boolean tableExist=false;
    try {
      hbase.getTableDescriptor(TableName.valueOf(tableName));
      tableExist=true;
    }
 catch (    TableNotFoundException e) {
    }
    if (tableExist) {
      logger.debug("HTable '" + tableName + "' already exists");
      return;
    }
    logger.debug("Creating HTable '" + tableName + "'");
    HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(tableName));
    if (null != families && families.length > 0) {
      for (      String family : families) {
        desc.addFamily(new HColumnDescriptor(family));
      }
    }
    hbase.createTable(desc);
    logger.debug("HTable '" + tableName + "' created");
  }
  finally {
    hbase.close();
  }
}
