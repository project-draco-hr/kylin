{
  MapReduceExecutable result=new MapReduceExecutable();
  result.setName(ExecutableConstants.STEP_NAME_FACT_DISTINCT_COLUMNS);
  result.setMapReduceJobClass(FactDistinctColumnsJob.class);
  StringBuilder cmd=new StringBuilder();
  appendMapReduceParameters(cmd,seg);
  appendExecCmdParameters(cmd,"cubename",seg.getCubeInstance().getName());
  appendExecCmdParameters(cmd,"output",getFactDistinctColumnsPath(seg,jobId));
  appendExecCmdParameters(cmd,"segmentname",seg.getName());
  appendExecCmdParameters(cmd,"statisticsenabled",String.valueOf(inMemoryCubing()));
  appendExecCmdParameters(cmd,"statisticsoutput",getStatisticsPath(seg,jobId));
  appendExecCmdParameters(cmd,"statisticssamplingmax",String.valueOf(engineConfig.getConfig().getCubingInMemSamplingMax()));
  appendExecCmdParameters(cmd,"jobname","Kylin_Fact_Distinct_Columns_" + seg.getCubeInstance().getName() + "_Step");
  appendExecCmdParameters(cmd,"tablename",intermediateHiveTableName);
  result.setMapReduceParams(cmd.toString());
  return result;
}
