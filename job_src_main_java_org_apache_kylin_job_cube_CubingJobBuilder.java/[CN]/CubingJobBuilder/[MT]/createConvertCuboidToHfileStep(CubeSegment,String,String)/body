{
  MapReduceExecutable createHFilesStep=new MapReduceExecutable();
  createHFilesStep.setName(ExecutableConstants.STEP_NAME_CONVERT_CUBOID_TO_HFILE);
  StringBuilder cmd=new StringBuilder();
  appendMapReduceParameters(cmd,seg);
  appendExecCmdParameters(cmd,"cubename",seg.getCubeInstance().getName());
  appendExecCmdParameters(cmd,"input",inputPath);
  appendExecCmdParameters(cmd,"output",getHFilePath(seg,jobId));
  appendExecCmdParameters(cmd,"htablename",seg.getStorageLocationIdentifier());
  appendExecCmdParameters(cmd,"jobname","Kylin_HFile_Generator_" + seg.getCubeInstance().getName() + "_Step");
  createHFilesStep.setMapReduceParams(cmd.toString());
  createHFilesStep.setMapReduceJobClass(CubeHFileJob.class);
  return createHFilesStep;
}
