{
  List<BlockingQueue<StreamingMessage>> result=Lists.newArrayList();
  for (int partitionId=0; partitionId < partitionCount; ++partitionId) {
    final kafka.cluster.Broker leadBroker=KafkaUtils.getLeadBroker(kafkaClusterConfig,partitionId);
    long streamingOffset=KafkaRequester.getLastOffset(kafkaClusterConfig.getTopic(),partitionId,whichtime,leadBroker,kafkaClusterConfig);
    logger.info("starting offset:" + streamingOffset + " cluster id:"+ clusterID+ " partitionId:"+ partitionId);
    KafkaMessagePuller consumer=new KafkaMessagePuller(clusterID,kafkaClusterConfig.getTopic(),partitionId,streamingOffset,leadBroker,kafkaClusterConfig,parser);
    Executors.newSingleThreadExecutor(new DaemonThreadFactory()).submit(consumer);
    result.add(consumer.getStreamQueue());
  }
  return result;
}
