{
  String streaming=optionsHelper.getOptionValue(OPTION_STREAMING);
  String task=optionsHelper.getOptionValue(OPTION_TASK);
  String tsColName=optionsHelper.getOptionValue(OPTION_TSCOLNAME);
  Map<String,String> properties=Maps.newHashMap();
  properties.put(StreamingParser.PROPERTY_TS_COLUMN_NAME,tsColName);
  kafkaConfig=KafkaConfigManager.getInstance(KylinConfig.getInstanceFromEnv()).getKafkaConfig(streaming);
  parser=new TimedJsonStreamParser(Lists.<TblColRef>newArrayList(),properties);
  if ("disorder".equalsIgnoreCase(task)) {
    analyzeDisorder();
  }
 else   if ("delay".equalsIgnoreCase(task)) {
    analyzeLatency();
  }
 else {
    optionsHelper.printUsage(this.getClass().getName(),options);
  }
}
