{
  List<Integer> newArgList=new ArrayList<Integer>(1);
  String fieldName=func.getRewriteFieldName();
  RelDataTypeField field=getInput().getRowType().getField(fieldName,true,false);
  newArgList.add(field.getIndex());
  RelDataType fieldType=aggCall.getType();
  SqlAggFunction newAgg=aggCall.getAggregation();
  if (func.isCountDistinct()) {
    newAgg=createHyperLogLogAggFunction(fieldType);
  }
 else   if (func.isCount()) {
    newAgg=SqlStdOperatorTable.SUM0;
  }
  AggregateCall newAggCall=new AggregateCall(newAgg,false,newArgList,fieldType,newAgg.getName());
  return newAggCall;
}
