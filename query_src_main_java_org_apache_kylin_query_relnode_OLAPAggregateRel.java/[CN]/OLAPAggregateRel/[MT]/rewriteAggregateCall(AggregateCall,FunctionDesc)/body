{
  List<Integer> newArgList=Lists.newArrayListWithCapacity(1);
  if (func.needRewriteField()) {
    RelDataTypeField field=getInput().getRowType().getField(func.getRewriteFieldName(),true,false);
    newArgList.add(field.getIndex());
  }
 else {
    newArgList=aggCall.getArgList();
  }
  RelDataType fieldType=aggCall.getType();
  SqlAggFunction newAgg=aggCall.getAggregation();
  if (func.isCount()) {
    newAgg=SqlStdOperatorTable.SUM0;
  }
 else   if (func.getMeasureType().getRewriteCalciteAggrFunctionClass() != null) {
    newAgg=createCustomAggFunction(func.getExpression(),fieldType,func.getMeasureType().getRewriteCalciteAggrFunctionClass());
  }
  AggregateCall newAggCall=new AggregateCall(newAgg,false,newArgList,fieldType,newAgg.getName());
  return newAggCall;
}
