{
  try {
    JobDataMap jobDataMap=context.getJobDetail().getJobDataMap();
    JobFlow jobFlow=(JobFlow)jobDataMap.get(JobConstants.PROP_JOB_FLOW);
    JobDetail nextJob=(JobDetail)jobFlow.getNext(context.getJobDetail());
    if (nextJob != null) {
      try {
        Trigger trigger=TriggerBuilder.newTrigger().startNow().build();
        log.debug("Job " + context.getJobDetail().getKey() + " will now chain to Job "+ nextJob.getKey()+ "");
        context.getScheduler().scheduleJob(nextJob,trigger);
      }
 catch (      SchedulerException se) {
        log.error("Error encountered during chaining to Job " + nextJob.getKey() + "",se);
      }
    }
    context.getScheduler().deleteJob(context.getJobDetail().getKey());
  }
 catch (  SchedulerException e) {
    log.error(e.getLocalizedMessage(),e);
    throw new RuntimeException(e);
  }
}
