{
  keyColIndex=tableDesc.findColumnByName(keyCol).getZeroBasedIndex();
  table=new String[dict.getMaxId() - dict.getMinId() + 1][];
  if (table.length > MAX_CARDINALITY)   throw new IllegalStateException("Too high cardinality of table " + tableDesc + " as an in-mem lookup: "+ table.length);
  TableReader reader=new FileTable(tablePath,tableDesc.getColumnCount()).getReader();
  try {
    while (reader.next()) {
      String[] cols=reader.getRow();
      String key=cols[keyColIndex];
      int rowNo=getRowNoByValue(key);
      if (table[rowNo] != null)       throw new IllegalStateException("Dup key found, key=" + key + ", value1="+ toString(table[rowNo])+ ", value2="+ toString(cols));
      table[rowNo]=cols;
    }
  }
  finally {
    reader.close();
  }
}
