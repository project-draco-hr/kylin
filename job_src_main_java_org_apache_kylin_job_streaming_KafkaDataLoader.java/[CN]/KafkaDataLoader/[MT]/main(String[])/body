{
  StreamingManager streamingManager=StreamingManager.getInstance(KylinConfig.getInstanceFromEnv());
  KafkaConfig kafkaConfig=streamingManager.getKafkaConfig(args[1]);
  List<String> alldata=FileUtils.readLines(new File(args[0]));
  Properties props=new Properties();
  props.put("metadata.broker.list","sandbox:6667");
  props.put("serializer.class","kafka.serializer.StringEncoder");
  props.put("request.required.acks","1");
  ProducerConfig config=new ProducerConfig(props);
  Producer<String,String> producer=new Producer<String,String>(config);
  for (int i=0; i < alldata.size(); ++i) {
    KeyedMessage<String,String> data=new KeyedMessage<String,String>(kafkaConfig.getTopic(),String.valueOf(i),alldata.get(i));
    producer.send(data);
  }
  producer.close();
}
