{
  CubeManager mgr=mgr();
  CubeInstance cube=mgr.getCube("test_kylin_cube_without_slr_ready");
  assertEquals(1,cube.getSegments().size());
  CubeSegment seg=cube.getSegment(SegmentStatusEnum.READY).get(0);
  assertEquals(SegmentStatusEnum.READY,seg.getStatus());
  CubeSegment seg2=mgr.appendSegments(cube,0);
  assertEquals(0,seg2.getDateRangeStart());
  assertEquals(Long.MAX_VALUE,seg2.getDateRangeEnd());
  assertEquals(2,cube.getSegments().size());
  mgr.mergeSegments(cube,0,Long.MAX_VALUE);
}
