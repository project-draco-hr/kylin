{
  topNLiteralColDictMap=Maps.newHashMap();
  for (int measureIdx=0; measureIdx < measures.length; measureIdx++) {
    MeasureDesc measureDesc=cubeDesc.getMeasures().get(measureIdx);
    FunctionDesc func=measureDesc.getFunction();
    if (func.isTopN()) {
      int[] flatTableIdx=intermediateTableDesc.getMeasureColumnIndexes()[measureIdx];
      int literalColIdx=flatTableIdx[flatTableIdx.length - 1];
      TblColRef literalCol=func.getTopNLiteralColumn();
      Dictionary<String> dictionary=(Dictionary<String>)cubeSegment.getDictionary(literalCol);
      topNLiteralColDictMap.put(literalColIdx,dictionary);
    }
  }
}
