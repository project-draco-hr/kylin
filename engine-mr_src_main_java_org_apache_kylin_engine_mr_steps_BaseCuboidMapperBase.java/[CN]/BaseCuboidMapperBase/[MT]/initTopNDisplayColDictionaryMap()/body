{
  topNDisplayColDictMap=Maps.newHashMap();
  for (int measureIdx=0; measureIdx < measures.length; measureIdx++) {
    MeasureDesc measureDesc=cubeDesc.getMeasures().get(measureIdx);
    FunctionDesc func=measureDesc.getFunction();
    if (func.isTopN()) {
      int[] flatTableIdx=intermediateTableDesc.getMeasureColumnIndexes()[measureIdx];
      int displayColIdx=flatTableIdx[flatTableIdx.length - 1];
      TblColRef displayCol=func.getParameter().getColRefs().get(flatTableIdx.length - 1);
      Dictionary<String> dictionary=(Dictionary<String>)cubeSegment.getDictionary(displayCol);
      topNDisplayColDictMap.put(displayColIdx,dictionary);
    }
  }
}
