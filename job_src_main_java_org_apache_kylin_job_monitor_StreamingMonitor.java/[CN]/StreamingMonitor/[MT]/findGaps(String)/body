{
  List<CubeSegment> segments=getSortedReadySegments(cubeName);
  List<Pair<Long,Long>> gaps=Lists.newArrayList();
  for (int i=0; i < segments.size() - 1; ++i) {
    CubeSegment first=segments.get(i);
    CubeSegment second=segments.get(i + 1);
    if (first.getDateRangeEnd() == second.getDateRangeStart()) {
      continue;
    }
 else     if (first.getDateRangeEnd() < second.getDateRangeStart()) {
      gaps.add(Pair.newPair(first.getDateRangeEnd(),second.getDateRangeStart()));
    }
  }
  return gaps;
}
