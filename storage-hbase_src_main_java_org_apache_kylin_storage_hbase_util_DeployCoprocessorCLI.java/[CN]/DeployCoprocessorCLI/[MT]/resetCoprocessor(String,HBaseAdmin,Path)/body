{
  logger.info("Disable " + tableName);
  hbaseAdmin.disableTable(tableName);
  logger.info("Unset coprocessor on " + tableName);
  HTableDescriptor desc=hbaseAdmin.getTableDescriptor(TableName.valueOf(tableName));
  while (desc.hasCoprocessor(CubeObserverClass)) {
    desc.removeCoprocessor(CubeObserverClass);
  }
  while (desc.hasCoprocessor(CubeEndpointClass)) {
    desc.removeCoprocessor(CubeEndpointClass);
  }
  while (desc.hasCoprocessor(IIEndpointClass)) {
    desc.removeCoprocessor(IIEndpointClass);
  }
  while (desc.hasCoprocessor(CubeObserverClassOld)) {
    desc.removeCoprocessor(CubeObserverClassOld);
  }
  while (desc.hasCoprocessor(IIEndpointClassOld)) {
    desc.removeCoprocessor(IIEndpointClassOld);
  }
  addCoprocessorOnHTable(desc,hdfsCoprocessorJar);
  hbaseAdmin.modifyTable(tableName,desc);
  logger.info("Enable " + tableName);
  hbaseAdmin.enableTable(tableName);
}
