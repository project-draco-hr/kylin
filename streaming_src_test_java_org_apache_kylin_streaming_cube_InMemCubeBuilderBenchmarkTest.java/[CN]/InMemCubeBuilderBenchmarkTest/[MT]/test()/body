{
  final KylinConfig kylinConfig=KylinConfig.getInstanceFromEnv();
  final CubeManager cubeManager=CubeManager.getInstance(kylinConfig);
  final CubeInstance cube=cubeManager.getCube(CUBE_NAME);
  final CubeSegment cubeSegment=cube.getFirstSegment();
  LinkedBlockingQueue queue=new LinkedBlockingQueue<List<String>>();
  InMemCubeBuilder cubeBuilder=new InMemCubeBuilder(queue,cube,getDictionaryMap(cubeSegment),new ConsoleGTRecordWriter());
  ExecutorService executorService=Executors.newSingleThreadExecutor();
  Future<?> future=executorService.submit(cubeBuilder);
  loadDataFromLocalFile(queue);
  future.get();
  logger.info("stream build finished");
}
