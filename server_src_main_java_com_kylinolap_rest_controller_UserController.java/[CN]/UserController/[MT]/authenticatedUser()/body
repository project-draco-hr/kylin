{
  Authentication authentication=SecurityContextHolder.getContext().getAuthentication();
  if (authentication == null || !(authentication.getPrincipal() instanceof UserDetails)) {
    return null;
  }
  return (UserDetails)authentication.getPrincipal();
}
