{
  checkNoBuildingSegment(cube);
  CubeSegment newSegment;
  if (cube.getDescriptor().getCubePartitionDesc().isPartitioned()) {
    long startDate=calculateStartDateForAppendSegment(cube);
    newSegment=newSegment(cube,startDate,endDate);
  }
 else {
    newSegment=newSegment(cube,0,Long.MAX_VALUE);
  }
  validateNewSegments(cube,newSegment);
  cube.getSegments().add(newSegment);
  Collections.sort(cube.getSegments());
  updateCube(cube);
  return newSegment;
}
