{
  ResourceStore store=getStore();
  CubeInstance cubeInstance=null;
  try {
    cubeInstance=store.getResource(path,CubeInstance.class,CUBE_SERIALIZER);
    cubeInstance.setConfig(config);
    if (StringUtils.isBlank(cubeInstance.getName()))     throw new IllegalStateException("CubeInstance name must not be blank, at " + path);
    if (cubeInstance.getDescriptor() == null)     throw new IllegalStateException("CubeInstance desc not found '" + cubeInstance.getDescName() + "', at "+ path);
    final String cubeName=cubeInstance.getName();
    cubeMap.putLocal(cubeName,cubeInstance);
    for (    CubeSegment segment : cubeInstance.getSegments()) {
      usedStorageLocation.put(cubeName,segment.getStorageLocationIdentifier());
    }
    return cubeInstance;
  }
 catch (  Exception e) {
    logger.error("Error during load cube instance " + path,e);
    return null;
  }
}
