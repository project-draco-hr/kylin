{
  checkNoBuildingSegment(cube);
  checkCubeIsPartitioned(cube);
  long appendStart=calculateStartDateForAppendSegment(cube);
  CubeSegment appendSegment=newSegment(cube,appendStart,endDate);
  long startDate=cube.getDescriptor().getCubePartitionDesc().getPartitionDateStart();
  Pair<Long,Long> range=alignMergeRange(cube,startDate,endDate);
  CubeSegment mergeSegment=newSegment(cube,range.getFirst(),range.getSecond());
  validateNewSegments(cube,appendSegment,mergeSegment);
  cube.getSegments().add(appendSegment);
  cube.getSegments().add(mergeSegment);
  Collections.sort(cube.getSegments());
  updateCube(cube);
  return new Pair<CubeSegment,CubeSegment>(appendSegment,mergeSegment);
}
