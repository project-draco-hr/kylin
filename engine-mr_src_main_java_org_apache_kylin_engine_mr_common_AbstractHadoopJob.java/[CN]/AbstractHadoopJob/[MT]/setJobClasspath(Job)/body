{
  String jarPath=KylinConfig.getInstanceFromEnv().getKylinJobJarPath();
  File jarFile=new File(jarPath);
  if (jarFile.exists()) {
    job.setJar(jarPath);
    logger.info("append job jar: " + jarPath);
  }
 else {
    job.setJarByClass(this.getClass());
  }
  String kylinHiveDependency=System.getProperty("kylin.hive.dependency");
  String kylinHBaseDependency=System.getProperty("kylin.hbase.dependency");
  logger.info("append kylin.hbase.dependency: " + kylinHBaseDependency + " to "+ MAP_REDUCE_CLASSPATH);
  Configuration jobConf=job.getConfiguration();
  String classpath=jobConf.get(MAP_REDUCE_CLASSPATH);
  if (classpath == null || classpath.length() == 0) {
    logger.info("Didn't find " + MAP_REDUCE_CLASSPATH + " in job configuration, will run 'mapred classpath' to get the default value.");
    classpath=getDefaultMapRedClasspath();
    logger.info("The default mapred classpath is: " + classpath);
  }
  if (kylinHBaseDependency != null) {
    kylinHBaseDependency=kylinHBaseDependency.replace(":",",");
    classpath=classpath + "," + kylinHBaseDependency;
  }
  jobConf.set(MAP_REDUCE_CLASSPATH,classpath);
  logger.info("Hadoop job classpath is: " + job.getConfiguration().get(MAP_REDUCE_CLASSPATH));
  StringBuilder kylinDependency=new StringBuilder();
  if (kylinHiveDependency != null) {
    kylinHiveDependency=kylinHiveDependency.replace(":",",");
    logger.info("Hive Dependencies Before Filtered: " + kylinHiveDependency);
    String filteredHive=filterKylinHiveDependency(kylinHiveDependency);
    logger.info("Hive Dependencies After Filtered: " + filteredHive);
    if (kylinDependency.length() > 0)     kylinDependency.append(",");
    kylinDependency.append(filteredHive);
  }
  String mrLibDir=KylinConfig.getInstanceFromEnv().getKylinJobMRLibDir();
  if (!StringUtils.isBlank(mrLibDir)) {
    File dirFileMRLIB=new File(mrLibDir);
    if (dirFileMRLIB.exists()) {
      if (kylinDependency.length() > 0)       kylinDependency.append(",");
      kylinDependency.append(mrLibDir);
    }
 else {
      logger.info("The directory '" + mrLibDir + "' for 'kylin.job.mr.lib.dir' does not exist!!!");
    }
  }
  setJobTmpJarsAndFiles(job,kylinDependency.toString());
}
