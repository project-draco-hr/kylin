{
  checkPreconditions();
  IIJob result=initialJob("BUILD");
  final String jobId=result.getId();
  final IIJoinedFlatTableDesc intermediateTableDesc=new IIJoinedFlatTableDesc(getIIDesc());
  final String intermediateHiveTableName=getIntermediateHiveTableName(intermediateTableDesc,jobId);
  final String factDistinctColumnsPath=getIIDistinctColumnsPath(jobId);
  final String iiRootPath=getJobWorkingDir(jobId) + "/" + getIIName()+ "/";
  final String iiPath=iiRootPath + "*";
  final AbstractExecutable intermediateHiveTableStep=createIntermediateHiveTableStep(intermediateTableDesc,jobId);
  result.addTask(intermediateHiveTableStep);
  result.addTask(createFactDistinctColumnsStep(intermediateHiveTableName,jobId,factDistinctColumnsPath));
  result.addTask(createBuildDictionaryStep(factDistinctColumnsPath));
  result.addTask(createInvertedIndexStep(intermediateHiveTableName,iiRootPath));
  result.addTask(this.createCreateHTableStep());
  result.addTask(createCreateHTableStep());
  result.addTask(createConvertToHfileStep(iiPath,jobId));
  result.addTask(createBulkLoadStep(jobId));
  return result;
}
