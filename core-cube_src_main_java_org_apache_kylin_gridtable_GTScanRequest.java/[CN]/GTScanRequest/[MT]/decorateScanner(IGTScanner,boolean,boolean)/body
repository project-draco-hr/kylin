{
  IGTScanner result=scanner;
  if (!doFilter) {
    int scanned=lookAndForget(result);
    return new EmptyGTScanner(scanned);
  }
 else {
    if (this.hasFilterPushDown()) {
      result=new GTFilterScanner(result,this);
    }
    if (!doAggr) {
      int scanned=lookAndForget(result);
      return new EmptyGTScanner(scanned);
    }
    if (this.allowPreAggregation && this.hasAggregation()) {
      result=new GTAggregateScanner(result,this);
    }
    return result;
  }
}
