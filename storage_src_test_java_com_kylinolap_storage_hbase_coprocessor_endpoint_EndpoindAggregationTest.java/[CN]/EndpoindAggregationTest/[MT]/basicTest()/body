{
  for (int i=0; i < tableData.size(); ++i) {
    byte[] data=tableData.get(i).getBytes();
    CoprocessorProjector.AggrKey aggKey=projector.getAggrKey(data);
    MeasureAggregator[] bufs=aggCache.getBuffer(aggKey);
    aggregators.aggregate(bufs,data);
    aggCache.checkMemoryUsage();
  }
  assertEquals(aggCache.getAllEntries().size(),2);
  long sumTotal=0;
  long minTotal=0;
  for (  Map.Entry<CoprocessorProjector.AggrKey,MeasureAggregator[]> entry : aggCache.getAllEntries()) {
    sumTotal+=((LongWritable)entry.getValue()[0].getState()).get();
    minTotal+=((LongWritable)entry.getValue()[1].getState()).get();
  }
  assertEquals(sumTotal,302080000);
  assertEquals(minTotal,102090000);
}
