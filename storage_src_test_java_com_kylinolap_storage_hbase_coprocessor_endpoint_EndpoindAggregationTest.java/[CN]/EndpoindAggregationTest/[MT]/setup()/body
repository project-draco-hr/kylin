{
  this.createTestMetadata();
  this.ii=IIManager.getInstance(getTestConfig()).getII("test_kylin_ii");
  this.tableRecordInfo=new TableRecordInfo(ii.getFirstSegment());
  TblColRef formatName=this.ii.getDescriptor().findColumnRef("DEFAULT.TEST_KYLIN_FACT","LSTG_FORMAT_NAME");
  TblColRef siteId=this.ii.getDescriptor().findColumnRef("DEFAULT.TEST_KYLIN_FACT","LSTG_SITE_ID");
  Collection<TblColRef> dims=new HashSet<>();
  dims.add(formatName);
  projector=CoprocessorProjector.makeForEndpoint(tableRecordInfo,dims);
  aggregators=EndpointAggregators.fromFunctions(tableRecordInfo,buildAggregations());
  CompareTupleFilter rawFilter=new CompareTupleFilter(TupleFilter.FilterOperatorEnum.EQ);
  rawFilter.addChild(new ColumnTupleFilter(siteId));
  rawFilter.addChild(new ConstantTupleFilter("0"));
  filter=CoprocessorFilter.fromFilter(this.ii.getFirstSegment(),rawFilter);
  aggCache=new EndpointAggregationCache(aggregators);
  tableData=mockTable();
}
