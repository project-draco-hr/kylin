{
  r.maskForEqualHashComp(groupBy);
  MeasureAggregator[] aggrs=aggBufMap.get(r);
  if (aggrs == null) {
    aggrs=new MeasureAggregator[metricsAggrFuncs.length];
    for (int i=0, col=-1; i < aggrs.length; i++) {
      col=metrics.nextSetBit(col + 1);
      aggrs[i]=info.codeSystem.newMetricsAggregator(metricsAggrFuncs[i],col);
    }
    aggBufMap.put(r.copy(dimensions),aggrs);
  }
  for (int i=0, col=-1; i < aggrs.length; i++) {
    col=metrics.nextSetBit(col + 1);
    Object metrics=info.codeSystem.decodeColumnValue(col,r.cols[col].asBuffer());
    aggrs[i].aggregate(metrics);
  }
}
