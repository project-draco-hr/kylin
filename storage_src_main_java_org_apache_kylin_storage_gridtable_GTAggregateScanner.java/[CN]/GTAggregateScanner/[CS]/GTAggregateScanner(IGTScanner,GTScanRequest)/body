{
  if (req.hasAggregation() == false)   throw new IllegalStateException();
  this.info=inputScanner.getInfo();
  this.dimensions=req.getColumns().andNot(req.getAggrMetrics());
  this.groupBy=req.getAggrGroupBy();
  this.metrics=req.getAggrMetrics();
  this.metricsAggrFuncs=req.getAggrMetricsFuncs();
  this.inputScanner=inputScanner;
}
