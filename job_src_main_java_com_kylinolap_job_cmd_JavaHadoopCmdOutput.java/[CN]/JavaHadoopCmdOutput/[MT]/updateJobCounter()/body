{
  try {
    Counters counters=job.getCounters();
    if (counters == null) {
      String errorMsg="no counters for job " + mrJobID;
      log.warn(errorMsg);
      output.append(errorMsg);
      return;
    }
    this.output.append(counters.toString()).append("\n");
    log.debug(counters.toString());
    JobDAO jobDAO=JobDAO.getInstance(config);
    JobInstance jobInstance=jobDAO.getJob(jobInstanceID);
    JobStep jobStep=jobInstance.getSteps().get(jobStepID);
    long mapInputRecords=counters.findCounter(TaskCounter.MAP_INPUT_RECORDS).getValue();
    jobStep.putInfo(JobInstance.SOURCE_RECORDS_COUNT,String.valueOf(mapInputRecords));
    long hdfsBytesWritten=counters.findCounter("FileSystemCounters","HDFS_BYTES_WRITTEN").getValue();
    jobStep.putInfo(JobInstance.HDFS_BYTES_WRITTEN,String.valueOf(hdfsBytesWritten));
    jobDAO.updateJobInstance(jobInstance);
  }
 catch (  Exception e) {
    log.error(e.getLocalizedMessage(),e);
    output.append(e.getLocalizedMessage());
  }
}
