{
  ArrayList<Pair<ImmutableBytesWritable,ImmutableBytesWritable>> result=Lists.newArrayList();
  ColumnValueContainer[] containers=slice.containers;
  for (int col=0; col < containers.length; col++) {
    if (containers[col] instanceof BitMapContainer) {
      collectKeyValues(slice,col,(BitMapContainer)containers[col],result);
    }
 else     if (containers[col] instanceof CompressedValueContainer) {
      collectKeyValues(slice,col,(CompressedValueContainer)containers[col],result);
    }
 else {
      throw new IllegalArgumentException("Unkown container class " + containers[col].getClass());
    }
  }
  return result;
}
