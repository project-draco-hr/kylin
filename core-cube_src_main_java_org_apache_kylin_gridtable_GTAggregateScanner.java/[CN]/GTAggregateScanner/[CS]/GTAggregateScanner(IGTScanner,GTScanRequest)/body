{
  if (!req.hasAggregation())   throw new IllegalStateException();
  this.info=inputScanner.getInfo();
  this.dimensions=req.getColumns().andNot(req.getAggrMetrics());
  this.groupBy=req.getAggrGroupBy();
  this.metrics=req.getAggrMetrics();
  this.metricsAggrFuncs=req.getAggrMetricsFuncs();
  this.inputScanner=inputScanner;
  this.aggrCache=new AggregationCache();
  this.spillThreshold=(long)(req.getAggrCacheGB() * MemoryBudgetController.ONE_GB);
}
