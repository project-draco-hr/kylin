{
  DataType[] types=new DataType[metrics.trueBitCount()];
  for (int i=0; i < types.length; i++) {
    types[i]=info.getColumnType(metrics.trueBitAt(i));
  }
  BufferedMeasureEncoder result=new BufferedMeasureEncoder(types);
  result.setBufferSize(info.getMaxColumnLength(metrics));
  return result;
}
