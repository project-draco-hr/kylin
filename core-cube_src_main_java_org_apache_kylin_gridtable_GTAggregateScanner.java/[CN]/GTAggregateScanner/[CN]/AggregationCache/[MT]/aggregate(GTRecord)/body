{
  if (enableMemCheck && (++aggregatedRowCount % 100000 == 0)) {
    if (estimatedMemSize() > MemoryBudgetController.ONE_GB) {
      throw new RuntimeException("AggregationCache exceed 1GB");
    }
  }
  final byte[] key=createKey(r);
  MeasureAggregator[] aggrs=aggBufMap.get(key);
  if (aggrs == null) {
    aggrs=newAggregators();
    aggBufMap.put(key,aggrs);
  }
  for (int i=0; i < aggrs.length; i++) {
    int col=metrics.trueBitAt(i);
    Object metrics=info.codeSystem.decodeColumnValue(col,r.cols[col].asBuffer());
    aggrs[i].aggregate(metrics);
  }
}
