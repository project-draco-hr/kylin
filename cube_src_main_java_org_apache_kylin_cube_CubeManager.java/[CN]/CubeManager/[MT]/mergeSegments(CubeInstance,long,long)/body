{
  checkNoBuildingSegment(cube);
  checkCubeIsPartitioned(cube);
  Pair<Long,Long> range=alignMergeRange(cube,startDate,endDate);
  CubeSegment newSegment=newSegment(cube,range.getFirst(),range.getSecond());
  validateNewSegments(cube,newSegment);
  saveCubeSegmentChange(cube,Lists.newArrayList(newSegment),null);
  return newSegment;
}
