{
  MetadataManager metaMgr=getMetadataManager();
  SnapshotManager snapshotMgr=getSnapshotManager();
  HiveTable hiveTable=new HiveTable(metaMgr,lookupTable);
  TableDesc tableDesc=metaMgr.getTableDesc(lookupTable);
  SnapshotTable snapshot=snapshotMgr.buildSnapshot(hiveTable,tableDesc);
  cubeSeg.putSnapshotResPath(lookupTable,snapshot.getResourcePath());
  updateCube(cubeSeg.getCubeInstance(),null,null,Lists.newArrayList(cubeSeg),null);
  return snapshot;
}
