{
  JobStep mergeCuboidDataStep=new JobStep();
  mergeCuboidDataStep.setName(JobConstants.STEP_NAME_MERGE_CUBOID);
  String cmd="";
  cmd=appendMapReduceParameters(cmd,jobInstance);
  cmd=appendExecCmdParameters(cmd,"cubename",cubeName);
  cmd=appendExecCmdParameters(cmd,"segmentname",segmentName);
  cmd=appendExecCmdParameters(cmd,"input",inputPath);
  cmd=appendExecCmdParameters(cmd,"output",jobWorkingDir + "/" + cubeName+ "/merged_cuboid");
  cmd=appendExecCmdParameters(cmd,"jobname","Kylin_Merge_Cuboid_" + jobInstance.getRelatedCube() + "_Step_"+ stepSeqNum);
  mergeCuboidDataStep.setExecCmd(cmd);
  mergeCuboidDataStep.setSequenceID(stepSeqNum);
  mergeCuboidDataStep.setStatus(JobStepStatusEnum.PENDING);
  mergeCuboidDataStep.setRunAsync(true);
  mergeCuboidDataStep.setCmdType(JobStepCmdTypeEnum.JAVA_CMD_HADOOP_MERGECUBOID);
  return mergeCuboidDataStep;
}
