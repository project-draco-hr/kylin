{
  Preconditions.checkNotNull(rec);
  GTInfo info=rec.getInfo();
  int len=info.getMaxColumnLength(info.getPrimaryKey());
  ByteArray buf=ByteArray.allocate(len);
  byte fill;
  int pos=0;
  for (int i=0; i < info.getPrimaryKey().trueBitCount(); i++) {
    int c=info.getPrimaryKey().trueBitAt(i);
    int colLength=info.getCodeSystem().maxCodeLength(c);
    if (rec.get(c).array() != null) {
      fill=RowConstants.BYTE_ZERO;
    }
 else {
      fill=RowConstants.BYTE_ONE;
    }
    Arrays.fill(buf.array(),buf.offset() + pos,buf.offset() + pos + colLength,fill);
    pos+=colLength;
  }
  buf.setLength(pos);
  return buf;
}
