{
  Preconditions.checkNotNull(rec);
  GTInfo info=rec.getInfo();
  int len=info.getMaxColumnLength(info.getPrimaryKey());
  ByteArray buf=ByteArray.allocate(len);
  int pos=0;
  for (int i=0; i < info.getPrimaryKey().trueBitCount(); i++) {
    int c=info.getPrimaryKey().trueBitAt(i);
    int colLength=info.getCodeSystem().maxCodeLength(c);
    if (rec.get(c).array() != null) {
      Preconditions.checkArgument(colLength == rec.get(c).length(),"ColLength :" + colLength + " not equals cols[c] length: "+ rec.get(c).length()+ " c is "+ c);
      System.arraycopy(rec.get(c).array(),rec.get(c).offset(),buf.array(),buf.offset() + pos,rec.get(c).length());
    }
 else {
      Arrays.fill(buf.array(),buf.offset() + pos,buf.offset() + pos + colLength,fill);
    }
    pos+=colLength;
  }
  buf.setLength(pos);
  return buf;
}
