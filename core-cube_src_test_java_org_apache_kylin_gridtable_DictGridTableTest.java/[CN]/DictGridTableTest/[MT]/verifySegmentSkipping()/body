{
  ByteArray segmentStart=enc(info,0,"2015-01-14");
  ByteArray segmentStartX=enc(info,0,"2015-01-14 00:00:00");
  ByteArray segmentEnd=enc(info,0,"2015-01-15");
  assertEquals(segmentStart,segmentStartX);
  GTScanRangePlanner planner=new GTScanRangePlanner(info,Pair.newPair(segmentStart,segmentEnd),info.colRef(0));
{
    LogicalTupleFilter filter=and(timeComp0,ageComp1);
    List<GTScanRange> r=planner.planScanRanges(filter);
    assertEquals(1,r.size());
    assertEquals("[null, 10]-[1421193600000, 10]",r.get(0).toString());
    assertEquals(1,r.get(0).fuzzyKeys.size());
    assertEquals("[[10]]",r.get(0).fuzzyKeys.toString());
  }
{
    LogicalTupleFilter filter=and(timeComp2,ageComp1);
    List<GTScanRange> r=planner.planScanRanges(filter);
    assertEquals(0,r.size());
  }
{
    LogicalTupleFilter filter=and(timeComp4,ageComp1);
    List<GTScanRange> r=planner.planScanRanges(filter);
    assertEquals(0,r.size());
  }
{
    LogicalTupleFilter filter=and(timeComp5,ageComp1);
    List<GTScanRange> r=planner.planScanRanges(filter);
    assertEquals(0,r.size());
  }
{
    LogicalTupleFilter filter=or(and(timeComp2,ageComp1),and(timeComp1,ageComp1),and(timeComp6,ageComp1));
    List<GTScanRange> r=planner.planScanRanges(filter);
    assertEquals(1,r.size());
    assertEquals("[1421193600000, 10]-[null, 10]",r.get(0).toString());
    assertEquals("[[10], [1421193600000, 10]]",r.get(0).fuzzyKeys.toString());
  }
{
    LogicalTupleFilter filter=or(timeComp2,timeComp1,timeComp6);
    List<GTScanRange> r=planner.planScanRanges(filter);
    assertEquals(1,r.size());
    assertEquals("[1421193600000, null]-[null, null]",r.get(0).toString());
    assertEquals(0,r.get(0).fuzzyKeys.size());
  }
}
