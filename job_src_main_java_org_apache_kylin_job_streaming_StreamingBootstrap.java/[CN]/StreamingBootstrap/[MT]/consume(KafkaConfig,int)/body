{
  List<BlockingQueue<StreamMessage>> result=Lists.newArrayList();
  for (int partitionId=0; partitionId < partitionCount; ++partitionId) {
    final Broker leadBroker=getLeadBroker(kafkaConfig,partitionId);
    final long latestOffset=KafkaRequester.getLastOffset(kafkaConfig.getTopic(),partitionId,OffsetRequest.LatestTime(),leadBroker,kafkaConfig);
    long streamingOffset=latestOffset;
    logger.info("submitting offset:" + streamingOffset);
    KafkaConsumer consumer=new KafkaConsumer(kafkaConfig.getTopic(),partitionId,streamingOffset,kafkaConfig.getBrokers(),kafkaConfig,1);
    Executors.newSingleThreadExecutor().submit(consumer);
    result.add(consumer.getStreamQueue(0));
  }
  return result;
}
