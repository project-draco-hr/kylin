{
  List<BlockingQueue<StreamMessage>> result=Lists.newArrayList();
  for (int partitionId=0; partitionId < partitionCount; ++partitionId) {
    final Broker leadBroker=getLeadBroker(kafkaClusterConfig,partitionId);
    final long latestOffset=KafkaRequester.getLastOffset(kafkaClusterConfig.getTopic(),partitionId,OffsetRequest.LatestTime(),leadBroker,kafkaClusterConfig);
    long streamingOffset=latestOffset;
    logger.info("submitting offset:" + streamingOffset);
    KafkaConsumer consumer=new KafkaConsumer(kafkaClusterConfig.getTopic(),partitionId,streamingOffset,kafkaClusterConfig.getBrokers(),kafkaClusterConfig,1);
    Executors.newSingleThreadExecutor().submit(consumer);
    result.add(consumer.getStreamQueue(0));
  }
  return result;
}
