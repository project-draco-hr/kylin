{
  MapReduceExecutable cubeStep=new MapReduceExecutable();
  StringBuilder cmd=new StringBuilder();
  appendMapReduceParameters(cmd,seg);
  cubeStep.setName(ExecutableConstants.STEP_NAME_BUILD_IN_MEM_CUBE);
  appendExecCmdParameters(cmd,"cubename",seg.getCubeInstance().getName());
  appendExecCmdParameters(cmd,"segmentname",seg.getName());
  appendExecCmdParameters(cmd,"jobname","Kylin_Cube_Builder_" + seg.getCubeInstance().getName());
  appendExecCmdParameters(cmd,"jobflowid",jobId);
  cubeStep.setMapReduceParams(cmd.toString());
  cubeStep.setMapReduceJobClass(InMemCuboidJob.class);
  cubeStep.setCounterSaveAs(CubingJob.SOURCE_RECORD_COUNT + "," + CubingJob.SOURCE_SIZE_BYTES+ ","+ CubingJob.CUBE_SIZE_BYTES);
  return cubeStep;
}
