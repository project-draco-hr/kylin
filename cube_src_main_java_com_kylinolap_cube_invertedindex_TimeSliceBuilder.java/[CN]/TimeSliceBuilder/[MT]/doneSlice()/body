{
  TimeSlice r=null;
  if (nRecords > 0) {
    for (int i=0; i < nColumns; i++) {
      containers[i].closeForChange();
    }
    r=new TimeSlice(info,curTimePartition,curSliceNo,containers);
  }
  curSliceNo++;
  nRecords=0;
  containers=new ColumnValueContainer[nColumns];
  for (  int i : info.getDescriptor().getBitmapColumns()) {
    containers[i]=new BitMapContainer(info,i);
  }
  for (  int i : info.getDescriptor().getValueColumns()) {
    containers[i]=new CompressedValueContainer(info,i,nRecordsCap);
  }
  return r;
}
