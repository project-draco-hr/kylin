{
  super.setup(context);
  Configuration conf=context.getConfiguration();
  KylinConfig config=AbstractHadoopJob.loadKylinPropsAndMetadata();
  String iiName=conf.get(BatchConstants.CFG_II_NAME);
  IIInstance ii=IIManager.getInstance(config).getII(iiName);
  IIDesc iiDesc=ii.getDescriptor();
  TableRecordInfo info=new TableRecordInfo(iiDesc);
  KeyValueCodec codec=new IIKeyValueCodecWithState(info.getDigest());
  slices=codec.decodeKeyValue(new FIFOIterable<IIRow>(buffer)).iterator();
}
