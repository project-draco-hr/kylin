{
  OutputStreamWriter writer=null;
  CSVWriter cwriter=null;
  FileSystem fs=null;
  try {
    fs=getHdfsFileSystem();
    org.apache.hadoop.fs.Path resultStorePath=new org.apache.hadoop.fs.Path(dPath);
    writer=new OutputStreamWriter(fs.append(resultStorePath));
    cwriter=new CSVWriter(writer,'|',CSVWriter.NO_QUOTE_CHARACTER);
    cwriter.writeNext(record);
  }
 catch (  Exception e) {
    logger.info("Exception",e);
  }
 finally {
    if (writer != null) {
      writer.close();
    }
    if (cwriter != null) {
      cwriter.close();
    }
    if (fs != null) {
      fs.close();
    }
  }
}
