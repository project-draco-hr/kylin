{
  CubeInstance cube=CubeManager.getInstance(getTestConfig()).getCube("TEST_KYLIN_CUBE_WITH_SLR_READY");
  CubeDesc cubeDesc=cube.getDescriptor();
  byte[][] data=new byte[9][];
  data[0]=Bytes.toBytes("123456789");
  data[1]=null;
  data[2]=null;
  data[3]=null;
  data[4]=null;
  data[5]=null;
  data[6]=null;
  data[7]=null;
  data[8]=null;
  long baseCuboidId=Cuboid.getBaseCuboidId(cubeDesc);
  Cuboid baseCuboid=Cuboid.findById(cubeDesc,baseCuboidId);
  AbstractRowKeyEncoder rowKeyEncoder=AbstractRowKeyEncoder.createInstance(cube.getFirstSegment(),baseCuboid);
  byte[] encodedKey=rowKeyEncoder.encode(data);
  assertEquals(40 + RowConstants.ROWKEY_HEADER_LEN,encodedKey.length);
  byte[] shard=Arrays.copyOfRange(encodedKey,0,RowConstants.ROWKEY_SHARDID_LEN);
  byte[] cuboidId=Arrays.copyOfRange(encodedKey,RowConstants.ROWKEY_SHARDID_LEN,RowConstants.ROWKEY_HEADER_LEN);
  byte[] sellerId=Arrays.copyOfRange(encodedKey,RowConstants.ROWKEY_HEADER_LEN,18 + RowConstants.ROWKEY_HEADER_LEN);
  byte[] rest=Arrays.copyOfRange(encodedKey,18 + RowConstants.ROWKEY_HEADER_LEN,encodedKey.length);
  assertEquals(0,Bytes.toShort(shard));
  assertTrue(Bytes.toString(sellerId).startsWith("123456789"));
  assertEquals(511,Bytes.toLong(cuboidId));
  assertArrayEquals(new byte[]{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},rest);
}
