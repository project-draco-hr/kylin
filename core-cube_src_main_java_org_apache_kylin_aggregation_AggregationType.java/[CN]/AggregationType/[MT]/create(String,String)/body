{
  funcName=funcName.toUpperCase();
  dataType=dataType.toLowerCase();
  IAggregationFactory factory=factoryRegistry.get(funcName);
  if (factory == null)   factory=defaultFactory;
  AggregationType result=factory.createAggregationType(funcName,dataType);
  DataType aggregationDataType=result.getAggregationDataType();
  if (DataTypeSerializer.hasRegistered(aggregationDataType.getName()) == false) {
    DataTypeSerializer.register(aggregationDataType.getName(),result.getAggregationDataSeralizer());
  }
  return result;
}
