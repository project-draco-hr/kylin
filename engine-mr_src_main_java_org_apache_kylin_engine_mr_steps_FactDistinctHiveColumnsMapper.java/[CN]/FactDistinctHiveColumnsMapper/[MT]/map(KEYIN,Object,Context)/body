{
  String[] row=flatTableInputFormat.parseMapperInput(record);
  try {
    for (int i=0; i < factDictCols.size(); i++) {
      String fieldValue=row[dictionaryColumnIndex[i]];
      if (fieldValue == null)       continue;
      keyBuffer.clear();
      keyBuffer.putLong((long)factDictCols.get(i));
      keyBuffer.put(Bytes.toBytes(fieldValue));
      outputKey.set(keyBuffer.array(),0,keyBuffer.position());
      context.write(outputKey,EMPTY_TEXT);
    }
  }
 catch (  Exception ex) {
    handleErrorRecord(row,ex);
  }
  if (collectStatistics && rowCount < samplingPercentage) {
    putRowKeyToHLL(row);
  }
  if (rowCount++ == 100)   rowCount=0;
}
