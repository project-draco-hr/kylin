{
  String[] row=flatTableInputFormat.parseMapperInput(record);
  try {
    for (    int i : factDictCols) {
      outputKey.set((long)i);
      String fieldValue=row[intermediateTableDesc.getRowKeyColumnIndexes()[i]];
      if (fieldValue == null)       continue;
      byte[] bytes=Bytes.toBytes(fieldValue);
      outputValue.set(bytes,0,bytes.length);
      context.write(outputKey,outputValue);
    }
  }
 catch (  Exception ex) {
    handleErrorRecord(row,ex);
  }
  if (collectStatistics && rowCount < SAMPING_PERCENTAGE) {
    putRowKeyToHLL(row);
  }
  if (rowCount++ == 100)   rowCount=0;
}
