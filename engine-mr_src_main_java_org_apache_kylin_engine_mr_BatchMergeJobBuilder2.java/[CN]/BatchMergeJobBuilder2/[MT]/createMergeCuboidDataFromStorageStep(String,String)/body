{
  MapReduceExecutable mergeCuboidDataStep=new MapReduceExecutable();
  mergeCuboidDataStep.setName(ExecutableConstants.STEP_NAME_MERGE_CUBOID);
  StringBuilder cmd=new StringBuilder();
  appendMapReduceParameters(cmd,((CubeSegment)seg).getCubeDesc().getModel());
  appendExecCmdParameters(cmd,"cubename",seg.getRealization().getName());
  appendExecCmdParameters(cmd,"segmentname",seg.getName());
  appendExecCmdParameters(cmd,"jobname","Kylin_Merge_Cuboid_" + seg.getRealization().getName() + "_Step");
  appendExecCmdParameters(cmd,"jobflowid",jobId);
  mergeCuboidDataStep.setMapReduceParams(cmd.toString());
  mergeCuboidDataStep.setMapReduceJobClass(MergeCuboidFromStorageJob.class);
  mergeCuboidDataStep.setCounterSaveAs(",," + CubingJob.CUBE_SIZE_BYTES);
  return mergeCuboidDataStep;
}
