{
  SnapshotTable snapshot=new SnapshotTable(table);
  snapshot.updateRandomUuid();
  String dup=checkDupByInfo(snapshot);
  if (dup != null) {
    logger.info("Identical input " + table.getSignature() + ", reuse existing snapshot at "+ dup);
    return getSnapshotTable(dup);
  }
  snapshot.takeSnapshot(table,tableDesc);
  return trySaveNewSnapshot(snapshot);
}
