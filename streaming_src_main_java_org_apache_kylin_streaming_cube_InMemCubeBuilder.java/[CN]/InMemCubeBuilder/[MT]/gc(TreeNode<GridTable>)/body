{
  final List<TreeNode<GridTable>> gridTables=parentNode.getAncestorList();
  logger.info("trying to select node to flush to disk, from:" + StringUtils.join(",",gridTables));
  for (  TreeNode<GridTable> gridTable : gridTables) {
    final GTComboStore store=(GTComboStore)gridTable.data.getStore();
    if (store.memoryUsage() > 0) {
      logger.info("cuboid id:" + gridTable.id + " flush to disk");
      long t=System.currentTimeMillis();
      store.switchToDiskStore();
      logger.info("switch to disk store cost:" + (System.currentTimeMillis() - t) + "ms");
      waitForGc();
      return true;
    }
  }
  logger.warn("all ancestor nodes of " + parentNode.id + " has been flushed to disk");
  return false;
}
