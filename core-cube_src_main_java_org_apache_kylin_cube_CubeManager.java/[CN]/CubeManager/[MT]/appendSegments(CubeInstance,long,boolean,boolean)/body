{
  long startDate=0;
  if (cube.getDescriptor().getModel().getPartitionDesc().isPartitioned()) {
    startDate=calculateStartDateForAppendSegment(cube);
    if (endDate > cube.getDescriptor().getPartitionDateEnd()) {
      SimpleDateFormat f=new SimpleDateFormat("yyyy-MM-dd");
      f.setTimeZone(TimeZone.getTimeZone("GMT"));
      throw new IllegalArgumentException("The selected date couldn't be later than cube's end date '" + f.format(new Date(cube.getDescriptor().getPartitionDateEnd())) + "'.");
    }
  }
 else {
    endDate=Long.MAX_VALUE;
  }
  return appendSegments(cube,startDate,endDate,strictChecking,saveChange);
}
