{
  List<CubeSegment> readySegments=cube.getSegments(SegmentStatusEnum.READY);
  if (readySegments.isEmpty()) {
    throw new IllegalStateException("there are no segments in ready state");
  }
  long start=Long.MAX_VALUE;
  long end=Long.MIN_VALUE;
  for (  CubeSegment readySegment : readySegments) {
    if (hasOverlap(startDate,endDate,readySegment.getDateRangeStart(),readySegment.getDateRangeEnd())) {
      if (start > readySegment.getDateRangeStart()) {
        start=readySegment.getDateRangeStart();
      }
      if (end < readySegment.getDateRangeEnd()) {
        end=readySegment.getDateRangeEnd();
      }
    }
  }
  return Pair.newPair(start,end);
}
