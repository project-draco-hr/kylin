{
  CubeDesc cubeDesc=cubeSeg.getCubeDesc();
  if (!cubeDesc.getAllColumnsNeedDictionary().contains(col))   return null;
  DictionaryManager dictMgr=getDictionaryManager();
  DictionaryInfo dictInfo=dictMgr.buildDictionary(cubeDesc.getModel(),true,col,factTableValueProvider);
  if (dictInfo != null) {
    Dictionary dict=dictInfo.getDictionaryObject();
    cubeSeg.putDictResPath(col,dictInfo.getResourcePath());
    cubeSeg.getRowkeyStats().add(new Object[]{col.getName(),dict.getSize(),dict.getSizeOfId()});
    CubeUpdate cubeBuilder=new CubeUpdate(cubeSeg.getCubeInstance());
    cubeBuilder.setToUpdateSegs(cubeSeg);
    updateCube(cubeBuilder);
  }
  return dictInfo;
}
