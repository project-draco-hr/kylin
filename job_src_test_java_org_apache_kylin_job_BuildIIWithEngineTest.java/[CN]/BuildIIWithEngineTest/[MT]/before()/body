{
  HBaseMetadataTestCase.staticCreateTestMetadata(AbstractKylinTestCase.SANDBOX_TEST_DATA);
  DeployUtil.overrideJobJarLocations();
  final KylinConfig kylinConfig=KylinConfig.getInstanceFromEnv();
  jobService=ExecutableManager.getInstance(kylinConfig);
  scheduler=DefaultScheduler.getInstance();
  scheduler.init(new JobEngineConfig(kylinConfig),new ZookeeperJobLock());
  if (!scheduler.hasStarted()) {
    throw new RuntimeException("scheduler has not been started");
  }
  jobEngineConfig=new JobEngineConfig(kylinConfig);
  for (  String jobId : jobService.getAllJobIds()) {
    if (jobService.getJob(jobId) instanceof IIJob) {
      jobService.deleteJob(jobId);
    }
  }
  iiManager=IIManager.getInstance(kylinConfig);
  for (  String iiInstance : TEST_II_INSTANCES) {
    IIInstance ii=iiManager.getII(iiInstance);
    if (ii.getStatus() != RealizationStatusEnum.DISABLED) {
      ii.setStatus(RealizationStatusEnum.DISABLED);
      iiManager.updateII(ii);
    }
  }
}
