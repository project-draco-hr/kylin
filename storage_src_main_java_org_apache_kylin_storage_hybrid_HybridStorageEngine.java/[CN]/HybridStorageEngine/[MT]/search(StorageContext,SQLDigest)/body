{
  ITupleIterator iterator1=searchRealization(hybridInstance.getHistoryRealizationInstance(),context,sqlDigest);
  String modelName=hybridInstance.getModelName();
  MetadataManager metaMgr=getMetadataManager();
  DataModelDesc modelDesc=metaMgr.getDataModelDesc(modelName);
  if (modelDesc.getPartitionDesc() == null || modelDesc.getPartitionDesc().getPartitionDateColumnRef() == null)   return iterator1;
  TblColRef partitionColRef=modelDesc.getPartitionDesc().getPartitionDateColumnRef();
  TupleFilter originalFilter=sqlDigest.filter;
  sqlDigest.filter=createFilterForRealtime(originalFilter,partitionColRef,hybridInstance.getHistoryRealizationInstance().getDateRangeEnd());
  boolean addFilterColumn=false, addAllColumn=false;
  if (!sqlDigest.filterColumns.contains(partitionColRef)) {
    sqlDigest.filterColumns.add(partitionColRef);
    addFilterColumn=true;
  }
  if (!sqlDigest.allColumns.contains(partitionColRef)) {
    sqlDigest.allColumns.add(partitionColRef);
    addAllColumn=true;
  }
  ITupleIterator iterator2=searchRealization(hybridInstance.getRealTimeRealizationInstance(),context,sqlDigest);
  sqlDigest.filter=originalFilter;
  if (addFilterColumn)   sqlDigest.filterColumns.remove(partitionColRef);
  if (addAllColumn)   sqlDigest.allColumns.remove(partitionColRef);
  return new HybridTupleIterator(new ITupleIterator[]{iterator1,iterator2});
}
