{
  ITupleIterator iterator1=searchRealization(hybridInstance.getHistoryRealizationInstance(),context,sqlDigest);
  String modelName=hybridInstance.getModelName();
  MetadataManager metaMgr=getMetadataManager();
  DataModelDesc modelDesc=metaMgr.getDataModelDesc(modelName);
  if (modelDesc.getPartitionDesc() == null || modelDesc.getPartitionDesc().getPartitionDateColumnRef() == null)   return iterator1;
  TblColRef partitionColRef=modelDesc.getPartitionDesc().getPartitionDateColumnRef();
  ITupleIterator iterator2=SQLDigestUtil.appendTsFilterToExecute(sqlDigest,partitionColRef,Range.atLeast(hybridInstance.getHistoryRealizationInstance().getDateRangeEnd()),new Function<Void,ITupleIterator>(){
    @Nullable @Override public ITupleIterator apply(    @Nullable Void input){
      ITupleIterator iterator2=searchRealization(hybridInstance.getRealTimeRealizationInstance(),context,sqlDigest);
      return iterator2;
    }
  }
);
  return new CompoundTupleIterator(Lists.newArrayList(iterator1,iterator2));
}
