{
  logger.info("Job Fetcher is running...");
  for (  final AbstractExecutable executable : jobService.getAllExecutables()) {
    boolean hasLock=false;
    try {
      hasLock=acquireJobLock(executable,1);
    }
 catch (    LockException e) {
      logger.error("error acquire job lock, id:" + executable.getId(),e);
    }
    logger.info("acquire job lock:" + executable.getId() + " status:"+ (hasLock ? "succeed" : "failed"));
    if (hasLock) {
      try {
        logger.info("start to run job id:" + executable.getId());
        context.addRunningJob(executable);
        jobPool.execute(new JobRunner(executable));
      }
  finally {
        try {
          logger.info("finish running job id:" + executable.getId());
          releaseJobLock(executable.getId());
        }
 catch (        LockException ex) {
          logger.error("error release job lock, id:" + executable.getId(),ex);
        }
      }
    }
    if (!context.getRunningJobs().containsKey(executable.getId())) {
      resetStatusFromRunningToError(executable);
    }
  }
  logger.info("Job Fetcher finish running");
}
