{
  this.createTestMetadata();
  this.ii=IIManager.getInstance(getTestConfig()).getII("test_kylin_ii_left_join");
  if (ii.getFirstSegment() == null) {
    IISegment segment=IIManager.getInstance(getTestConfig()).buildSegment(ii,0,System.currentTimeMillis());
    ii.getSegments().add(segment);
  }
  this.tableRecordInfo=new TableRecordInfo(ii.getFirstSegment());
  this.factTableDesc=MetadataManager.getInstance(getTestConfig()).getTableDesc("DEFAULT.TEST_KYLIN_FACT");
  this.calDt=this.ii.getDescriptor().findColumnRef("DEFAULT.TEST_KYLIN_FACT","CAL_DT");
  this.siteId=this.ii.getDescriptor().findColumnRef("DEFAULT.TEST_KYLIN_FACT","LSTG_SITE_ID");
}
