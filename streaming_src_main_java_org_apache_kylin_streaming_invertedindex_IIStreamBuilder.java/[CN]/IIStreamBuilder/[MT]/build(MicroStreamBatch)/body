{
  if (microStreamBatch.size() > 0) {
    long offset=microStreamBatch.getOffset().getFirst();
    if (offset < streamingManager.getOffset(streaming,shardId)) {
      logger.info("this batch has already been built, skip building");
      return;
    }
    logger.info("stream build start, size:" + microStreamBatch.size());
    Stopwatch stopwatch=new Stopwatch();
    stopwatch.start();
    final Slice slice=sliceBuilder.buildSlice(microStreamBatch);
    logger.info("slice info, shard:" + slice.getShard() + " timestamp:"+ slice.getTimestamp()+ " record count:"+ slice.getRecordCount());
    loadToHBase(hTable,slice,new IIKeyValueCodec(slice.getInfo()));
    submitOffset(offset);
    stopwatch.stop();
    logger.info("stream build finished, size:" + microStreamBatch.size() + " elapsed time:"+ stopwatch.elapsedTime(TimeUnit.MILLISECONDS)+ " "+ TimeUnit.MILLISECONDS);
  }
 else {
    logger.info("nothing to build, skip building");
  }
}
