{
  try {
    List<Put> data=Lists.newArrayList();
    for (    IIRow row : codec.encodeKeyValue(slice)) {
      final byte[] key=row.getKey().get();
      final byte[] value=row.getValue().get();
      Put put=new Put(key);
      put.add(IIDesc.HBASE_FAMILY_BYTES,IIDesc.HBASE_QUALIFIER_BYTES,value);
      final ImmutableBytesWritable dictionary=row.getDictionary();
      final byte[] dictBytes=dictionary.get();
      if (dictionary.getOffset() == 0 && dictionary.getLength() == dictBytes.length) {
        put.add(IIDesc.HBASE_FAMILY_BYTES,IIDesc.HBASE_DICTIONARY_BYTES,dictBytes);
      }
 else {
        throw new RuntimeException("dict offset should be 0, and dict length should be " + dictBytes.length + " but they are"+ dictionary.getOffset()+ " "+ dictionary.getLength());
      }
      data.add(put);
    }
    hTable.put(data);
  }
  finally {
    hTable.close();
  }
}
