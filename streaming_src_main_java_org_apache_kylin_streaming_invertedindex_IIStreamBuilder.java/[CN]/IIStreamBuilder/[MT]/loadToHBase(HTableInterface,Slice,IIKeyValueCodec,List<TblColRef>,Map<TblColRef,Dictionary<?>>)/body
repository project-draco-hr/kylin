{
  try {
    List<Put> data=Lists.newArrayList();
    for (    KeyValuePair pair : codec.encodeKeyValue(slice)) {
      final byte[] key=pair.getKey().get();
      final byte[] value=pair.getValue().get();
      Put put=new Put(key);
      put.add(IIDesc.HBASE_FAMILY_BYTES,IIDesc.HBASE_QUALIFIER_BYTES,value);
      final int id=pair.getId();
      if (id >= 0 && id < allColumns.size()) {
        final Dictionary<?> dictionary=localDictionaries.get(allColumns.get(id));
        if (dictionary != null) {
          final ByteArrayOutputStream baos=new ByteArrayOutputStream();
          DataOutputStream out=new DataOutputStream(baos);
          out.writeUTF(dictionary.getClass().getName());
          dictionary.write(out);
          put.add(IIDesc.HBASE_FAMILY_BYTES,IIDesc.HBASE_DICTIONARY_BYTES,baos.toByteArray());
        }
        data.add(put);
      }
    }
    hTable.put(data);
  }
  finally {
    hTable.close();
  }
}
