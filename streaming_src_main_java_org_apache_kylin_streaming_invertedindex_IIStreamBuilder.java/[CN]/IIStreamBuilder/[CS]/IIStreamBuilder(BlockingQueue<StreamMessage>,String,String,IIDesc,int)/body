{
  super(queue,iiDesc.getSliceSize());
  this.streaming=streaming;
  this.desc=iiDesc;
  this.shardId=shard;
  try {
    this.hTable=HBaseConnection.get(KylinConfig.getInstanceFromEnv().getStorageUrl()).getTable(hTableName);
    this.hTable.setAutoFlushTo(true);
  }
 catch (  IOException e) {
    logger.error("cannot open htable name:" + hTableName,e);
    throw new RuntimeException("cannot open htable name:" + hTableName,e);
  }
  this.sliceBuilder=new SliceBuilder(desc,(short)shard,iiDesc.isUseLocalDictionary());
  this.streamingManager=StreamingManager.getInstance(KylinConfig.getInstanceFromEnv());
}
