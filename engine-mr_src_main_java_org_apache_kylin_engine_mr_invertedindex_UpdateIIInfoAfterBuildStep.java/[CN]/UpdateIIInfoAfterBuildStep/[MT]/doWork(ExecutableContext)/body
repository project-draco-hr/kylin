{
  IIManager mgr=IIManager.getInstance(KylinConfig.getInstanceFromEnv());
  IIInstance ii=mgr.getII(getInvertedIndexName());
  IISegment segment=ii.getFirstSegment();
  segment.setStatus(SegmentStatusEnum.READY);
  segment.setLastBuildJobID(getJobId());
  segment.setLastBuildTime(System.currentTimeMillis());
  try {
    mgr.updateII(ii);
    return new ExecuteResult(ExecuteResult.State.SUCCEED,"succeed");
  }
 catch (  IOException e) {
    logger.error("fail to update inverted index after build",e);
    return new ExecuteResult(ExecuteResult.State.ERROR,e.getLocalizedMessage());
  }
}
