{
  CompressedValueContainer container=new CompressedValueContainer(info,0,500);
  Dictionary<String> dict=info.dict(0);
  for (int v=dict.getMinId(); v <= dict.getMaxId(); v++) {
    container.append(v);
  }
  container.append(Dictionary.NULL_ID[dict.getSizeOfId()]);
  container.closeForChange();
  ImmutableBytesWritable bytes=container.toBytes();
  CompressedValueContainer container2=new CompressedValueContainer(info,0,500);
  container2.fromBytes(bytes);
  int i=0;
  for (int v=dict.getMinId(); v <= dict.getMaxId(); v++) {
    int value=container2.getValueAt(i++);
    assertEquals(v,value);
  }
  assertEquals(Dictionary.NULL_ID[dict.getSizeOfId()],container2.getValueAt(i++));
  assertEquals(container,container2);
}
