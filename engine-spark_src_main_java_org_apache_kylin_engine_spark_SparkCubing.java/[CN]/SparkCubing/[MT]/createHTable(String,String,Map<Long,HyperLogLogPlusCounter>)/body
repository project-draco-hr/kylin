{
  final KylinConfig kylinConfig=KylinConfig.getInstanceFromEnv();
  final CubeInstance cubeInstance=CubeManager.getInstance(kylinConfig).getCube(cubeName);
  final CubeSegment cubeSegment=cubeInstance.getSegmentById(segmentId);
  final Map<Long,Long> rowCountMap=InMemCuboidJob.getCubeRowCountMapFromCuboidStatistics(samplingResult,100);
  final Map<Long,Double> cubeSizeMap=InMemCuboidJob.getCubeSizeMapFromRowCount(cubeSegment,rowCountMap);
  System.out.println("cube size estimation:" + cubeSizeMap);
  final byte[][] splitKeys=CreateHTableJob.getSplitsFromCuboidStatistics(cubeSizeMap,kylinConfig,cubeSegment);
  CubeHTableUtil.createHTable(cubeSegment,splitKeys);
  System.out.println(cubeSegment.getStorageLocationIdentifier() + " table created");
  return splitKeys;
}
