{
  TableDesc table=dim.getTableDesc();
  ColumnDesc col=table.findColumnByName(colName);
  if (col == null)   throw new IllegalArgumentException("No column '" + colName + "' found in table "+ table);
  TblColRef ref=new TblColRef(col);
  JoinDesc join=dim.getJoin();
  if (join != null) {
    int idx=ArrayUtils.indexOf(join.getPrimaryKeyColumns(),ref);
    if (idx >= 0) {
      ref=join.getForeignKeyColumns()[idx];
    }
  }
  return initDimensionColRef(ref);
}
