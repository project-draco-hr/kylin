{
  TableRef table=dim.getTableRef();
  TblColRef col=table.getColumn(colName);
  checkArgument(col != null,"No column '%s' found in table %s",colName,table);
  JoinDesc join=dim.getJoin();
  if (join != null) {
    int idx=ArrayUtils.indexOf(join.getPrimaryKeyColumns(),col);
    if (idx >= 0) {
      col=join.getForeignKeyColumns()[idx];
    }
  }
  return initDimensionColRef(col);
}
