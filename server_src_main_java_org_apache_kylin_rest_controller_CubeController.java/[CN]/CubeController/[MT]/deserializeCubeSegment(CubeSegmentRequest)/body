{
  CubeSegment segment=null;
  try {
    logger.debug("Saving cube segment " + cubeSegmentRequest.getCubeSegmentData());
    segment=JsonUtil.readValue(cubeSegmentRequest.getCubeSegmentData(),CubeSegment.class);
  }
 catch (  JsonParseException e) {
    logger.error("The cube definition is not valid.",e);
    cubeSegmentRequest.setSuccessful(false);
    cubeSegmentRequest.setMessage(e.getMessage());
  }
catch (  JsonMappingException e) {
    logger.error("The cube definition is not valid.",e);
    cubeSegmentRequest.setSuccessful(false);
    cubeSegmentRequest.setMessage(e.getMessage());
  }
catch (  IOException e) {
    logger.error("Failed to deal with the request.",e);
    throw new InternalErrorException("Failed to deal with the request:" + e.getMessage(),e);
  }
  return segment;
}
