{
  Cuboid cuboid=context.getCuboid();
  info=CubeGridTable.newGTInfo(cubeSeg,cuboid.getId());
  TupleFilter gtFilter=GTUtil.convertFilterColumnsAndConstants(filter,info,cuboid.getColumns(),groups);
  BitSet gtDimensions=makeGridTableColumns(cuboid,dimensions);
  BitSet gtAggrGroups=makeGridTableColumns(cuboid,groups);
  BitSet gtAggrMetrics=makeGridTableColumns(cubeSeg.getCubeDesc(),cuboid,metrics);
  String[] gtAggrFuncs=makeAggrFuncs(metrics);
  GTScanRangePlanner scanRangePlanner=new GTScanRangePlanner(info);
  List<GTScanRange> scanRanges=scanRangePlanner.planScanRanges(gtFilter,MAX_SCAN_RANGES);
  scanRequests=Lists.newArrayListWithCapacity(scanRanges.size());
  for (  GTScanRange range : scanRanges) {
    scanRequests.add(new GTScanRequest(info,range,gtDimensions,gtAggrGroups,gtAggrMetrics,gtAggrFuncs,gtFilter));
  }
}
