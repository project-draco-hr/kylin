{
  this.cubeSeg=cubeSeg;
  this.info=CubeGridTable.newGTInfo(cubeSeg,cuboid.getId());
  this.store=new CubeHBaseReadonlyStore(info,cubeSeg,cuboid);
  CuboidToGridTableMapping mapping=new CuboidToGridTableMapping(cuboid);
  TupleFilter gtFilter=GTUtil.convertFilterColumnsAndConstants(filter,info,mapping.getCuboidDimensionsInGTOrder(),groups);
  ImmutableBitSet gtDimensions=makeGridTableColumns(mapping,dimensions);
  ImmutableBitSet gtAggrGroups=makeGridTableColumns(mapping,groups);
  ImmutableBitSet gtAggrMetrics=makeGridTableColumns(mapping,metrics);
  String[] gtAggrFuncs=makeAggrFuncs(metrics);
  GTScanRangePlanner scanRangePlanner=new GTScanRangePlanner(info);
  List<GTScanRange> scanRanges=scanRangePlanner.planScanRanges(gtFilter,MAX_SCAN_RANGES);
  scanRequests=Lists.newArrayListWithCapacity(scanRanges.size());
  for (  GTScanRange range : scanRanges) {
    scanRequests.add(new GTScanRequest(info,range,gtDimensions,gtAggrGroups,gtAggrMetrics,gtAggrFuncs,gtFilter));
  }
  scanner=new Scanner();
}
