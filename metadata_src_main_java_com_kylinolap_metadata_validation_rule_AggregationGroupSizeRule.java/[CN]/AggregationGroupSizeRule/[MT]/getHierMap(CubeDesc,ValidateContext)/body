{
  Map<String,Set<String>> hierMap=new HashMap<String,Set<String>>();
  List<DimensionDesc> dims=cube.getDimensions();
  Iterator<DimensionDesc> it=dims.iterator();
  while (it.hasNext()) {
    Set<String> cset=new HashSet<String>();
    Set<String> lset=new HashSet<String>();
    DimensionDesc dim=it.next();
    HierarchyDesc[] hiers=dim.getHierarchy();
    if (hiers == null) {
      continue;
    }
    for (int i=0; i < hiers.length; i++) {
      if (cset.contains(hiers[i].getColumn())) {
        context.addResult(ResultLevel.ERROR,"Duplicate column " + hiers[i].getColumn() + " in dimension "+ dim.getName());
      }
 else {
        cset.add(hiers[i].getColumn());
      }
      if (lset.contains(hiers[i].getLevel())) {
        context.addResult(ResultLevel.ERROR,"Duplicate level " + hiers[i].getLevel() + " in dimension "+ dim.getName());
      }
 else {
        lset.add(hiers[i].getLevel());
      }
    }
    hierMap.put(dim.getName(),cset);
  }
  return hierMap;
}
