{
  HConnection conn=HBaseConnection.get(context.getConnUrl());
  String tableName=seg.getStorageLocationIdentifier();
  HTableInterface htable=null;
  try {
    htable=conn.getTable(tableName);
    return new EndpointTupleIterator(seg,columnDescs,filter,groups,new ArrayList(metrics),context,htable);
  }
 catch (  Throwable e) {
    e.printStackTrace();
    throw new IllegalStateException("Error when connecting to II htable " + tableName,e);
  }
}
