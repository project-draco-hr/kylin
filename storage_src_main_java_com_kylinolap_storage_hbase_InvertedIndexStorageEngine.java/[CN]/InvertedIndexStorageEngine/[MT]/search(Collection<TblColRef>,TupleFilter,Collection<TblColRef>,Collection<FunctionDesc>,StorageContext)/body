{
  String tableName=seg.getStorageLocationIdentifier();
  HConnection conn=HBaseConnection.get(context.getConnUrl());
  try {
    return new EndpointTupleIterator(seg,filter,groups,new ArrayList(metrics),context,conn);
  }
 catch (  Throwable e) {
    e.printStackTrace();
    throw new IllegalStateException("Error when connecting to II htable " + tableName,e);
  }
}
