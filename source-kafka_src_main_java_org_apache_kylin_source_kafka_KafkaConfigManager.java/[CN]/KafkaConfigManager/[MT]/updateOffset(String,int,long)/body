{
  Preconditions.checkArgument(offset >= 0,"offset cannot be smaller than 0");
  final String resPath=formatStreamingOutputPath(streaming,shard);
  try {
    getStore().putResource(resPath,new ByteArrayInputStream(Long.valueOf(offset).toString().getBytes()),getStore().getResourceTimestamp(resPath));
  }
 catch (  IOException e) {
    logger.error("error update offset, path:" + resPath,e);
    throw new RuntimeException("error update offset, path:" + resPath,e);
  }
}
