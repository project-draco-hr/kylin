{
  columnMap=new HashMap<TblColRef,RowKeyColDesc>();
  mandatoryColumnMask=0;
  for (int i=0; i < rowkeyColumns.length; i++) {
    RowKeyColDesc col=rowkeyColumns[i];
    col.setColumn(col.getColumn().toUpperCase());
    col.setBitIndex(rowkeyColumns.length - i - 1);
    col.setColRef(colNameAbbr.get(col.getColumn()));
    if (col.getColRef() == null)     throw new IllegalArgumentException("Cannot find rowkey column " + col.getColumn() + " in cube "+ cubeRef);
    columnMap.put(col.getColRef(),col);
    if (col.isMandatory()) {
      mandatoryColumnMask|=1L << col.getBitIndex();
    }
  }
}
