{
  CubeManager mgr=CubeManager.getInstance(KylinConfig.getInstanceFromEnv());
  CubeInstance cube=mgr.getCube(cubeName);
  if (cube == null)   throw new IllegalArgumentException("No Inverted Index Cubefound by name " + cubeName);
  Configuration conf=job.getConfiguration();
  attachKylinPropsAndMetadata(cube,conf);
  CubeSegment seg=cube.getFirstSegment();
  InvertedIndexDesc desc=cube.getInvertedIndexDesc();
  conf.set(BatchConstants.CFG_CUBE_NAME,cubeName);
  conf.set(BatchConstants.CFG_CUBE_SEGMENT_NAME,seg.getName());
  conf.set(BatchConstants.TIMESTAMP_GRANULARITY,"" + desc.getTimestampGranularity());
}
