{
  int size=andDimensionRanges.size();
  Map<TblColRef,String> startValues=Maps.newHashMapWithExpectedSize(size);
  Map<TblColRef,String> stopValues=Maps.newHashMapWithExpectedSize(size);
  Map<TblColRef,Set<String>> fuzzyValues=Maps.newHashMapWithExpectedSize(size);
  for (  ColumnValueRange dimRange : andDimensionRanges) {
    TblColRef column=dimRange.getColumn();
    startValues.put(column,dimRange.getBeginValue());
    stopValues.put(column,dimRange.getEndValue());
    fuzzyValues.put(column,dimRange.getEqualValues());
    PartitionDesc partDesc=cubeSeg.getCubeDesc().getModel().getPartitionDesc();
    if (column.equals(partDesc.getPartitionDateColumnRef())) {
      initPartitionRange(dimRange,partDesc.getPartitionDateFormat());
    }
  }
  AbstractRowKeyEncoder encoder=AbstractRowKeyEncoder.createInstance(cubeSeg,cuboid);
  encoder.setBlankByte(RowConstants.ROWKEY_LOWER_BYTE);
  this.startKey=encoder.encode(startValues);
  encoder.setBlankByte(RowConstants.ROWKEY_UPPER_BYTE);
  this.stopKey=Bytes.add(encoder.encode(stopValues),ZERO_TAIL_BYTES);
  this.fuzzyKeys=buildFuzzyKeys(fuzzyValues);
}
