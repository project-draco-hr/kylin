{
  String output="target/test-output/merged_cuboid";
  String cubeName="test_kylin_cube_with_slr_ready";
  String jobname="merge_cuboid";
  File baseFolder=File.createTempFile("kylin-f24668f6-dcff-4cb6-a89b-77f1119df8fa-","base");
  baseFolder.delete();
  baseFolder.mkdir();
  FileUtils.copyDirectory(new File("src/test/resources/data/base_cuboid"),baseFolder);
  baseFolder.deleteOnExit();
  File sixDFolder=File.createTempFile("kylin-f24668f6-dcff-4cb6-a89b-77f1119df8fa-","6d");
  sixDFolder.delete();
  sixDFolder.mkdir();
  FileUtils.copyDirectory(new File("src/test/resources/data/base_cuboid"),sixDFolder);
  sixDFolder.deleteOnExit();
  FileUtil.fullyDelete(new File(output));
  String[] args={"-input",baseFolder.getAbsolutePath() + "," + sixDFolder.getAbsolutePath(),"-cubename",cubeName,"-segmentname","20130331080000_20131212080000","-output",output,"-jobname",jobname};
  assertEquals("Job failed",0,ToolRunner.run(conf,new MergeCuboidJob(),args));
}
