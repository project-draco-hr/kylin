{
  final int BAD_THRESHOLD=2;
  String matchPattern=null;
  byte[] value;
  for (  String ptn : DATE_PATTERNS) {
    matchPattern=ptn;
    int badCount=0;
    int totalCount=0;
    SimpleDateFormat sdf=new SimpleDateFormat(ptn);
    while (valueEnumerator.moveNext()) {
      value=valueEnumerator.current();
      if (value.length == 0)       continue;
      String str=Bytes.toString(value);
      try {
        sdf.parse(str);
        if (samples.size() < nSamples && !samples.contains(str))         samples.add(str);
        totalCount++;
      }
 catch (      ParseException e) {
        logger.info("Unrecognized datetime value: " + str);
        badCount++;
        if (badCount > BAD_THRESHOLD) {
          matchPattern=null;
          break;
        }
      }
    }
    if (matchPattern != null) {
      info.setCardinality(totalCount);
      return new DateStrDictionary(matchPattern,baseId);
    }
  }
  throw new IllegalStateException("Unrecognized datetime value");
}
