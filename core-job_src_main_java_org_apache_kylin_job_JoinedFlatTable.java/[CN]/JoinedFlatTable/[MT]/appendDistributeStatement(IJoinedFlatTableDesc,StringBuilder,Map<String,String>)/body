{
  if (!(intermediateTableDesc instanceof CubeJoinedFlatTableDesc)) {
    return;
  }
  CubeJoinedFlatTableDesc desc=(CubeJoinedFlatTableDesc)intermediateTableDesc;
  TblColRef distDcol=desc.getCubeDesc().getDistributedByColumn();
  if (distDcol != null) {
    String tblAlias=tableAliasMap.get(distDcol.getTable());
    sql.append(" DISTRIBUTE BY ").append(tblAlias).append(".").append(distDcol.getName());
  }
 else {
    sql.append(" DISTRIBUTE BY RAND()");
  }
}
