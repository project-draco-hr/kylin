{
  List<TableRecord> records=loadRecordsSorted();
  System.out.println(records.size() + " records");
  List<Slice> slices=buildTimeSlices(records);
  System.out.println(slices.size() + " slices");
  IIKeyValueCodec codec=new IIKeyValueCodec(info.getDigest());
  List<Pair<ImmutableBytesWritable,ImmutableBytesWritable>> kvs=encodeKVs(codec,slices);
  System.out.println(kvs.size() + " KV pairs");
  List<Slice> slicesCopy=decodeKVs(codec,kvs);
  assertEquals(slices,slicesCopy);
  List<TableRecord> recordsCopy=iterateRecords(slicesCopy);
  assertEquals(new HashSet<TableRecord>(records),new HashSet<TableRecord>(recordsCopy));
  dump(recordsCopy);
}
