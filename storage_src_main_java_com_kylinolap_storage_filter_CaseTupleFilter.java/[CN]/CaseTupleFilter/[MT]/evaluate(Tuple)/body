{
  if (whenFilters.size() != thenFilters.size()) {
    elseFilter=whenFilters.remove(whenFilters.size() - 1);
  }
  boolean matched=false;
  for (int i=0; i < whenFilters.size(); i++) {
    TupleFilter whenFilter=whenFilters.get(i);
    if (whenFilter.evaluate(tuple)) {
      TupleFilter thenFilter=thenFilters.get(i);
      thenFilter.evaluate(tuple);
      values=thenFilter.getValues();
      matched=true;
      break;
    }
  }
  if (!matched) {
    if (elseFilter != null) {
      elseFilter.evaluate(tuple);
      values=elseFilter.getValues();
    }
 else {
      values=Collections.emptyList();
    }
  }
  return true;
}
