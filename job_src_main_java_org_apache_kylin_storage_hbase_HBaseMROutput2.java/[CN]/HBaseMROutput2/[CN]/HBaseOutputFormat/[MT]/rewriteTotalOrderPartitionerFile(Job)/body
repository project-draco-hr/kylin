{
  Configuration conf=job.getConfiguration();
  String partitionsFile=TotalOrderPartitioner.getPartitionFile(conf);
  if (StringUtils.isBlank(partitionsFile))   throw new IllegalStateException("HFileOutputFormat.configureIncrementalLoad don't configure TotalOrderPartitioner any more?");
  Path partitionsPath=new Path(partitionsFile);
  List<ByteArrayWritable> keys=Lists.newArrayList();
  Reader reader=new SequenceFile.Reader(conf,Reader.file(partitionsPath));
  try {
    ImmutableBytesWritable key=new ImmutableBytesWritable();
    while (reader.next(key,NullWritable.get())) {
      keys.add(new ByteArrayWritable(key.copyBytes()));
    }
  }
  finally {
    reader.close();
  }
  Writer writer=SequenceFile.createWriter(conf,Writer.file(partitionsPath),Writer.keyClass(ByteArrayWritable.class),Writer.valueClass(NullWritable.class));
  try {
    for (    ByteArrayWritable key : keys) {
      writer.append(key,NullWritable.get());
    }
  }
  finally {
    writer.close();
  }
}
