{
  GTScanRequest scanRequest;
  List<GTScanRange> scanRanges=this.planScanRanges();
  if (scanRanges != null && scanRanges.size() != 0) {
    GTScanRequestBuilder builder=new GTScanRequestBuilder().setInfo(gtInfo).setRanges(scanRanges).setDimensions(gtDimensions).setAggrGroupBy(gtAggrGroups).setAggrMetrics(gtAggrMetrics).setAggrMetricsFuncs(gtAggrFuncs).setFilterPushDown(gtFilter).setAllowStorageAggregation(context.isNeedStorageAggregation()).setAggCacheMemThreshold(cubeSegment.getCubeInstance().getConfig().getQueryCoprocessorMemGB()).setStorageScanRowNumThreshold(context.getThreshold());
    if (cubeDesc.supportsLimitPushDown()) {
      builder.setStoragePushDownLimit(context.getStoragePushDownLimit());
    }
    scanRequest=builder.createGTScanRequest();
  }
 else {
    scanRequest=null;
  }
  return scanRequest;
}
