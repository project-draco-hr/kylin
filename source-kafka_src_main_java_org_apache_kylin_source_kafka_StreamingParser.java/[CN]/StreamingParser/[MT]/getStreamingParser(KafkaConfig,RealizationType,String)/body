{
  final CubeInstance cubeInstance=CubeManager.getInstance(KylinConfig.getInstanceFromEnv()).getCube(realizationName);
  List<TblColRef> columns=Lists.transform(new CubeJoinedFlatTableDesc(cubeInstance.getDescriptor(),null).getColumnList(),new Function<IntermediateColumnDesc,TblColRef>(){
    @Nullable @Override public TblColRef apply(    IntermediateColumnDesc input){
      return input.getColRef();
    }
  }
);
  if (!StringUtils.isEmpty(kafkaConfig.getParserName())) {
    Class clazz=Class.forName(kafkaConfig.getParserName());
    Constructor constructor=clazz.getConstructor(List.class,String.class);
    return (StreamingParser)constructor.newInstance(columns,kafkaConfig.getParserProperties());
  }
 else {
    throw new IllegalStateException("invalid StreamingConfig:" + kafkaConfig.getName() + " missing property StreamingParser");
  }
}
