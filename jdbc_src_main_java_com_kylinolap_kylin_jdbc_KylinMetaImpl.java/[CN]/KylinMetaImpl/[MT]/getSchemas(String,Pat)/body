{
  logger.debug("Get schemas with conn " + conn);
  MetaProject metaProject=conn.getMetaProject();
  if (null != metaProject) {
    final DataSet<MetaSchema> schemas=metaProject.getMetaSchemas(catalog,schemaPattern);
    final NamedFieldGetter<MetaSchema> schemaGetter=new NamedFieldGetter<MetaSchema>(MetaSchema.class,schemas.getMeta(),"TABLE_SCHEM","TABLE_CATALOG");
    AvaticaResultSet resultSet=null;
    try {
      resultSet=this.conn.getFactory().newResultSet(this.conn.createStatement(),new KylinPrepare.PrepareResult(null,null,null,schemaGetter.structType){
        @Override public Cursor createCursor(){
          return schemaGetter.cursor(schemas.getEnumerator());
        }
      }
,this.conn.getTimeZone());
      KylinConnectionImpl.TROJAN.execute(resultSet);
    }
 catch (    SQLException e) {
      logger.error(e.getLocalizedMessage(),e);
    }
    return resultSet;
  }
 else {
    return mockEmptyResultSet();
  }
}
