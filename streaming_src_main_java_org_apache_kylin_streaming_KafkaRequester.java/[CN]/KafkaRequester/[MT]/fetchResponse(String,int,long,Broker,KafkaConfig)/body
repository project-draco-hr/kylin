{
  final String clientName="client_" + topic + "_"+ partitionId;
  SimpleConsumer consumer=new SimpleConsumer(broker.host(),broker.port(),kafkaConfig.getTimeout(),kafkaConfig.getBufferSize(),clientName);
  try {
    kafka.api.FetchRequest req=new FetchRequestBuilder().clientId(clientName).addFetch(topic,partitionId,offset,kafkaConfig.getMaxReadCount()).build();
    return consumer.fetch(req);
  }
  finally {
    consumer.close();
  }
}
