{
  CubeHBaseRPC rpc;
  if ("scan".equalsIgnoreCase(BackdoorToggles.getHbaseCubeQueryProtocol())) {
    rpc=new CubeHBaseScanRPC(cubeSeg,cuboid,info);
  }
 else {
    rpc=new CubeHBaseEndpointRPC(cubeSeg,cuboid,info);
  }
  try {
    if (scanRequests.size() == 0) {
      logger.info("Segment {} will be skipped",cubeSeg);
      internal=new EmptyGTScanner();
    }
 else {
      internal=rpc.getGTScanner(scanRequests);
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("error",e);
  }
}
