{
  int clusterId=0;
  final List<BlockingQueue<StreamMessage>> queues=Lists.newLinkedList();
  for (  final KafkaClusterConfig kafkaClusterConfig : streamingConfig.getKafkaClusterConfigs()) {
    final int partitionCount=KafkaRequester.getKafkaTopicMeta(kafkaClusterConfig).getPartitionIds().size();
    final List<BlockingQueue<StreamMessage>> oneClusterQueue=consume(clusterId,kafkaClusterConfig,partitionCount,whichtime);
    queues.addAll(oneClusterQueue);
    logger.info("Cluster {} with {} partitions",clusterId,oneClusterQueue.size());
    clusterId++;
  }
  return queues;
}
