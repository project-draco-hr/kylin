{
  this.mapContext=mapContext;
  this.cubeDesc=cubeDesc;
  this.cubeSegment=cubeSegment;
  this.measureCount=cubeDesc.getMeasures().size();
  hbaseMeasureRefIndex=new int[measureCount];
  List<MeasureDesc> hbaseMeasureList=Lists.newArrayList();
  for (  HBaseColumnFamilyDesc familyDesc : cubeDesc.getHbaseMapping().getColumnFamily()) {
    for (    HBaseColumnDesc hbaseColDesc : familyDesc.getColumns()) {
      for (      MeasureDesc measure : hbaseColDesc.getMeasures()) {
        hbaseMeasureList.add(measure);
      }
    }
  }
  for (int i=0; i < measureCount; i++) {
    for (int j=0; j < measureCount; j++) {
      if (cubeDesc.getMeasures().get(i).equals(hbaseMeasureList.get(j))) {
        hbaseMeasureRefIndex[i]=j;
        break;
      }
    }
  }
}
