{
  this.desc=iiSegment.getIIInstance().getDescriptor();
  this.dictionaryMap=Maps.newHashMap();
  Map<TblColRef,FixedLenMeasureCodec<?>> measureCodecMap=Maps.newHashMap();
  DictionaryManager dictMgr=DictionaryManager.getInstance(desc.getConfig());
  int index=0;
  for (  TblColRef tblColRef : desc.listAllColumns()) {
    ColumnDesc col=tblColRef.getColumn();
    if (desc.isMetricsCol(index)) {
      measureCodecMap.put(tblColRef,FixedLenMeasureCodec.get(col.getType()));
    }
 else {
      String dictPath=iiSegment.getDictResPath(tblColRef);
      if (dictPath != null) {
        try {
          dictionaryMap.put(index,dictMgr.getDictionary(dictPath));
        }
 catch (        IOException e) {
          throw new RuntimeException("dictionary " + dictPath + " does not exist ",e);
        }
      }
    }
    index++;
  }
  digest=createDigest(dictionaryMap,measureCodecMap);
}
