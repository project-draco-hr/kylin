{
  int nColumns=getColumns().size();
  boolean[] isMetric=new boolean[nColumns];
  int[] lengths=new int[nColumns];
  int[] dictMaxIds=new int[nColumns];
  String[] dataTypes=new String[nColumns];
  for (int i=0; i < nColumns; ++i) {
    final TblColRef tblColRef=getColumns().get(i);
    isMetric[i]=desc.isMetricsCol(i);
    if (isMetric[i]) {
      lengths[i]=measureCodecMap.get(tblColRef).getLength();
    }
 else {
      lengths[i]=dictionaryMap.get(tblColRef).getSizeOfId();
      dictMaxIds[i]=dictionaryMap.get(tblColRef).getMaxId();
    }
  }
  int pos=0;
  int[] offsets=new int[nColumns];
  for (int i=0; i < nColumns; i++) {
    offsets[i]=pos;
    pos+=lengths[i];
  }
  int byteFormLen=pos;
  return new TableRecordInfoDigest(nColumns,byteFormLen,offsets,dictMaxIds,lengths,isMetric,dataTypes);
}
