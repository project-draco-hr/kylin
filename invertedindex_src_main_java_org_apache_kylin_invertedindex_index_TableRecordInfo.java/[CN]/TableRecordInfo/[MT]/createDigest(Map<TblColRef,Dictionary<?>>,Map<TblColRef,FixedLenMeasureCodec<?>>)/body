{
  int nColumns=getColumns().size();
  boolean[] isMetric=new boolean[nColumns];
  int[] lengths=new int[nColumns];
  int[] dictMaxIds=new int[nColumns];
  String[] dataTypes=new String[nColumns];
  for (int i=0; i < nColumns; ++i) {
    final TblColRef tblColRef=getColumns().get(i);
    isMetric[i]=desc.isMetricsCol(i);
    dataTypes[i]=tblColRef.getDatatype();
    if (isMetric[i]) {
      final FixedLenMeasureCodec<?> fixedLenMeasureCodec=measureCodecMap.get(tblColRef);
      if (fixedLenMeasureCodec != null) {
        lengths[i]=fixedLenMeasureCodec.getLength();
      }
    }
 else {
      final Dictionary<?> dictionary=dictionaryMap.get(tblColRef);
      if (dictionary != null) {
        lengths[i]=dictionary.getSizeOfId();
        dictMaxIds[i]=dictionaryMap.get(tblColRef).getMaxId();
      }
    }
  }
  int pos=0;
  int[] offsets=new int[nColumns];
  for (int i=0; i < nColumns; i++) {
    offsets[i]=pos;
    pos+=lengths[i];
  }
  int byteFormLen=pos;
  return new TableRecordInfoDigest(nColumns,byteFormLen,offsets,dictMaxIds,lengths,isMetric,dataTypes);
}
