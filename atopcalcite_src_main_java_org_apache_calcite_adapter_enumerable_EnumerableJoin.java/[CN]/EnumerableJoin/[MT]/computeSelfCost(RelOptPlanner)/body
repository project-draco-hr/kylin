{
  double rowCount=RelMetadataQuery.getRowCount(this);
switch (joinType) {
case RIGHT:
    rowCount=addEpsilon(rowCount);
  break;
default :
if (RelNodes.COMPARATOR.compare(left,right) > 0) {
  rowCount=addEpsilon(rowCount);
}
}
final double rightRowCount=right.getRows();
final double leftRowCount=left.getRows();
if (Double.isInfinite(leftRowCount)) {
rowCount=leftRowCount;
}
 else {
rowCount+=Util.nLogN(leftRowCount);
}
if (Double.isInfinite(rightRowCount)) {
rowCount=rightRowCount;
}
 else {
rowCount+=rightRowCount;
}
return planner.getCostFactory().makeCost(rowCount,0,0);
}
