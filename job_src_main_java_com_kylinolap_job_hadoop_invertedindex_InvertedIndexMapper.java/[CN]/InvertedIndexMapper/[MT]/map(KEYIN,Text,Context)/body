{
  if (delim == -1) {
    delim=splitter.detectDelim(value,info.getDigest().getColumnCount());
  }
  int nParts=splitter.split(value.getBytes(),value.getLength(),(byte)delim);
  SplittedBytes[] parts=splitter.getSplitBuffers();
  if (nParts != info.getDigest().getColumnCount()) {
    throw new RuntimeException("Got " + parts.length + " from -- "+ value.toString()+ " -- but only "+ info.getDigest().getColumnCount()+ " expected");
  }
  rec.reset();
  for (int i=0; i < nParts; i++) {
    rec.setValueString(i,Bytes.toString(parts[i].value,0,parts[i].length));
  }
  outputKey.set(rec.getTimestamp());
  context.write(outputKey,outputValue);
}
