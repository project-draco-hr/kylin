{
  RelStructuredTypeFlattener typeFlattener=new RelStructuredTypeFlattener(rexBuilder,createToRelContext());
  RelNode newRootRel=typeFlattener.rewrite(rootRel,restructure);
  typeFlattener.updateRelInMap(mapRefRelToCorVar);
  typeFlattener.updateRelInMap(mapCorVarToCorRel);
  return newRootRel;
}
