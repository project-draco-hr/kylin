{
  MetadataManager metaMgr=MetadataManager.getInstance(config());
  File temp=File.createTempFile("temp",".csv");
  temp.createNewFile();
  for (  String tablename : TABLE_NAMES) {
    tablename=tablename.toUpperCase();
    File localBufferFile=new File(temp.getParent() + "/" + tablename+ ".csv");
    localBufferFile.createNewFile();
    InputStream hbaseDataStream=metaMgr.getStore().getResource("/data/" + tablename + ".csv");
    FileOutputStream localFileStream=new FileOutputStream(localBufferFile);
    IOUtils.copy(hbaseDataStream,localFileStream);
    hbaseDataStream.close();
    localFileStream.close();
    config().getCliCommandExecutor().copyFile(localBufferFile.getPath(),config().getCliWorkingDir());
    localBufferFile.delete();
  }
  temp.delete();
  execHiveCommand(generateCreateTableHql(metaMgr.getTableDesc(TABLE_CAL_DT.toUpperCase())));
  execHiveCommand(generateCreateTableHql(metaMgr.getTableDesc(TABLE_CATEGORY_GROUPINGS.toUpperCase())));
  execHiveCommand(generateCreateTableHql(metaMgr.getTableDesc(TABLE_KYLIN_FACT.toUpperCase())));
  execHiveCommand(generateCreateTableHql(metaMgr.getTableDesc(TABLE_SELLER_TYPE_DIM.toUpperCase())));
  execHiveCommand(generateCreateTableHql(metaMgr.getTableDesc(TABLE_SITES.toUpperCase())));
  execHiveCommand(generateLoadDataHql(TABLE_CAL_DT));
  execHiveCommand(generateLoadDataHql(TABLE_CATEGORY_GROUPINGS));
  execHiveCommand(generateLoadDataHql(TABLE_KYLIN_FACT));
  execHiveCommand(generateLoadDataHql(TABLE_SELLER_TYPE_DIM));
  execHiveCommand(generateLoadDataHql(TABLE_SITES));
}
