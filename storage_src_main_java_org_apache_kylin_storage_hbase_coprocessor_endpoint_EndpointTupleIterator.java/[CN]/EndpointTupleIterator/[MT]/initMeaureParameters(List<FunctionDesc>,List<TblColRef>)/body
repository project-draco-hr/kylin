{
  for (  FunctionDesc functionDesc : measures) {
    if (functionDesc.isCount()) {
      functionDesc.setReturnType("bigint");
      functionDesc.setReturnDataType(DataType.getInstance(functionDesc.getReturnType()));
    }
 else {
      boolean updated=false;
      for (      TblColRef column : columns) {
        if (column.isSameAs(factTableName,functionDesc.getParameter().getValue())) {
          functionDesc.setReturnType(column.getColumn().getType().toString());
          functionDesc.setReturnDataType(DataType.getInstance(functionDesc.getReturnType()));
          functionDesc.getParameter().setColRefs(ImmutableList.of(column));
          updated=true;
          break;
        }
      }
      if (!updated) {
        throw new RuntimeException("Func " + functionDesc + " is not related to any column in fact table "+ factTableName);
      }
    }
  }
}
