{
  ArrayList<KeyValuePair> result=Lists.newArrayList();
  ColumnValueContainer[] containers=slice.getColumnValueContainers();
  for (int col=0; col < containers.length; col++) {
    if (containers[col] instanceof BitMapContainer) {
      result.addAll(collectKeyValues(slice,col,(BitMapContainer)containers[col]));
    }
 else     if (containers[col] instanceof CompressedValueContainer) {
      result.add(collectKeyValues(slice,col,(CompressedValueContainer)containers[col]));
    }
 else {
      throw new IllegalArgumentException("Unknown container class " + containers[col].getClass());
    }
  }
  return result;
}
