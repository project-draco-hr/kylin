{
  String key=createKey(broker,timeout,bufferSize,clientId);
  if (consumerCache.containsKey(key)) {
    return consumerCache.get(key);
  }
 else {
    BrokerEndPoint brokerEndPoint=broker.getBrokerEndPoint(SecurityProtocol.PLAINTEXT);
    consumerCache.putIfAbsent(key,new SimpleConsumer(brokerEndPoint.host(),brokerEndPoint.port(),timeout,bufferSize,clientId));
    return consumerCache.get(key);
  }
}
