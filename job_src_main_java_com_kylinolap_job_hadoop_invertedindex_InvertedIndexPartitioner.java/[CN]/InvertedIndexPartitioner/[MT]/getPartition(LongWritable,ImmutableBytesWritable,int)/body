{
  long ts=key.get();
  return (int)(ts / timestampGranularity) % numPartitions;
}
