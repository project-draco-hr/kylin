{
  Preconditions.checkNotNull(dataType,"dataType cannot be null");
  Dictionary dict;
  int baseId=0;
  int nSamples=5;
  ArrayList samples=new ArrayList();
  if (dataType.isDateTimeFamily()) {
    if (dataType.isDate())     dict=buildDateDict(values,baseId,nSamples,samples);
 else     dict=new TimeStrDictionary();
  }
 else   if (dataType.isNumberFamily()) {
    dict=buildNumberDict(values,baseId,nSamples,samples);
  }
 else {
    dict=buildStringDict(values,baseId,nSamples,samples);
  }
  StringBuilder buf=new StringBuilder();
  for (  Object s : samples) {
    if (buf.length() > 0) {
      buf.append(", ");
    }
    buf.append(s.toString()).append("=>").append(dict.getIdFromValue(s));
  }
  logger.debug("Dictionary value samples: " + buf.toString());
  logger.debug("Dictionary cardinality " + dict.getSize());
  if (dict instanceof TrieDictionary && dict.getSize() > DICT_MAX_CARDINALITY) {
    throw new IllegalArgumentException("Too high cardinality is not suitable for dictionary -- cardinality: " + dict.getSize());
  }
  return dict;
}
