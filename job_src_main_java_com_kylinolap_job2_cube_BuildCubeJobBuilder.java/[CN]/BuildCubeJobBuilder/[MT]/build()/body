{
  BuildCubeJob result=new BuildCubeJob();
  final JoinedFlatTableDesc intermediateTableDesc=new JoinedFlatTableDesc(segment.getCubeDesc(),this.segment);
  final ShellExecutable intermediateHiveTableStep=createIntermediateHiveTableStep(intermediateTableDesc);
  final String intermediateHiveTableName=getIntermediateHiveTableName(intermediateTableDesc,intermediateHiveTableStep.getId());
  result.addTask(intermediateHiveTableStep);
  final MapReduceExecutable factDistinctColumnsStep=createFactDistinctColumnsStep(intermediateHiveTableName);
  result.addTask(factDistinctColumnsStep);
  final String factDistinctColumnsPath=getFactDistinctColumnsPath(factDistinctColumnsStep.getId());
  return result;
}
