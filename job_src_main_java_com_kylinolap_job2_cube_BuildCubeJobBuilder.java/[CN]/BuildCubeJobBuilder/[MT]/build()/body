{
  BuildCubeJob result=new BuildCubeJob();
  final CubeJoinedFlatTableDesc intermediateTableDesc=new CubeJoinedFlatTableDesc(segment.getCubeDesc(),this.segment);
  final ShellExecutable intermediateHiveTableStep=createIntermediateHiveTableStep(intermediateTableDesc);
  final String intermediateHiveTableName=getIntermediateHiveTableName(intermediateTableDesc,intermediateHiveTableStep.getId());
  result.addTask(intermediateHiveTableStep);
  final MapReduceExecutable factDistinctColumnsStep=createFactDistinctColumnsStep(intermediateHiveTableName);
  result.addTask(factDistinctColumnsStep);
  final String factDistinctColumnsPath=getFactDistinctColumnsPath(factDistinctColumnsStep.getId());
  final HadoopShellExecutable buildDictionaryStep=createBuildDictionaryStep(factDistinctColumnsPath);
  result.addTask(buildDictionaryStep);
  return result;
}
