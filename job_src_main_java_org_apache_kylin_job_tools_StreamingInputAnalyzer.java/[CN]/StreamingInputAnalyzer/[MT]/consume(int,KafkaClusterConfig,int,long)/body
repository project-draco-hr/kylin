{
  List<BlockingQueue<StreamMessage>> result=Lists.newArrayList();
  for (int partitionId=0; partitionId < partitionCount; ++partitionId) {
    final kafka.cluster.Broker leadBroker=StreamingUtil.getLeadBroker(kafkaClusterConfig,partitionId);
    long streamingOffset=KafkaRequester.getLastOffset(kafkaClusterConfig.getTopic(),partitionId,whichtime,leadBroker,kafkaClusterConfig);
    logger.info("starting offset:" + streamingOffset + " cluster id:"+ clusterID+ " partitionId:"+ partitionId);
    KafkaConsumer consumer=new KafkaConsumer(clusterID,kafkaClusterConfig.getTopic(),partitionId,streamingOffset,kafkaClusterConfig.getBrokers(),kafkaClusterConfig);
    Executors.newSingleThreadExecutor(new DaemonThreadFactory()).submit(consumer);
    result.add(consumer.getStreamQueue(0));
  }
  return result;
}
