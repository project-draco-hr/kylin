{
  Options options=new Options();
  logger.info("jobs args: " + Arrays.toString(args));
  try {
    options.addOption(OPTION_STREAMING);
    options.addOption(OPTION_TASK);
    options.addOption(OPTION_TSCOLNAME);
    parseOptions(options,args);
    logger.info("options: '" + getOptionsAsString() + "'");
  }
 catch (  Exception e) {
    e.printStackTrace();
    printUsage(options);
    return -1;
  }
  String streaming=getOptionValue(OPTION_STREAMING);
  String task=getOptionValue(OPTION_TASK);
  String tsColName=getOptionValue(OPTION_TSCOLNAME);
  streamingConfig=StreamingManager.getInstance(KylinConfig.getInstanceFromEnv()).getStreamingConfig(streaming);
  parser=new TimedJsonStreamParser(Lists.<TblColRef>newArrayList(),"formatTs=true;tsColName=" + tsColName);
  if ("disorder".equalsIgnoreCase(task)) {
    analyzeDisorder();
  }
 else   if ("delay".equalsIgnoreCase(task)) {
    analyzeLatency();
  }
 else {
    printUsage(options);
    return -1;
  }
  return 0;
}
