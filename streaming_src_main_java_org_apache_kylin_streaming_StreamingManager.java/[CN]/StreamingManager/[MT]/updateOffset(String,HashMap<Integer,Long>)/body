{
  List<Integer> partitions=Lists.newLinkedList(offset.keySet());
  Collections.sort(partitions);
  final String resPath=formatStreamingOutputPath(streaming,partitions);
  try {
    final ByteArrayOutputStream baos=new ByteArrayOutputStream();
    mapper.writeValue(baos,offset);
    baos.close();
    ByteArrayInputStream input=new ByteArrayInputStream(baos.toByteArray());
    getStore().putResource(resPath,input,getStore().getResourceTimestamp(resPath));
    input.close();
  }
 catch (  IOException e) {
    logger.error("error update offset, path:" + resPath,e);
    throw new RuntimeException("error update offset, path:" + resPath,e);
  }
}
