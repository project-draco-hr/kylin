{
  Preconditions.checkArgument(offset >= 0,"offset cannot be smaller than 0");
  final String resPath=formatStreamingOutputPath(streaming,shard);
  try {
    ByteArrayInputStream input=new ByteArrayInputStream(Long.valueOf(offset).toString().getBytes());
    getStore().putResource(resPath,input,getStore().getResourceTimestamp(resPath));
    input.close();
  }
 catch (  IOException e) {
    logger.error("error update offset, path:" + resPath,e);
    throw new RuntimeException("error update offset, path:" + resPath,e);
  }
}
