{
  Collections.sort(partitions);
  final String resPath=formatStreamingOutputPath(streaming,partitions);
  try {
    final InputStream inputStream=getStore().getResource(resPath);
    if (inputStream == null) {
      return Collections.emptyMap();
    }
    HashMap<Integer,Long> result=null;
    try {
      result=mapper.readValue(inputStream,mapType);
    }
  finally {
      inputStream.close();
    }
    return result;
  }
 catch (  IOException e) {
    logger.error("error get offset, path:" + resPath,e);
    throw new RuntimeException("error get offset, path:" + resPath,e);
  }
}
