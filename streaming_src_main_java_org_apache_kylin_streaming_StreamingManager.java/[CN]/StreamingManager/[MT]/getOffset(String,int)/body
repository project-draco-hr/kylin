{
  final String resPath=formatStreamingOutputPath(streaming,shard);
  try {
    final InputStream inputStream=getStore().getResource(resPath);
    if (inputStream == null) {
      return 0;
    }
 else {
      final BufferedReader br=new BufferedReader(new InputStreamReader(inputStream));
      long ret=Long.parseLong(br.readLine());
      br.close();
      return ret;
    }
  }
 catch (  Exception e) {
    logger.error("error get offset, path:" + resPath,e);
    throw new RuntimeException("error get offset, path:" + resPath,e);
  }
}
