{
  final String mapReduceJobClass=getJobClass();
  String params=getJobParams();
  Preconditions.checkNotNull(mapReduceJobClass);
  Preconditions.checkNotNull(params);
  try {
    final Constructor<? extends AbstractHadoopJob> constructor=(Constructor<? extends AbstractHadoopJob>)Class.forName(mapReduceJobClass).getConstructor();
    final AbstractHadoopJob job=constructor.newInstance();
    String[] args=params.trim().split("\\s+");
    logger.info("parameters of the HadoopShellExecutable:");
    logger.info(params);
    final int result=ToolRunner.run(job,args);
    return result == 0 ? new ExecuteResult(ExecuteResult.State.SUCCEED,"") : new ExecuteResult(ExecuteResult.State.FAILED,"result code:" + result);
  }
 catch (  ReflectiveOperationException e) {
    logger.error("error getMapReduceJobClass, class name:" + getParam(KEY_MR_JOB),e);
    return new ExecuteResult(ExecuteResult.State.ERROR,e.getLocalizedMessage());
  }
catch (  Exception e) {
    logger.error("error execute MapReduceJob, id:" + getId(),e);
    return new ExecuteResult(ExecuteResult.State.ERROR,e.getLocalizedMessage());
  }
}
